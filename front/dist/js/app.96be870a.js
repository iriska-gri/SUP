(function(){var t={46700:function(t,e,s){var a={"./af":42786,"./af.js":42786,"./ar":30867,"./ar-dz":14130,"./ar-dz.js":14130,"./ar-kw":96135,"./ar-kw.js":96135,"./ar-ly":56440,"./ar-ly.js":56440,"./ar-ma":47702,"./ar-ma.js":47702,"./ar-sa":16040,"./ar-sa.js":16040,"./ar-tn":37100,"./ar-tn.js":37100,"./ar.js":30867,"./az":31083,"./az.js":31083,"./be":9808,"./be.js":9808,"./bg":68338,"./bg.js":68338,"./bm":67438,"./bm.js":67438,"./bn":8905,"./bn-bd":76225,"./bn-bd.js":76225,"./bn.js":8905,"./bo":11560,"./bo.js":11560,"./br":1278,"./br.js":1278,"./bs":80622,"./bs.js":80622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":50877,"./cv.js":50877,"./cy":47373,"./cy.js":47373,"./da":24780,"./da.js":24780,"./de":59740,"./de-at":60217,"./de-at.js":60217,"./de-ch":60894,"./de-ch.js":60894,"./de.js":59740,"./dv":5300,"./dv.js":5300,"./el":50837,"./el.js":50837,"./en-au":78348,"./en-au.js":78348,"./en-ca":77925,"./en-ca.js":77925,"./en-gb":22243,"./en-gb.js":22243,"./en-ie":46436,"./en-ie.js":46436,"./en-il":47207,"./en-il.js":47207,"./en-in":44175,"./en-in.js":44175,"./en-nz":76319,"./en-nz.js":76319,"./en-sg":31662,"./en-sg.js":31662,"./eo":92915,"./eo.js":92915,"./es":55655,"./es-do":55251,"./es-do.js":55251,"./es-mx":96112,"./es-mx.js":96112,"./es-us":71146,"./es-us.js":71146,"./es.js":55655,"./et":5603,"./et.js":5603,"./eu":77763,"./eu.js":77763,"./fa":76959,"./fa.js":76959,"./fi":11897,"./fi.js":11897,"./fil":42549,"./fil.js":42549,"./fo":94694,"./fo.js":94694,"./fr":94470,"./fr-ca":63049,"./fr-ca.js":63049,"./fr-ch":52330,"./fr-ch.js":52330,"./fr.js":94470,"./fy":5044,"./fy.js":5044,"./ga":29295,"./ga.js":29295,"./gd":2101,"./gd.js":2101,"./gl":38794,"./gl.js":38794,"./gom-deva":27884,"./gom-deva.js":27884,"./gom-latn":23168,"./gom-latn.js":23168,"./gu":95349,"./gu.js":95349,"./he":24206,"./he.js":24206,"./hi":30094,"./hi.js":30094,"./hr":30316,"./hr.js":30316,"./hu":22138,"./hu.js":22138,"./hy-am":11423,"./hy-am.js":11423,"./id":29218,"./id.js":29218,"./is":90135,"./is.js":90135,"./it":90626,"./it-ch":10150,"./it-ch.js":10150,"./it.js":90626,"./ja":39183,"./ja.js":39183,"./jv":24286,"./jv.js":24286,"./ka":12105,"./ka.js":12105,"./kk":47772,"./kk.js":47772,"./km":18758,"./km.js":18758,"./kn":79282,"./kn.js":79282,"./ko":33730,"./ko.js":33730,"./ku":1408,"./ku.js":1408,"./ky":33291,"./ky.js":33291,"./lb":36841,"./lb.js":36841,"./lo":55466,"./lo.js":55466,"./lt":57010,"./lt.js":57010,"./lv":37595,"./lv.js":37595,"./me":39861,"./me.js":39861,"./mi":35493,"./mi.js":35493,"./mk":95966,"./mk.js":95966,"./ml":87341,"./ml.js":87341,"./mn":5115,"./mn.js":5115,"./mr":10370,"./mr.js":10370,"./ms":9847,"./ms-my":41237,"./ms-my.js":41237,"./ms.js":9847,"./mt":72126,"./mt.js":72126,"./my":56165,"./my.js":56165,"./nb":64924,"./nb.js":64924,"./ne":16744,"./ne.js":16744,"./nl":93901,"./nl-be":59814,"./nl-be.js":59814,"./nl.js":93901,"./nn":83877,"./nn.js":83877,"./oc-lnc":92135,"./oc-lnc.js":92135,"./pa-in":15858,"./pa-in.js":15858,"./pl":64495,"./pl.js":64495,"./pt":89520,"./pt-br":57971,"./pt-br.js":57971,"./pt.js":89520,"./ro":96459,"./ro.js":96459,"./ru":21793,"./ru.js":21793,"./sd":40950,"./sd.js":40950,"./se":10490,"./se.js":10490,"./si":90124,"./si.js":90124,"./sk":64249,"./sk.js":64249,"./sl":14985,"./sl.js":14985,"./sq":51104,"./sq.js":51104,"./sr":49131,"./sr-cyrl":79915,"./sr-cyrl.js":79915,"./sr.js":49131,"./ss":85893,"./ss.js":85893,"./sv":98760,"./sv.js":98760,"./sw":91172,"./sw.js":91172,"./ta":27333,"./ta.js":27333,"./te":23110,"./te.js":23110,"./tet":52095,"./tet.js":52095,"./tg":27321,"./tg.js":27321,"./th":9041,"./th.js":9041,"./tk":19005,"./tk.js":19005,"./tl-ph":75768,"./tl-ph.js":75768,"./tlh":89444,"./tlh.js":89444,"./tr":72397,"./tr.js":72397,"./tzl":28254,"./tzl.js":28254,"./tzm":51106,"./tzm-latn":30699,"./tzm-latn.js":30699,"./tzm.js":51106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":67691,"./uk.js":67691,"./ur":13795,"./ur.js":13795,"./uz":6791,"./uz-latn":60588,"./uz-latn.js":60588,"./uz.js":6791,"./vi":65666,"./vi.js":65666,"./x-pseudo":14378,"./x-pseudo.js":14378,"./yo":75805,"./yo.js":75805,"./zh-cn":83839,"./zh-cn.js":83839,"./zh-hk":55726,"./zh-hk.js":55726,"./zh-mo":99807,"./zh-mo.js":99807,"./zh-tw":74152,"./zh-tw.js":74152};function i(t){var e=r(t);return s(e)}function r(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id=46700},21780:function(t,e){"use strict";e["Z"]={title:"func",methods:{chatTitle(t){if(null!=t.name)return t.name;{let e="";return t.users.forEach((t=>{if(t.id!=this.getUser.id){let s=t.givenName.split(" ");e=t.sn+" "+s[0][0]+"."}})),e}},getName(t){let e=t.split(" "),s=0,a="";while(s<2&&s<e.length)a+=e[s][0].toUpperCase(),s++;return a},lightdark(t,e){let s={1:{dark:"grinblack",light:"grinlight"},2:{dark:"auchdark",light:"auchlight"},3:{dark:"auchdark",light:"auchlight"},4:{dark:"reddark",light:"redlight"},null:{dark:"pinksdark",light:"pinkslight"}};return s[t][e?"dark":"light"]}}}},56922:function(t,e,s){"use strict";s.d(e,{$:function(){return es}});var a=s(20144),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(t.layout,{tag:"component",class:t.$vuetify.theme.dark?"auchdark":"auchlight"},[s("router-view")],1)},r=[],n={name:"App",computed:{layout(){if(this.$route.meta.layout)return this.$route.meta.layout+"-layout"}}},l=n,o=s(43736),c=(0,o.Z)(l,i,r,!1,null,null,null),d=c.exports,u=s(78345);function h(t,e,a,{layout:i="navigation"}={},r=!0){return{path:t,name:e,component:()=>s(62513)(`./${a}.vue`),meta:{layout:i},props:r}}a["default"].use(u.Z);const m=[h("/","Main","Main"),h("/projects","Projects","Projects"),h("/tasks","Tasks","Tasks"),h("/works","Works","Works"),h("/assignments","Assignments","Assignments"),h("/project/:id","Project","Project"),h("/project/:projectid/task/:id","Task","Task"),h("/project/:projectid/task/:taskid/work/:id","Work","Work"),h("/events","Events","Events"),h("/calendar","Calendar","Calendar"),h("/documentation","Documentation","Documentation"),h("/competence","Competence","Competence"),h("/iteration","Iteration","Iteration"),h("/dashboard","Dashboard","Dashboard"),h("/raport","Raport","Raport"),h("/strategy","Strategy","Strategy"),h("/auth","Auth","Auth",{layout:"auth"}),h("/registration","Registration","Registration",{layout:"auth"})],p=new u.Z({mode:"history",base:"/",routes:m});p.beforeEach(((t,e,s)=>{const a=["/auth","/registration"],i=!a.includes(t.path),r=JSON.parse(localStorage.getItem("status_login"));return i&&!r?s("/auth"):!i&&r?s("/"):void s()}));var f=p,g=s(20629),v=s(96245),_={namespaced:!0,state:{token:"",user:"",statusReg:!1},getters:{getToken(t){return t.token},getUser(t){return console.log("Пользователь",t.user),t.user},getStatusReg(t){return t.statusReg},getSuperUser(t){return t.superuser}},mutations:{setStatusReg(t,e){t.statusReg=e},setToken(t,e){t.token=e,t.user=(0,v.Z)(e).user},removeToken(t){t.token=""}}},y={i8:"0.1.6"},x=s(45296),k=s(30381),b=s.n(k),w={namespaced:!0,state:{project__status:[],mult_project__status:[],role:[],mult_role:[],task__status:[],mult_task__status:[],work__status:[],mult_work__status:[],assignment__status:[],mult_assignment__status:[],project__type:[],mult_project__type:[]},getters:{user_project__role(t){return t.role},mult_user_project__role(t){return t.mult_role},project__type(t){return t.project__type},mult_project__type(t){return t.mult_project__type},role(t){return t.role},mult_role(t){return t.mult_role},status(t){return t.project__status},mult_status(t){return t.mult_project__status},mult_task__status(t){return t.mult_task__status},work__status(t){return t.work__status},mult_work__status(t){return t.mult_work__status},task__status(t){return t.task__status},assignment__status(t){return t.assignment__status},mult_assignment__status(t){return t.mult_assignment__status}},mutations:{addFilter(t,{key:e,value:s}){t[e]=s}},actions:{addFilter({state:t,commit:e,rootState:s},{key:a,value:i}){if(e("addFilter",{key:a,value:i}),"mult"!=a.slice(0,4)){if(0==i.length)return void delete s.filterslogic.activefilters[a];s.filterslogic.activefilters[a]={value:i,postfix:"__in",module:"mult"}}}}},C={namespaced:!0,state:{project__name:"",name:"",user_project__user__sn:"",responsible__sn:""},getters:{project__name(t){return t.project__name},name(t){return t.name},user_project__user__sn(t){return t.user_project__user__sn},responsible__sn(t){return t.responsible__sn}},mutations:{addFilter(t,{key:e,value:s}){t[e]=s}},actions:{addFilter({state:t,commit:e,rootState:s},{key:a,value:i}){e("addFilter",{key:a,value:i}),["",null].includes(i)?delete s.filterslogic.activefilters[a]:s.filterslogic.activefilters[a]={value:i,postfix:"__startswith",module:"input",correct:i}}}},j={namespaced:!0,state:{dateend__lte:"",dateend__gte:"",datestart__lte:"",datestart__gte:""},getters:{dateend__lte(t){return t.dateend__lte},dateend__gte(t){return t.dateend__gte},datestart__lte(t){return t.datestart__lte},datestart__gte(t){return t.datestart__gte}},mutations:{addFilter(t,{key:e,value:s}){t[e]=s}},actions:{addFilter({state:t,commit:e,rootState:s},{key:a,value:i}){e("addFilter",{key:a,value:i}),["",null].includes(i)?delete s.filterslogic.activefilters[a]:s.filterslogic.activefilters[a]={value:i,postfix:"",module:"datepicker",correct:i}}}},$={namespaced:!0,state:{activefilters:{},fieldsfilter:{}},mutations:{clear_select(t,e){t.select[e]="",delete t.activefilters[e]},setFields(t,e){t.fieldsfilter=e},setIncludeFilters(t,e){t.includeFilters=e},filtersClear(t){t.activefilters={}},clear_mult(t,e){t.mult[e]=[],delete t.activefilters[e]},clear_datepicker(t,e){t.datepicker[e]="",delete t.activefilters[e]},clear_input(t,e){t.input[e]="",delete t.activefilters[e]},clear_chain(t,e){const s=e.slice(-5);if(t.interpritateChain[s]){let a=e.slice(0,-5);t.includeFilters.includes(a)||(t.chain[`${t.interpritateChain[s]}${a}`]="",delete t.activefilters[e])}else t.includeFilters.includes(e)||(t.chain[`with_${e}`]="",t.chain[`by_${e}`]="",delete t.activefilters[e])}},actions:{cleartypeerror({state:t,commit:e}){e("clear_select","type_error")},clear({state:t,commit:e}){for(let[s,{module:a}=val]of Object.entries(t.activefilters))e(`clear_${a}`,s)},async addFilter({dispatch:t,state:e},{key:s,value:a}){await t(`${e.fieldsfilter[s].module}/addFilter`,{key:s,value:a})},async addDate({dispatch:t},{value:e,period:s,field:a}){const i=["with","by"];e.forEach(((e,r)=>{t("chain/addDate",{key:`${i[r]}_${a}`,value:e,period:s,field:a,type:i[r]})}))},async getFilters({state:t},e,s=!1){try{console.log(t,e,s,"roooooole");const a=await x.be.post("/filters/",e);s&&console.log(a,"reeees");for(let[e,s]of Object.entries(a.data))console.log(e,s),t[t.fieldsfilter[e].module][`mult_${e}`]=s;return a.data}catch(a){return console.log(a,"xcxxccxxcx"),a}},activefilters({state:t},e=[]){const s={};for(let[a,i]of Object.entries(t.activefilters))s[`${a}${i.postfix}`]=i.value;return s}},modules:{mult:w,input:C,datepicker:j}},Z={namespaced:!0,state:{project:{longname:"",name:"",difficult:0,ptype:{id:2},project_checkpoint:[],info:{financial_support:"",project_sphere:"",passport_last_date:"",influence:"",grounds:"",target:[],result:[],criteria:[],risks:[],interactions:[],dop_info:"",docnumber:""},users:[{id:0,role:{id:0},user:{id:0,fullname:""},percent:0}],status:{id:0},id:0,datestart:"",dateend:"",history:[],difficult:0,tasks:[]}},getters:{getprojectIdName(t){return{id:t.project.id,name:null===t.project.name?null:t.project.name,resp:"users"in t.project&&t.project.users.length?t.project.users.find((t=>2==t.role.id)).user.id:null}},allpersons(t){return[...t.project.users]},getProjectdatestart(t){return t.project.datestart},getProjectdateend(t){return t.project.dateend},getProject(t){return t.project},getProjectusers(t){return t.project.users.filter((t=>5==t.role.id))},getProjectwatchers(t){return t.project.users.filter((t=>6==t.role.id))},getProjectdirector(t){return t.project.users.find((t=>1==t.role.id)).user},getProjectrp(t){return t.project.users.length?t.project.users.find((t=>2==t.role.id)).user:{id:0}},getProjectcoordinator(t){return t.project.users.find((t=>4==t.role.id)).user},getProjectsecretary(t){return t.project.users.find((t=>3==t.role.id)).user},getprojectTasks(t){return t.project.tasks},getprojectWorks(t){let e=[];return t.project.tasks.forEach((t=>e=e.concat(t.task_work))),e},getprojectuniqueusers(t){let e=[],s=[];return t.project.users.forEach((t=>{s.includes(t.user.id)||0==t.user.id||(e.push({id:t.user.id,text:t.user.fullname,role:t.role}),s.push(t.user.id))})),e},getprojectuniquePersons(t){let e=[...t.project.users],s=[];return e.forEach((t=>{void 0!=t&&-1==s.findIndex((e=>t.user.id===e.id))&&s.push(t.user)})),s}},mutations:{setProject(t,e){t.project=e},setProjectname(t,e){t.project.name=e},setProjectusers(t,e){t.project.users=e},setProjectType(t,e){t.project.ptype=e},setProjectStatus(t,e){t.project.status=e},setProjectUserPercent(t,e){t.project.users.find((t=>t.role.id==e.id)).percent=e.percent},setProjectUserPercentId(t,e){t.project.users.find((t=>t.user.id==e.id&&t.role.id==e.role)).percent=e.percent},clearProject(t){t.project={longname:"",name:"",difficult:0,ptype:{id:2},project_checkpoint:[],info:{financial_support:"",project_sphere:"",passport_last_date:"",influence:"",grounds:"",target:[],result:[],criteria:[],risks:[],interactions:[],dop_info:"",docnumber:""},users:[{id:0,role:{id:0},user:{id:0,fullname:""},percent:0}],status:{id:0},id:0,datestart:"",dateend:"",history:[],difficult:0,tasks:[{task_work:[],status:{id:0},responsible:{sn:""}}]}},setProjectdatestart(t,e){t.project.datestart=e},setProjectdateend(t,e){t.project.dateend=e}}},V={namespaced:!0,state:{tasks:{id:0,responsible:{},datestart:"",dateend:"",status:{id:0,name:""},history:[],name:"",longname:"",difficult:0}},getters:{getTaskdatestart(t){return t.tasks.datestart},getTaskdateend(t){return t.tasks.dateend},gettasks(t){return t.tasks},gettasksusers(t){return t.tasks.users},gettasksdirector(t){return t.tasks.director},gettasksrp(t){return t.tasks.rp},gettaskscoordinator(t){return t.tasks.coordinator},gettaskssecretary(t){return t.tasks.secretary},gettasksuniqueusers(t){let e=[...t.tasks.users,t.tasks.director,t.tasks.coordinator,t.tasks.rp,t.tasks.secretary],s=[];return e.forEach((t=>{void 0!=t&&-1==s.findIndex((e=>t.id===e.id))&&s.push({id:t.id,text:t.fullname})})),s}},mutations:{settasks(t,e){t.tasks=e},settasksname(t,e){t.tasks.name=e},settaskslongname(t,e){t.tasks.longname=e},settasksdifficult(t,e){t.tasks.difficult=e},settasksresponsible(t,e){t.tasks.responsible=e},setTaskdatestart(t,e){t.tasks.datestart=e},settasksdescription(t,e){t.tasks.description=e},setTaskdateend(t,e){t.tasks.dateend=e}}},F={namespaced:!0,state:{Works:{id:0,responsible:{id:0},datestart:"",dateend:"",status:{id:0,name:""},work_assignment:[{status:{id:0}}],history:[],difficult:3,longname:"",name:""}},getters:{getworkidname(t){return{id:t.Works.id,name:null===t.Works.name?null:t.Works.name,resp:null===t.Works.responsible?null:t.Works.responsible.id}},getWorkdatestart(t){return t.Works.datestart},getWorkdateend(t){return t.Works.dateend},getworks(t){return t.Works},getWorksusers(t){return t.Works.users},getWorksdirector(t){return t.Works.director},getWorksrp(t){return t.Works.rp},getWorkscoordinator(t){return t.Works.coordinator},getWorkssecretary(t){return t.Works.secretary}},mutations:{setWorks(t,e){t.Works=e},setworksname(t,e){t.Works.name=e},setworksresponsible(t,e){t.Works.responsible=e},setWorkdatestart(t,e){t.Works.datestart=e},setworksdescription(t,e){t.Works.description=e},setWorkdateend(t,e){t.Works.dateend=e},setworkslongname(t,e){t.Works.longname=e},setworksdifficult(t,e){t.Works.difficult=e}}},S={namespaced:!0,state:{Assignment:{id:0,responsible:{},datestart:"",dateend:"",name:"",longname:"",difficult:3,description:"",history:[]}},getters:{getAssignmentdatestart(t){return t.Assignment.datestart},getAssignmentdateend(t){return t.Assignment.dateend},getAssignments(t){return t.Assignment},getAssignmentsusers(t){return t.Assignment.responsible}},mutations:{setAssignments(t,e){t.Assignment=e},setAssignmentname(t,e){t.Assignment.name=e},setAssignmentresponsible(t,e){t.Assignment.responsible=e},setAssignmentdatestart(t,e){t.Assignment.datestart=e},setAssignmentdescript(t,e){t.Assignment.description=e},setAssignmentdateend(t,e){t.Assignment.dateend=e}}},I={namespaced:!0,state:{loading:!1,assignid:null},getters:{getLoad(t){return t.loading},getassign_id(t){return t.assignid}},mutations:{setLoad(t,e){t.loading=e},set_assign_id(t,e){t.assignid=e}}};a["default"].use(g.ZP);var E=new g.ZP.Store({state:{appVersion:y.i8||"0"},mutations:{},getters:{appVersion:t=>t.appVersion},actions:{},modules:{globalstore:I,auth:_,filterslogic:$,projectstate:Z,taskstate:V,workstate:F,assignmentstate:S}}),N=s(90707),A=s.n(N),M=(s(8556),s(41852)),T=s(92638);a["default"].use(A());var D=new(A())({theme:{options:{customProperties:!0},themes:{light:{disableds:"#B0B0B0",chatik:"#5A7BBD",chatiknotme:"#C6637B",chatinfo:"#F0F8FF",chatinfonotme:"#fff1f4",chatmess:"#fefeff",chatdevider:"#DCDCDC",chatico:"#5A7BBD",primary:"#404E67",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107",backfon:"#FFFFFF",inyand:"#FFFFFF",slech:"#C2C6CE",inyand2:"#181818",greym:"#404E67",spisok:"#767171",card_title:"#09182e",btns:"#5A7BBD",btns_menus:"#3F51B5",text_menus:"#0D4CD3",inputs:"#E8F0FE",lines_border:"#FFFFFF",select_lines_border:"#31ffff",icons:"#0D4CD3",primaryicons:"#404E67",inputcolor:"#e3e3e3",main_theme:"#FFFFFF",active:"#eaeeff",passiv_text:"#BCBCBC",bottom_strip:"#193416",close_icons:"#e92011",paused:T.Z.orange.accent3,open_icons:"#4CAF50",text_card:"#1a1a1a",scrollbar:"#073E9B",fonback:"#d8dbe1",ganttext:"#0D4CD3",gantborder:"#e0e0e0",granica:"#9E9E9E",chat:"#F5F5F5",prliniarstop:"#C1C4CA",prliniar85:"#F7D293",prliniar100:"#F5A593",prliniarelse:"#A7E3BB",addnewshapka:"#60447c",texthead:"#333333",exppanel:"#FFFFFF"},dark:{disableds:"#B0B0B0",chatik:"#5A7BBD",chatiknotme:"#C6637B",chatinfo:"#03173f",chatinfonotme:"#4b0c1b",chatmess:"#1E1E1E",chatdevider:"#FFFFFF",chatico:"#5A7BBD",primary:"#404E67",secondary:"#424242",accent:"#FF4081",error:"#FF5252",info:"#ffffff",success:"#4CAF50",warning:"#FB8C00",backfon:"#362a2d",inyand:"#181818",slech:"#8C8272",inyand2:"#FFFFFF",greym:"#404E67",spisok:"#d7d7d7",card_title:"#f7f2ea",btns:"#f9a825",btns_menus:"#f9a825",text_menus:"#f9a825",inputs:"#E8F0FE",lines_border:"#FFFFFF",select_lines_border:"#c76333",icons:T.Z.yellow.darken3,primaryicons:"#FFFFFF",inputcolor:"#1F2C34",main_theme:"#1E1E1E",active:"#443f2a",passiv_text:"#7E7E7E",bottom_strip:"#5A0303",close_icons:"#e92011",paused:"#FF9109",open_icons:"#4CAF50",text_card:"#A2A2A2",scrollbar:"#6F432A",fonback:"#322c23",ganttext:"#f9a825",gantborder:"#DDDDDD",granica:"#9E9E9E",chat:"#272727",prliniarstop:"#9d9d9d",prliniar85:"#bd9b61",prliniar100:"#cf8271",prliniarelse:"#6d8f78",addnewshapka:"#60447c",texthead:"#333333",exppanel:"#F6F6F6"}}},lang:{locales:{ru:M.Z},current:"ru"},icons:{iconfont:"fa"}}),U=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",[s("v-navigation-drawer",{attrs:{app:"",stateless:"","mini-variant":t.mini,width:"190",color:"main_theme"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[s("namePrograms",{attrs:{mini:t.mini},on:{minis:t.minis}}),s("v-divider"),s("navigationPanel",{attrs:{items:t.items,mini:t.mini,messengerview:t.messengerview,messengertotal:t.messengertotal},on:{messengervi:function(e){t.messengerview=!t.messengerview}}})],1),s("v-main",{staticClass:"flex-col"},[s("v-app-bar",{staticClass:"main_theme flex-grow-0 ",attrs:{dense:"",flat:""}},[s("v-col",{staticClass:"flex-grow-1"},[s("v-row",[t._l(t.dateCalendar,(function(e,a){return[s("month",{key:a,class:{"month-calendar":e.month},attrs:{value:e}}),a<t.dateCalendar.length-1?s("v-divider",{key:"div"+a,attrs:{vertical:"",inset:""}}):t._e()]}))],2)],1),s("v-divider",{attrs:{vertical:""}}),s("div",{staticClass:"flex-row"},[s("v-col",{staticClass:"py-0"},[s("v-row",{staticClass:"flex-row align-self-center"},[s("v-col",{staticClass:"flex-grow-0 mb-0"},[s("v-avatar",{attrs:{size:"45"}},[s("img",{attrs:{alt:t.getUser.sn,src:"photo"in t.getUser?t.getUser.photo:"http://"+t.serverurl+"/static/default/avatardef.png"}})])],1),s("v-col",{staticClass:"mb-0"},[s("div",{staticClass:"subtitle-2"},[t._v(t._s(t.getUser.sn)+" "+t._s(t.getUser.givenName))]),s("div",{staticClass:"caption"},[t._v(t._s(t.getUser.otdel.name)+" ")])])],1)],1),s("toggle-theme",{staticClass:"align-self-center"}),s("v-col",{staticClass:"flex-grow-0  align-self-center"},[s("MyIco",{attrs:{size:"medium",icons:"mdi-logout-variant"},on:{click:t.logout}})],1)],1)],1),t.loadPage?s("v-container",{staticClass:"flex-grow-1 flex-col pa-0",attrs:{fluid:""}},[s("v-slide-x-transition",[s("v-row",{directives:[{name:"show",rawName:"v-show",value:t.messengerview,expression:"messengerview"}],staticStyle:{position:"fixed","z-index":"50",top:"95px",left:"202px"}},[s("v-col",{staticClass:"nl_whatsup"},[s("messengerMain",{on:{totaller:t.totaller,closesupogramm:function(e){t.messengerview=!1}}})],1)],1)],1),t._t("default")],2):t._e()],1)],1)},L=[],z=s(52098),O=s(86042),B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list",[a("v-list-item",{class:t.mini?"pl-3":""},[a("v-list-item-avatar",{attrs:{size:"30"},on:{click:function(e){return e.stopPropagation(),t.$emit("minis")}}},[a("img",{staticStyle:{cursor:"pointer"},attrs:{src:s(2)}})]),a("v-list-item-title",{staticClass:"logo-title flex-row flex-nowrap justify-center"},[a("div",{staticClass:"mr-1 text_menus--text",class:t.$vuetify.theme.dark?"":"font-weight-medium"},[t._v(" СУП ")]),a("div",{staticClass:"text-caption text_menus--text",class:t.$vuetify.theme.dark?"":"font-weight-medium"},[t._v(" "+t._s(t.$store.getters.appVersion)+" ")])]),a("v-btn",{attrs:{rounded:!1,icon:"","x-small":""},on:{click:function(e){return e.stopPropagation(),t.$emit("minis")}}},[a("MyIco",{attrs:{size:"x-small",icons:"fa-angle-double-left"}})],1)],1)],1)},P=[],W={props:{mini:{type:Boolean,default:!1}}},R=W,G=s(43453),Y=s.n(G),H=s(16190),q=s(65808),J=s(54525),K=s(66900),Q=s(79500),X=(0,o.Z)(R,B,P,!1,null,null,null),tt=X.exports;Y()(X,{VBtn:H.Z,VList:q.Z,VListItem:J.Z,VListItemAvatar:K.Z,VListItemTitle:Q.V9});var et=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-row",[s("v-col",{class:t.value.month?"ml-2 pr-0 pl-1 ":""},[t.value.month?s("div",{staticClass:"text-center"},[t._v(" "+t._s(t.monthhelp[t.value.text])+" ")]):s("div",{staticClass:"px-2 pt-1 pb-2 d-flex flex-col"},[s("div",{staticClass:"align-self-end flex-grow-0 text-card-calendar pb-1"},[t._v(" "+t._s(t.value.text)+", ")]),t.value.data.assignment?s("div",{staticClass:"flex-grow-1 flex-col d-flex justify-space-around align-center icon-card-calendar"},[s("v-row",[s("v-col",{staticClass:"pa-0"},[s("MyIco",{attrs:{size:"small",icons:"mdi-format-list-bulleted"}})],1)],1),s("v-row",{staticClass:"mt-2"},[s("v-col",{staticClass:"py-0 calendar-count text-center"},[t._v(" "+t._s(t.value.data.assignment)+" ")])],1)],1):t._e()])])],1)},st=[],at={props:{value:{type:Object,default:()=>{}}},data(){return{monthhelp:{"01":"январь","02":"февраль","03":"март","04":"апрель","05":"май","06":"июнь","07":"июль","08":"август","09":"cентябрь",10:"октябрь",11:"ноябрь",12:"декабрь"}}}},it=at,rt=s(60266),nt=s(11713),lt=(0,o.Z)(it,et,st,!1,null,null,null),ot=lt.exports;Y()(lt,{VCol:rt.Z,VRow:nt.Z});var ct=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-list-item-group",[t._l(t.items,(function(e,a){return s("div",{key:a},[e.sub?t._e():s("lists",{attrs:{icon:e.icon,title:e.title,links:e.link,mini:t.mini}}),e.sub?s("v-list",{attrs:{dense:""}},[s("v-list-group",{ref:"collapsibleclose",refInFor:!0,attrs:{"prepend-icon":e.icon,value:!0},scopedSlots:t._u([{key:"activator",fn:function(){return[s("v-list-item-title",{staticClass:"text_menus--text",class:t.mini?"pl-2 text-button font-weight-black":"text-caption font-weight-normal"},[t._v(" "+t._s(t.mini?e.title.split(" ").map((function(t){return t.length>1?t[0].toUpperCase():""})).join(""):e.title)+" ")])]},proxy:!0}],null,!0)},[s("v-icon",{attrs:{slot:"appendIcon","x-small":"",color:"btns"},slot:"appendIcon"},[t._v(" fas fa-chevron-down ")]),t._l(e.sub,(function(e,a){return s("div",{key:a},[e.sub?s("ListsGroup",{attrs:{item:e,mini:t.mini,i:a},on:{collapselist:t.collapselist}}):s("lists",{attrs:{icon:e.icon,title:e.title,links:e.link,mini:t.mini},on:{messengerview:t.messengerview}})],1)}))],2)],1):s("v-divider")],1)})),s("v-divider"),s("lists",{attrs:{mini:t.mini,icon:"mdi-forum",title:"ВатСУП",link:!1,messengertotal:t.messengertotal},on:{messengerviews:t.messengerviews}})],2)},dt=[],ut=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-list-item",{attrs:{link:t.link,to:t.links||""},on:{click:function(e){return t.$emit("messengerviews")}}},[s("v-list-item-icon",[s("v-icon",{class:t.mini?t.pl:"pl-5",attrs:{slot:"appendIcon",small:!t.mini||t.f,color:"btns_menus"},slot:"appendIcon"},[t._v(" "+t._s(t.icon)+" ")])],1),s("v-list-item-title",{staticClass:"peace text-caption font-weight-medium"},[t._v(" "+t._s(t.title)+" "+t._s(t.messengertotal>0?"("+t.messengertotal+")":"")+" ")])],1)},ht=[],mt={name:"lists",props:{messengertotal:{type:Number,default:0},icon:{type:String,default:""},title:{type:String,default:""},links:{type:String,default:""},mini:{type:Boolean,default:!1},link:{type:Boolean,default:!0},f:{type:Boolean,default:!1},pl:{type:String,default:"pl-2"}}},pt=mt,ft=s(4324),gt=s(74611),vt=(0,o.Z)(pt,ut,ht,!1,null,null,null),_t=vt.exports;Y()(vt,{VIcon:ft.Z,VListItem:J.Z,VListItemIcon:gt.Z,VListItemTitle:Q.V9});var yt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-list",{ref:"level2",staticClass:"it2",attrs:{dense:""}},[s("v-list-group",{ref:"collapsibleclose",attrs:{value:!0},on:{click:function(e){return t.$emit("collapselist",{i:t.i,key:"level2"})}},scopedSlots:t._u([{key:"activator",fn:function(){return[s("v-list-item-title",{staticClass:"text-caption font-weight-normal text_menus--text",class:{hidden:t.mini}},[t._v(" "+t._s(t.item.title)+" ")])]},proxy:!0}])},[t.mini?s("v-icon",{class:t.mini?"pl-2":"pl-5",attrs:{slot:"prependIcon",small:!t.mini,color:"btns"},slot:"prependIcon"},[t._v(" "+t._s(t.item.icon)+" ")]):t._e(),s("v-icon",{attrs:{slot:"appendIcon","x-small":"",color:"btns"},slot:"appendIcon"},[t._v(" fas fa-chevron-down ")]),t._l(t.item.sub,(function(e){return s("div",{key:e.title,class:t.mini?"pl-2":"pl-5"},[s("lists",{attrs:{icon:e.icon,title:e.title,links:e.link,mini:t.mini,pl:"pl-1",f:!0}})],1)}))],2)],1)},xt=[],kt={components:{Lists:_t},name:"lists-group",props:{item:{type:Object,default:()=>{}},mini:{type:Boolean,default:!1},i:{type:Number,default:0}}},bt=kt,wt=s(87397),Ct=(0,o.Z)(bt,yt,xt,!1,null,null,null),jt=Ct.exports;Y()(Ct,{VIcon:ft.Z,VList:q.Z,VListGroup:wt.Z,VListItemTitle:Q.V9});var $t={components:{Lists:_t,ListsGroup:jt},props:{messengertotal:{type:Number,default:0},items:{type:Array,default:()=>[]},mini:{type:Boolean,default:!1},messengerview:{type:Boolean,default:!1}},methods:{collapselist(t){this.$emit("collapselist",t)},messengerviews(){this.$emit("messengervi",this.messengerview)}}},Zt=$t,Vt=s(99223),Ft=s(77912),St=(0,o.Z)(Zt,ct,dt,!1,null,null,null),It=St.exports;Y()(St,{VDivider:Vt.Z,VIcon:ft.Z,VList:q.Z,VListGroup:wt.Z,VListItemGroup:Ft.Z,VListItemTitle:Q.V9});const{mapGetters:Et}=(0,g._p)("auth");var Nt={components:{ToggleTheme:O.Z,messengerMain:z.Z,namePrograms:tt,NavigationPanel:It,month:ot},data(){return{calendar:!1,messengertotal:0,serverurl:x.Jx,messengerview:!1,groupexpand:!0,calendarLength:7,dateCalendar:[],dataCalendar:{},loadPage:!1,drawer:!0,user:{},items:[{title:"Главная",icon:"mdi-home-variant-outline",link:"/"},{title:"Проектная деятельность",sub:[{title:"Проекты и задачи",icon:"fa-list-ol",link:"/projects",sub:[{title:"Проекты",icon:"mdi-vector-circle",link:"/projects"},{title:"Задачи",icon:"mdi-calendar-edit-outline",link:"/tasks"},{title:"Работы",icon:"mdi-archive-edit",link:"/works"},{title:"Поручения",icon:"mdi-account-arrow-left-outline",link:"/assignments"}]},{title:"Совещания",icon:"mdi-account-group-outline",link:"/events"},{title:"Календарь",icon:"mdi-calendar-month-outline",link:"/calendar"},{title:"Документация",icon:"mdi-file-document-multiple-outline",link:"/documentation"},{title:"Компетенции",icon:"mdi-head-check-outline",link:"/competence"},{title:"Итерации",icon:"mdi-repeat",link:"/iteration"}]},{title:"Статистика и аналитика",sub:[{title:"Дашборд",icon:"mdi-monitor-dashboard",link:"/dashboard"},{title:"Отчеты",icon:"mdi-file-chart-outline ",link:"/raport"},{title:"Стратегии",icon:"mdi-chess-queen",link:"/strategy"}]}],mini:!1}},methods:{totaller(t){this.messengertotal=t},createCalendar(){const t=b()(Date.now());let e="";for(let s=0;s<7;s++){let a=t.clone().add(s,"days");a.locale("ru").format("MM")!=e&&(e=a.locale("ru").format("MM"),this.dateCalendar.push({text:e.toUpperCase(),month:!0})),this.dataCalendar[a.format("YYYY-MM-DD")]={assignment:""},this.dateCalendar.push({text:`${a.locale("ru").format("ddd").toUpperCase()}, ${a.locale("ru").format("DD")}`,month:!1,data:this.dataCalendar[a.format("YYYY-MM-DD")]})}console.log(this.dateCalendar)},build(){this.user=this.getDrawUser,this.createCalendar(),this.dataCalendar[b()().add(5,"days").format("YYYY-MM-DD")].assignment=1},logout(){(0,x.kS)(this.$store)},minis(){this.mini=!this.mini},messengervi(t){this.messengerview=t}},computed:{...Et(["getUser"])},mounted(){this.getUser?(this.build(),this.loadPage=!0):(0,x.Mv)(this.$store).then((()=>{this.build(),this.loadPage=!0}))}},At=Nt,Mt=s(40998),Tt=s(15100),Dt=s(43423),Ut=s(82118),Lt=s(3059),zt=s(99709),Ot=s(77394),Bt=(0,o.Z)(At,U,L,!1,null,null,null),Pt=Bt.exports;Y()(Bt,{VApp:Mt.Z,VAppBar:Tt.Z,VAvatar:Dt.Z,VCol:rt.Z,VContainer:Ut.Z,VDivider:Vt.Z,VMain:Lt.Z,VNavigationDrawer:zt.Z,VRow:nt.Z,VSlideXTransition:Ot.Qn});var Wt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",[t._t("default")],2)},Rt=[],Gt={},Yt=Gt,Ht=(0,o.Z)(Yt,Wt,Rt,!1,null,null,null),qt=Ht.exports;Y()(Ht,{VApp:Mt.Z});const Jt=t=>{x.be.interceptors.request.use((e=>{const s=t.getters["auth/getToken"];return s&&(e.headers["Authorization"]=s),e}),(t=>Promise.reject(t))),x.be.interceptors.response.use((t=>t),(async e=>{const s=e.config,a=localStorage.getItem("status_login");return!a||!e.response||422!==e.response.status&&403!==e.response.status||s._retry?Promise.reject(e):(s._retry=!0,await(0,x.jM)(t,(()=>(0,x.be)(s))))}))};var Kt=Jt,Qt=s(43958),Xt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"d-flex flex-column"},[s("h4",{class:[t.disabled?"label-select-disabled":"label-select","pb-0"]},[t._v(" "+t._s(t.title)+" ")]),t._t("default")],2)},te=[],ee={name:"layout-label",props:{title:{type:String},disabled:{type:Boolean}}},se=ee,ae=(0,o.Z)(se,Xt,te,!1,null,"28280f4a",null),ie=ae.exports,re=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-col",{staticClass:"pb-3 pt-1 px-1"},[s("layout-label",{staticClass:"text-nowrap ",attrs:{title:t.title,disabled:t.disabled}},[s("div",{ref:"mydiv"},[s("v-autocomplete",{ref:"mySelector",staticClass:"my_auto ",attrs:{items:t.items,label:t.label,multiple:"","small-chips":"",disabled:t.disabled,solo:"",dense:"",clearable:t.values.length>0,"hide-details":"true","background-color":"inputcolor","item-text":"name","item-value":"name","return-object":""},scopedSlots:t._u([{key:"prepend-item",fn:function(){return[s("v-list-item",{attrs:{ripple:""},on:{click:t.toggle}},[s("v-list-item-action",[s("v-icon",{attrs:{small:"",color:t.values.length>0?"indigo darken-4":""}},[t._v(t._s(t.icon))])],1),s("v-list-item-content",[s("v-list-item-title",[t._v("Выбрать все")])],1)],1)]},proxy:!0},{key:"selection",fn:function(e){var a=e.item,i=e.index;return[t.values&&i<=t.aviablecalc(t.values)?s("v-chip",{attrs:{color:"primary",small:""}},[s("span",[t._v(t._s(a.name.slice(0,25))+" ")])]):t._e(),t.values&&(i===t.aviablecalc(t.values)+1&&i>=0)?s("custom-tooltip",{attrs:{content:t.values,visible:t.tooltipvisible}},[s("span",{staticClass:"grey--text caption pointer"},[t._v("(+"+t._s(t.values.length-1-t.aviablecalc(t.values))+" )")])]):t._e()]}}]),model:{value:t.filt,callback:function(e){t.filt=e},expression:"filt"}})],1)]),s("div",[s("div",{ref:"counter",staticClass:"d-flex px-3",attrs:{id:"counter"}}),s("div",{ref:"total",staticClass:"d-flex",attrs:{id:"total"}})])],1)},ne=[],le=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticStyle:{position:"relative"},on:{click:function(e){return e.stopPropagation(),t.tooglevis.apply(null,arguments)}}},[t._t("default")],2),s("v-card",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],class:t.visible?"anim-show":"anim-hide",on:{mouseleave:function(e){t.visible&&t.tooglevis()},click:function(t){t.stopPropagation()}}},t._l(t.content,(function(e,a){return s("div",{key:a,staticStyle:{whitespace:"nowrap"}},[t._v(t._s(e))])})),0)],1)},oe=[],ce={name:"custom-tooltip",props:{content:[]},data(){return{visible:!1}},methods:{tooglevis(){this.visible=!this.visible}},mounted(){k.locale("ru")}},de=ce,ue=s(34145),he=(0,o.Z)(de,le,oe,!1,null,"c945c608",null),me=he.exports;Y()(he,{VCard:ue.Z});var pe={name:"f-multi-select",components:{CustomTooltip:me},data(){return{item:"",tooltipvisible:!1,aviable:0}},props:{label:{type:String,default:"Выберите..."},field:{type:[String,Number]},disabled:{type:Boolean,default:!1},title:{type:String}},methods:{aviablecalc(t){let e=0,s=0;this.$refs.total.innerHTML="";let a=this.$refs.mydiv.offsetWidth-70;if(this.$refs.counter.innerHTML="",this.$refs.counter){for(let i=0;i<t.length;i++)if(s=this.$refs.counter.offsetWidth,this.$refs.counter.innerHTML+=`<span class="mx-2 px-2">${t[i].name.slice(0,25)}${t[i].name.length>25?"...":""}</span>`,e=this.$refs.counter.offsetWidth,a<=e)return this.$refs.total.innerHTML=`<span>(+${t.length-1-i})<span> `,a<=s+this.$refs.total.offsetWidth+5?i-2:i-1;return t.length-1}},toggle(){this.$nextTick((()=>{this.likesAllEl?this.values=[]:this.values=this.items.slice()}))}},computed:{filt:{get(){return this.$store.getters[`filterslogic/mult/${this.field}`]},set(t){this.$store.dispatch("filterslogic/mult/addFilter",{key:this.field,value:t}),this.$emit("filterreestr")}},items:{get(){return this.$store.getters[`filterslogic/mult/mult_${this.field}`]},set(t){this.$store.dispatch("filterslogic/mult/addFilter",{key:`filterslogic/mult/mult_${this.field}`,value:t})}},values:{get(){return this.$store.getters[`filterslogic/mult/${this.field}`]},set(t){this.$store.dispatch("filterslogic/mult/addFilter",{key:this.field,value:t})}},likesAllEl(){return this.values.length===this.items.length},likesSomeEl(){return this.values.length>0&&!this.items.length},icon(){return this.likesAllEl?"mdi-close-box":this.likesSomeEl?"mdi-minus-box":"mdi-checkbox-blank-outline"}},watch:{filt(t,e){let s;s=t.length>e.length?t[t.length-1]:e.find((e=>!t.includes(e)));const a=this.items.findIndex((t=>t===s));this.$nextTick((()=>{this.$refs.mySelector.setMenuIndex(a)}))}},beforeDestroy(){this.$store.dispatch("filterslogic/mult/addFilter",{key:this.field,value:[]})}},fe=pe,ge=s(344),ve=s(44127),_e=s(45187),ye=(0,o.Z)(fe,re,ne,!1,null,null,null),xe=ye.exports;Y()(ye,{VAutocomplete:ge.Z,VChip:ve.Z,VCol:rt.Z,VIcon:ft.Z,VListItem:J.Z,VListItemAction:_e.Z,VListItemContent:Q.km,VListItemTitle:Q.V9});var ke=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-col",{staticClass:"pa-0 px-1 align-self-center pb-2",attrs:{xl:"1",lg:"2",md:"6",sm:"12"}},[s("v-menu",{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[s("layout-label",{attrs:{title:t.title}}),s("v-text-field",t._g(t._b({staticClass:"pt-0",attrs:{dense:"",solo:"",value:t.formatDate(t.filt),type:"date-local",placeholder:"дд.мм.гггг","background-color":"inputcolor","hide-details":""},on:{input:t.oninput}},"v-text-field",i,!1),a))]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[s("v-date-picker",{attrs:{"first-day-of-week":1},model:{value:t.filt,callback:function(e){t.filt=e},expression:"filt"}})],1)],1)},be=[],we={name:"f-daterange",data(){return{dates:"2018-03-02",dates1:"2018-03-02",menu:!1}},props:{field:{type:[String]},type:{type:String,default:"text"},title:{type:String},appendouter:{type:String,default:""},disabled:{type:Boolean,default:!1}},computed:{filt:{get(){return this.$store.getters[`filterslogic/datepicker/${this.field}`]},set(t){this.$store.dispatch("filterslogic/datepicker/addFilter",{key:this.field,value:t}),this.$emit("filterreestr")}}},beforeDestroy(){this.$store.dispatch("filterslogic/datepicker/addFilter",{key:this.field,value:""})},methods:{formatDate(t){try{if(3==t.split("-").length){const[e,s,a]=t.split("-");return`${a}.${s}.${e}`}}catch{return null}},formatDateRev(t){if(!t)return null;let e=t.split(".");if(3==e.length&&e[2].length>0){const[t,s,a]=e;return`${a}-${s}-${t}`}return!1},oninput(t){try{let e=this.formatDateRev(t);console.log(e);const s=b()(e);console.log(s.isValid()),s.isValid()&&(this.dates=e,this.filt=this.dates)}catch(e){console.log(t)}}}},Ce=we,je=s(71030),$e=s(44568),Ze=s(17808),Ve=(0,o.Z)(Ce,ke,be,!1,null,null,null),Fe=Ve.exports;Y()(Ve,{VCol:rt.Z,VDatePicker:je.Z,VMenu:$e.Z,VTextField:Ze.Z});var Se=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-btn",{staticClass:"inyand--text",attrs:{color:t.colora,block:t.block,outlined:t.outlined,disabled:t.disabled,height:t.icon?t.heighti:t.height,width:t.icon?t.widthi:t.width,icon:t.icon,text:t.text},on:{click:function(e){return t.$emit("click")}}},[t._t("icons"),t.getLoad()?s("v-skeleton-loader",{staticClass:"namebtn",attrs:{type:"table-cell"}}):s("span",{class:t.textbtn},[t._v(" "+t._s(t.title)+" ")])],2)},Ie=[];const Ee=(0,g._p)("globalstore");var Ne={name:"BtnsOut",props:{title:{type:String,default:""},disabled:{type:Boolean,default:!1},block:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},text:{type:Boolean,default:!1},height:{type:Number,default:36},width:{type:Number,default:120},heighti:{type:Number,default:0},widthi:{type:Number,default:0},icon:{type:Boolean,default:!1},textbtn:{type:String,default:"text-sizeBTN text-capitalize"},colora:{type:String,default:"btns"}},methods:{...Ee.mapGetters(["getLoad"])}},Ae=Ne,Me=s(84978),Te=(0,o.Z)(Ae,Se,Ie,!1,null,null,null),De=Te.exports;Y()(Te,{VBtn:H.Z,VSkeletonLoader:Me.Z});var Ue=s(27114),Le=s(37505),ze=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"inputext inputcolor flex-grow-1 overflow-x-auto rounded-lg px-2 py-1 ",class:t.data?t.$vuetify.theme.dark?"inyand2--text":"font-weight-medium":"passiv_text--text "},[t._t("insert")],2)},Oe=[],Be={name:"InputText",props:{data:0}},Pe=Be,We=(0,o.Z)(Pe,ze,Oe,!1,null,null,null),Re=We.exports,Ge=s(76811),Ye=s(43593),He=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pa-0 align-self-center"},[s("v-menu",{attrs:{"close-on-content-click":!1,"nudge-width":500,"offset-x":""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[s("div",t._g(t._b({},"div",i,!1),a),[s("MyIco",{attrs:{color:"indigo",icons:"mdi-owl"}})],1)]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[s("v-card",{staticClass:"whmy overflow-auto overflow-x-hidden"},[s("v-row",{staticClass:"ma-3"},[s("v-col",[s("pre",[t._v(t._s(t.pretext)+"\n")])])],1)],1)],1)],1)},qe=[],Je={name:"myHelper",props:{pretext:{type:Object,default:()=>{}}},data:()=>({fav:!0,menu:!1,message:!1,hints:!0})},Ke=Je,Qe=(0,o.Z)(Ke,He,qe,!1,null,null,null),Xe=Qe.exports;Y()(Qe,{VCard:ue.Z,VCol:rt.Z,VMenu:$e.Z,VRow:nt.Z});var ts=[Xe,Qt.Z,ie,xe,Fe,De,Ue.Z,Le.Z,Re,Ge.Z,Ye.Z];a["default"].component("navigation-layout",Pt),a["default"].component("auth-layout",qt),ts.forEach((t=>{a["default"].component(t.name,t)})),a["default"].config.productionTip=!1,Kt(E),x.AF.prototype.store=E,a["default"].prototype.$pws=x.AF,new a["default"]({router:f,store:E,vuetify:D,render:t=>t(d)}).$mount("#app");const es=new a["default"]},45296:function(t,e,s){"use strict";s.d(e,{AF:function(){return p},Jx:function(){return r},Mv:function(){return m},be:function(){return d},e0:function(){return o},jM:function(){return h},kS:function(){return u},rH:function(){return c}});var a=s(9669),i=s.n(a);const r="10.252.44.60:8500",n=`http://${r}/api/`,l=`ws://${r}/ws`,o=i().create({baseURL:n,withCredentials:!0,headers:{"Content-Type":"application/json"}}),c=i().create({baseURL:n,withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}}),d=i().create({baseURL:n,withCredentials:!0,headers:{"Content-Type":"application/json"}});function u(t){localStorage.removeItem("status_login"),t.commit("auth/removeToken"),window.location.href="/"}async function h(t,e=null){let s=localStorage.getItem("refresh_token");try{const a=await o.post("/auth/refresh",{},{headers:{Authorization:"Bearer "+s}}),i=a.data.access_token;return t.commit("auth/setToken",i),e?e():Promise.resolve()}catch(a){return Promise.reject(a)}}function m(t){let e=localStorage.getItem("refresh_token");return new Promise(((s,a)=>{o.post("/auth/refresh",{},{headers:{Authorization:"Bearer "+e}}).then((e=>{t.commit("auth/setToken",e.data.access_token),s()})).catch((()=>{u(t),a()}))}))}class p{constructor(t){this.url=l,this.conn=null,this.events={},this._retry=!1}start(t=null){t&&(this.url=l+t),this.conn=new WebSocket(this.url+`?token=${this.store.getters["auth/getToken"]}`);for(let[e,s]of Object.entries(this.events))this.conn[e]=s;this.conn.onopen=()=>{console.log("Соединение WS открыто",this.url)},this.conn.onclose=async t=>{console.log(t.code,"EVENT CODE",this.url),1008!=t.code||this._retry||(this._retry=!this._retry,await h(this.store).then((()=>{this.start()}))),1e3==t.code&&this._retry&&this.start(),console.log("Соединение WS закрыто",this.url)},this.conn.onerror=async t=>{console.log("ERROR")}}stop(){this.conn.close()}addEvent(t,e){this.events[t]=e,this.conn[t]=e}send(t){this.conn.send(JSON.stringify(t))}}},35241:function(t,e,s){"use strict";var a=s(30381),i=s.n(a),r=s(20629);const n=(0,r._p)("projectstate"),l=(0,r._p)("taskstate"),o=(0,r._p)("workstate");e["Z"]={methods:{...o.mapMutations(["setWorkdatestart","setWorkdateend"]),...l.mapMutations(["setTaskdatestart","setTaskdateend"]),...n.mapMutations(["setProjectdatestart","setProjectdateend"]),formatDate(t){try{if(!t)return null;if(3==t.split("-").length){const[e,s,a]=t.split("-");return`${a}.${s}.${e}`}}catch{return t}},formatDateRev(t){if(!t)return null;const[e,s,a]=t.split(".");return 3==t.split(".").length?`${a}-${s}-${e}`:void 0},oninput(t,e,s,a,r){console.log(a,r),console.log(s,"storiter");let n=!1;a.length&&(n=!0,a=i()(a),r=i()(r));try{let e=this.formatDateRev(t);const l=i()(e);l.isValid()&&n?l>=a&&l<=r&&(console.log("???"),this[`set${s}`](e)):l.isValid()&&!n&&this[`set${s}`](e)}catch(l){console.log(l)}}}}},69617:function(t,e,s){"use strict";var a=s(45296);e["Z"]={methods:{async getFilters(t){try{let e=await a.be.post("/filters/",t);return e}catch(e){console.log(e)}}}}},18241:function(t,e,s){"use strict";var a=s(30381),i=s.n(a),r=s(45296);e["Z"]={title:"uf",data(){return{pers:""}},methods:{finishdate(t,e){let s=2==e?"task":"work",a=this.getProject.history.find((a=>4==a.action.id&&a.level==e&&a[s]==t&&5==a.info.status.id));return this.momentext(a.createdate,"DD.MM.YYYY")},momentext(t,e="DD MMMM YYYY"){if(t)return i()(t).locale("Ru").format(e)},error(t,e){let s=[];for(let[a,i]of Object.entries(this.$v[t][e]))"$"==a[0]||i||s.push(this.errortext[e][a]);return s},getPersonShortFromId(t){console.log(t);try{let e=this.getProject.users.find((e=>e.user.id==t)),s=e.user.givenName.split(" ");return`${e.user.sn} ${s[0][0]}.${s[1][0]}.`}catch{return"Не назначен"}},filename(t){let e=t.split("/");return e=e[e.length-1].split("."),e.shift(),e.join(".")},momentedtime(t){return i()(t).locale("Ru").format("HH:mm DD MMMM YYYY")},momentedDay(t){return i()(t).locale("Ru").format("DD MMMM YYYY")},getDate(t){return i()(t).locale("ru").format("LT")},textdays(t){let e=Math.abs(t)>100?Math.abs(t)%Number(String(Math.abs(t)).split("").slice(1).map(((t,e)=>0==e?1:0)).join("")):Math.abs(t),s=Math.abs(e)%10;if(![11,12,13,14].includes(Math.abs(e))){if([2,3,4].includes(s))return`${Math.abs(t)} дня`;if(1==s)return`${Math.abs(t)} день`}return`${Math.abs(t)} дней`},timediff(t){let e=(new Date).setHours(0,0,0,0),s=i()(t).diff(e,"days"),a="срок сегодня";return s<0?a=`просрочено на ${this.textdays(s)}`:s>0&&(a=`до срока ${this.textdays(s)}`),a},userclicked(t){return r.be.get(`/user/${t}`).then((t=>this.pers=t.data.fullname)),this.pers},reName(t){try{let e=t.givenName.split(" ");return t.sn+" "+e[0][0]+"."+e[1][0]+"."}catch{return"Нет ничего"}},searchUserFullName(t,e){let s=e.find((e=>e.user.id==t));return void 0!=s&&"fullname"in s.user?s.user.fullname:"Не назначен"},searchUser(t,e){let s=e.find((e=>e.user.id==t));return void 0!=s?s.user:{}},pie_statuses_calc(t){let e=t.length,s=100/e,a=[];return t.forEach((t=>{let e=a.findIndex((e=>e.title==t.status.name));-1==e?a.push({title:t.status.name,percent:Number(s.toFixed(1))}):a[e].percent+=Number(s.toFixed(1))})),a},calcdays(t,e,s,a,r){let n=i()(e).diff(i()(t),"days"),l=i()().diff(i()(t),"days"),o={progress:100*l/n,fifteen:Math.round(.15*n)};return o.color=this.calccolor(o.progress,s,a,r),o},calccolor(t,e,s,a){try{return e.id==s?"prliniarstop":e.id!=a?t>=100?"prliniar100":t>=85?"prliniar85":"prliniarelse":""}catch{return""}}}}},37505:function(t,e,s){"use strict";s.d(e,{Z:function(){return h}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",{staticClass:"flex-col flex-grow-1",attrs:{color:t.color,"min-height":t.min_height,elevation:t.elevation}},[s("div",{staticClass:"flex-col  flex-grow-1",class:t.ma},[t._t("cards")],2)])},i=[],r={name:"Cards",props:{color:{type:String,default:"main_theme"},min_height:{type:Number,default:0},ma:{type:String,default:"ma-3"},elevation:{type:Number,default:1}}},n=r,l=s(43736),o=s(43453),c=s.n(o),d=s(34145),u=(0,l.Z)(n,a,i,!1,null,null,null),h=u.exports;c()(u,{VCard:d.Z})},76811:function(t,e,s){"use strict";s.d(e,{Z:function(){return b}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-row",t._l([t.datestart,t.dateend],(function(e,a){return s("v-col",{key:a,class:t.pa,attrs:{xl:"6",lg:"12",md:"6"}},[s("v-menu",{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},scopedSlots:t._u([{key:"activator",fn:function(i){var r=i.on,n=i.attrs;return[s("v-text-field",t._g(t._b({class:t.mb,attrs:{dense:"",value:t.formatDate(e),type:"date-local",placeholder:"дд.мм.гггг","hide-details":"",color:"primaryicons"},on:{focus:function(e){t.datekey=a},input:function(s){return t.oninput(s,e,t.storiter[a],t.min,t.max)}}},"v-text-field",n,!1),r))]}}],null,!0),model:{value:t.picker[a],callback:function(e){t.$set(t.picker,a,e)},expression:"picker[i]"}},[s("v-date-picker",0==a?{attrs:{"first-day-of-week":1,min:t.minimaxon[0][0]?t.min:"",max:t.minimaxon[0][1]?t.max:""},on:{input:function(e){1==a?t.datefrom=!1:t.dateto=!1}},model:{value:t.datestart,callback:function(e){t.datestart=e},expression:"datestart"}}:{attrs:{"first-day-of-week":1,min:t.minimaxon[1][0]?t.min:"",max:t.minimaxon[1][1]?t.max:""},on:{input:function(e){1==a?t.datefrom=!1:t.dateto=!1}},model:{value:t.dateend,callback:function(e){t.dateend=e},expression:"dateend"}})],1)],1)})),1)},i=[],r=s(20629),n=s(35241);const l=(0,r._p)("projectstate"),o=(0,r._p)("taskstate"),c=(0,r._p)("workstate"),d=(0,r._p)("assignmentstate");var u={name:"Datepiker",mixins:[n.Z],props:{datestartstore:{type:String,default:""},dateendstore:{type:String,default:""},minimaxon:{type:Array,default:()=>[[!0,!0],[!0,!0]]},min:{type:String,default:""},max:{type:String,default:""},mb:{type:String,default:"mb-2"},pa:{type:String,default:"pt-0 pb-1"}},data(){return{picker:[0,0],datekey:0}},computed:{storiter(){return[this.datestartstore,this.dateendstore]},datestart:{get(){return this[`get${this.datestartstore}`]()},set(t){this[`set${this.datestartstore}`](t)}},dateend:{get(){return this[`get${this.dateendstore}`]()},set(t){this[`set${this.dateendstore}`](t)}}},methods:{...l.mapGetters(["getProjectdatestart","getProjectdateend"]),...l.mapMutations(["setProjectdatestart","setProjectdateend"]),...o.mapGetters(["getTaskdatestart","getTaskdateend"]),...o.mapMutations(["setTaskdatestart","setTaskdateend"]),...c.mapGetters(["getWorkdatestart","getWorkdateend"]),...c.mapMutations(["setWorkdatestart","setWorkdateend"]),...d.mapGetters(["getAssignmentdatestart","getAssignmentdateend"]),...d.mapMutations(["setAssignmentdatestart","setAssignmentdateend"])}},h=u,m=s(43736),p=s(43453),f=s.n(p),g=s(60266),v=s(71030),_=s(44568),y=s(11713),x=s(17808),k=(0,m.Z)(h,a,i,!1,null,null,null),b=k.exports;f()(k,{VCol:g.Z,VDatePicker:v.Z,VMenu:_.Z,VRow:y.Z,VTextField:x.Z})},43958:function(t,e,s){"use strict";s.d(e,{Z:function(){return v}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-container",{staticClass:"w-100 flex-col shell-filters",attrs:{fluid:""}},[s("v-card",{staticClass:"pa-4"},[s("v-row",{staticClass:"flex-grow-0"},[s("v-col",{staticClass:"flex-row pb-0 pr-5 justify-end"},[t.helper.length?s("v-tooltip",{attrs:{color:"primary",bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[s("v-icon",t._g(t._b({staticStyle:{cursor:"pointer"}},"v-icon",i,!1),a),[t._v(" mdi-help ")])]}}],null,!1,3344710971)},[s("span",[t._v(t._s(t.helper))])]):t._e(),s("v-icon",{class:[t.iconreverse?"up":"","icon-down"],attrs:{color:"icons"},on:{click:t.reverse}},[t._v(" mdi-chevron-up-circle-outline ")])],1)],1),s("v-row",[s("v-col",[s("transition",{attrs:{name:"slide"},on:{afterLeave:t.endAnimation,afterEnter:t.endAnimation}},[t.isShow?s("v-row",{staticClass:"px-4"},[t._t("toptext"),t._t("filterslist"),s("v-col",{staticClass:"pt-0 pr-1 flex-row flex-nowrap align-end justify-end col_btn_apply_reset"},[s("BtnsOut",{attrs:{title:"Применить",height:30,width:120},on:{click:function(e){return t.$emit("sendData")}}}),s("BtnsOut",{attrs:{title:"Сбросить",height:30,width:120},on:{click:function(e){return t.$emit("clear")}}})],1)],2):t._e()],1)],1)],1)],1)],1)},i=[],r={name:"filters-bar",props:{helper:{type:String,default:""},header:{type:String,default:"ФИЛЬТРЫ"}},data(){return{iconreverse:!1,isShow:!0}},methods:{reverse(){this.iconreverse=!this.iconreverse,this.isShow=!this.isShow},endAnimation(){this.$emit("cbArrow")}},beforeDestroy(){this.$store.commit("filterslogic/filtersClear")}},n=r,l=s(43736),o=s(43453),c=s.n(o),d=s(34145),u=s(60266),h=s(82118),m=s(4324),p=s(11713),f=s(82082),g=(0,l.Z)(n,a,i,!1,null,"29eaeed3",null),v=g.exports;c()(g,{VCard:d.Z,VCol:u.Z,VContainer:h.Z,VIcon:m.Z,VRow:p.Z,VTooltip:f.Z})},27114:function(t,e,s){"use strict";s.d(e,{Z:function(){return g}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.tooltip?s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[s("div",t._g(t._b({},"div",i,!1),a),[t.getLoad()?s("v-skeleton-loader",{staticClass:"mr-1",attrs:{type:"button",height:"20",width:"20"}}):s("v-icon",{class:t.cursor?"":"noncursor",attrs:{size:t.size,dense:t.dense,color:t.color,disabled:t.disabled},on:{click:function(e){return t.$emit("click")}}},[t._v(" "+t._s(t.icons)+" ")])],1)]}}],null,!1,3187796371)},[t._v(" "+t._s(t.text_tool)+" ")]):s("div",[t.getLoad()?s("v-skeleton-loader",{staticClass:"mr-1",attrs:{type:"button",height:"20",width:"20"}}):s("v-icon",{attrs:{size:t.size,dense:t.dense,color:t.color,disabled:t.disabled},on:{click:function(e){return t.$emit("click")}}},[t._v(" "+t._s(t.icons)+" ")])],1)},i=[],r=s(20629);const n=(0,r._p)("globalstore");var l={name:"MyIco",props:{size:{type:String,default:""},text_tool:{type:String,default:"Не исользуется"},tooltip:{type:Boolean,default:!1},cursor:{type:Boolean,default:!0},icons:{type:String,default:"mdi-connection"},color:{type:String,default:"btns"},dense:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},methods:{...n.mapGetters(["getLoad"])}},o=l,c=s(43736),d=s(43453),u=s.n(d),h=s(4324),m=s(84978),p=s(82082),f=(0,c.Z)(o,a,i,!1,null,null,null),g=f.exports;u()(f,{VIcon:h.Z,VSkeletonLoader:m.Z,VTooltip:p.Z})},86042:function(t,e,s){"use strict";s.d(e,{Z:function(){return c}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("MyIco",{attrs:{icons:"mdi-lightbulb-outline"},on:{click:t.toggleTheme}})},i=[],r={name:"toggle-theme",methods:{toggleTheme(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark,localStorage.theme=this.$vuetify.theme.dark}},mounted(){null!=localStorage.theme&&(this.$vuetify.theme.dark=JSON.parse(localStorage.theme))}},n=r,l=s(43736),o=(0,l.Z)(n,a,i,!1,null,null,null),c=o.exports},60441:function(t,e,s){"use strict";s.d(e,{Z:function(){return x}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-dialog",{attrs:{transition:"scroll-x-transition","max-width":"800"},on:{"click:outside":function(e){return t.$emit("dialogdetailoff")}},model:{value:t.dialogdetail,callback:function(e){t.dialogdetail=e},expression:"dialogdetail"}},[s("Cards",{attrs:{min_height:500,color:t.$vuetify.theme.dark?"auchdark":"auchlight"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-card-actions",{staticClass:"justify-end pa-0 mr-n1 pb-1"},[s("MyIco",{staticClass:"pa-0",attrs:{icons:"mdi-close-thick",size:"x-small",color:"passiv_text"},on:{click:function(e){return t.$emit("dialogdetailoff")}}})],1),s("v-card-text",{staticClass:"flex-col flex-grow-1"},[s("v-row",{staticClass:"flex-grow-1 pb-2 px-2"},[s("v-col",{staticClass:"flex-col ",attrs:{cols:"7"}},[s("v-row",{staticClass:"flex-grow-0"},[s("v-col",{staticClass:"flex-col pr-1 pa-0",attrs:{cols:"3"}},[s("Cards",{attrs:{min_height:100,color:"inputcolor",ma:"false"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-img",{staticClass:"ma-1",attrs:{height:"90%",src:"http://"+t.url+t.person.avatar}})]},proxy:!0}])})],1),s("v-col",{staticClass:"flex-col pa-0 ",attrs:{cols:"9"}},[s("Cards",{attrs:{min_height:100,color:"inputcolor",ma:"false"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-simple-table",{staticClass:"flex-grow-1 ma-1",scopedSlots:t._u([{key:"default",fn:function(){return[s("tbody",{staticClass:"flex-grow-1"},t._l(t.detailedit,(function(e,a){return s("tr",{key:a,staticClass:"transparent"},[s("td",{staticClass:"pr-0 "},[t._v(" "+t._s(e)+" ")]),s("td",{staticClass:"pr-0"},[t._v(" "+t._s(t.person[a])+" ")])])})),0)]},proxy:!0}])})]},proxy:!0}])})],1)],1),s("v-row",[s("v-col",{staticClass:"flex-col pa-0 pt-1"},[s("Cards",{attrs:{ma:"false",color:"inputcolor"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-simple-table",{staticClass:"flex-grow-1 py-1 ma-1",attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[s("tbody",{staticClass:"flex-grow-1"},t._l(t.detailsextended,(function(e,a){return s("tr",{key:a,staticClass:"transparent"},[s("td",{staticClass:"pr-0 "},[t._v(" "+t._s(e)+" ")]),s("td",{staticClass:"pr-0"},[t._v(" "+t._s(["otdel","department","position"].includes(a)?t.person[a].name:t.person[a])+" ")])])})),0)]},proxy:!0}])})]},proxy:!0}])})],1)],1)],1),s("v-col",{staticClass:"pa-0 pl-1 flex-col"},[s("Cards",{attrs:{ma:"false",color:"inputcolor"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("Cards",{staticClass:"ma-1 elevation-0",attrs:{color:"inyand"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-row",[s("v-col",{staticClass:"align-self-center text-center passiv_text--text"},[t._v(" В проектах не замечен ")])],1)]},proxy:!0}])})]},proxy:!0}])})],1)],1)],1)]},proxy:!0}])})],1)},i=[],r=s(45296),n=s(27114),l=s(37505),o={name:"infousercard",props:{dialogdetail:{type:Boolean,default:!1},person:{type:Object,default:()=>{}}},components:{MyIco:n.Z,Cards:l.Z},data(){return{url:r.Jx,detailedit:{fullname:"ФИО:",telephoneNumber:"Телефон:"},detailsextended:{username:"Имя компьютера:",phone:"Личный телефон:",email:"Почта",physicalDeliveryOfficeName:"Адрес офиса",department:"Департамент",otdel:"Отдел",position:"Должность"}}}},c=o,d=s(43736),u=s(43453),h=s.n(u),m=s(54886),p=s(60266),f=s(34061),g=s(65495),v=s(11713),_=s(9449),y=(0,d.Z)(c,a,i,!1,null,null,null),x=y.exports;h()(y,{VCardActions:m.h7,VCardText:m.ZB,VCol:p.Z,VDialog:f.Z,VImg:g.Z,VRow:v.Z,VSimpleTable:_.Z})},43593:function(t,e,s){"use strict";s.d(e,{Z:function(){return f}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Cards",{staticClass:"dialog_new_assigment",attrs:{color:t.mycolor,elevation:0,ma:t.ma,min_height:t.min_height},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-card-title",{staticClass:"py-0 px-1 mb-2 "},[s("span",{staticClass:"mwight",class:t.text_height},[t._v(" "+t._s(t.text)+" "),t._t("texts")],2)]),s("v-divider",{staticClass:"mb-1"}),t._t("pass"),s("v-row",{staticClass:"overflow-auto overflow-x-hidden my-1 px-5"},[s("v-col",{staticClass:"d-flex flex-col"},[t._t("textarea")],2)],1),s("v-divider",{staticClass:"mb-6 mt-1"}),s("v-row",{staticClass:"align-self-end flex-grow-0"},[s("v-col",{staticClass:"flex-grow-0 pr-0 pt-0"},[t._t("btn1")],2),s("v-col",{staticClass:"pt-0"},[t._t("btn2")],2)],1)]},proxy:!0}],null,!0)})},i=[],r={name:"DialogNewAssigment",data(){return{dialog:!1}},props:{text:{type:String,default:""},text_height:{type:String,default:"text-h6"},pa:{type:String,default:"pa-0"},mycolor:{type:String,default:"inyand"},ma:{type:String,default:"ma-3"},min_height:{type:Number,default:0}}},n=r,l=s(43736),o=s(43453),c=s.n(o),d=s(54886),u=s(60266),h=s(99223),m=s(11713),p=(0,l.Z)(n,a,i,!1,null,null,null),f=p.exports;c()(p,{VCardTitle:d.EB,VCol:u.Z,VDivider:h.Z,VRow:m.Z})},37936:function(t,e,s){"use strict";s.d(e,{Z:function(){return A}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-dialog",{ref:"mainchat",attrs:{persistent:"","max-width":"800","hide-overlay":""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("Cards",{attrs:{color:"inyand",ma:"ma-0"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("DialogNewAssigment",{staticClass:"mmadmin_height",attrs:{mycolor:"'main_theme'",ma:"heightCard_m_mes_admin"},scopedSlots:t._u([{key:"texts",fn:function(){return[null!=t.chat&&null==t.chat.parent&&null!=t.chat.name&&t.user_chatadmin?s("v-text-field",{staticClass:"text-h6  fd",attrs:{"single-line":"",dense:"","hide-details":""},model:{value:t.chatname,callback:function(e){t.chatname=e},expression:"chatname"}}):s("span",{staticClass:"text-h6 se"},[t._v(" Чат")])]},proxy:!0},{key:"pass",fn:function(){return[s("v-row",[s("v-col",[t.user_chatadmin?s("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Поиск","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}):null==t.chat||null!=t.chat.parent||null==t.chat.name||t.user_chatadmin?t._e():s("h4",[t._v(" "+t._s(t.chatname)+" ")])],1)],1),null!=t.chat&&null==t.chat.parent&&t.user_chatadmin?s("v-row",{staticClass:"my-0"},[s("v-col",{staticClass:"px-0"},[s("mUserChanger",{ref:"userchanger",attrs:{chatusers:t.chatusers},on:{activateperson:t.activateperson,admin_del_error:t.admin_del_error,adduserfromsearch:t.adduserfromsearch}})],1)],1):t._e()]},proxy:!0},{key:"textarea",fn:function(){return[s("v-data-table",{staticClass:"ma-2",attrs:{dense:"",headers:t.chatusersHeaders,items:t.chatusers,"hide-default-footer":"","sort-by":"fullname",search:t.search},scopedSlots:t._u([{key:"item.chatman",fn:function(e){var a=e.item;return[s("v-btn",{attrs:{icon:""},on:{click:function(e){t.user_chatadmin&&t.$emit("chatman_change",a)}}},[s("v-icon",{directives:[{name:"show",rawName:"v-show",value:a.chatman,expression:"item.chatman"}],attrs:{color:"green"}},[t._v(" mdi-check-bold")]),s("v-icon",{directives:[{name:"show",rawName:"v-show",value:!a.chatman,expression:"!item.chatman"}]})],1)]}},{key:"item.fullname",fn:function(e){var a=e.item;return[a.id==t.currentuser?s("strong",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.activateperson(a)}}},[t._v(t._s(a.fullname)+" (Вы)")]):s("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.activateperson(a)}}},[t._v(t._s(a.fullname))])]}},{key:"item.admin",fn:function(e){var a=e.item;return[s("v-btn",{attrs:{icon:""},on:{click:function(e){t.user_chatadmin&&t.$emit("admin_change",a)}}},[s("v-icon",{directives:[{name:"show",rawName:"v-show",value:a.admin,expression:"item.admin"}],attrs:{color:"red"}},[t._v(" mdi-star-check-outline")]),s("v-icon",{directives:[{name:"show",rawName:"v-show",value:!a.admin,expression:"!item.admin"}]})],1)]}}],null,!0)})]},proxy:!0},t.user_chatadmin?{key:"btn1",fn:function(){return[s("BtnsOut",{attrs:{title:"Сохранить",disabled:t.adminerror},on:{click:t.confirmchanges}})]},proxy:!0}:null,{key:"btn2",fn:function(){return[s("BtnsOut",{attrs:{title:"Закрыть",disabled:t.adminerror},on:{click:function(e){t.dialog=!1}}})]},proxy:!0}],null,!0)})]},proxy:!0}])})],1),s("v-snackbar",{staticClass:"pt-15",attrs:{timeout:"-1",color:"red lighten-1",top:""},scopedSlots:t._u([{key:"action",fn:function(){return[s("v-btn",{attrs:{color:"white",text:""},on:{click:function(e){return t.$emit("adminerror",!1)}}},[t._v(" Закрыть ")])]},proxy:!0}]),model:{value:t.adminerror,callback:function(e){t.adminerror=e},expression:"adminerror"}},[t._v(" Админ должен быть участником чата ")]),s("infousercard",{attrs:{dialogdetail:t.dialogdetail,person:t.person},on:{dialogdetailoff:function(e){t.dialogdetail=!1}}})],1)},i=[],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",{staticClass:"pa-4"},[s("v-autocomplete",{staticClass:"inputext my-0 iconsh passiv_text--text",attrs:{dense:"",items:t.itemss,loading:t.isLoading,"search-input":t.globalsearch,"item-color":"open_icons",color:"btns",clearable:"","hide-no-data":"","hide-details":"","item-text":"fullname","item-value":"fullname",label:"Глобальный поиск",placeholder:"Начните вводить фамилию","return-object":""},on:{"update:searchInput":function(e){t.globalsearch=e},"update:search-input":function(e){t.globalsearch=e}},model:{value:t.searchbase,callback:function(e){t.searchbase=e},expression:"searchbase"}}),s("v-data-table",{staticClass:"elevation-1  menus1 overflow-y-auto mt-2",attrs:{"hide-default-footer":"","hide-default-header":"",dense:"",headers:t.headers,items:t.fields,"item-key":"id","sort-by":"sn","group-by":"otdel.name",search:t.search},scopedSlots:t._u([{key:"group.header",fn:function(e){var a=e.items,i=e.isOpen,r=e.toggle;return[s("th",{attrs:{colspan:0==t.dialogtype?2:1}},[s("MyIco",{staticClass:"text-center",attrs:{size:"x-small",color:"primaryicons",icons:i?"mdi-minus":"mdi-plus"},on:{click:r}}),t._v(" "+t._s(a[0].otdel.name)+" ")],1)]}},{key:"item.fullname",fn:function(e){var a=e.item;return[a.id==t.getUser.id?s("strong",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.$emit("activateperson",a)}}},[t._v(t._s(a.fullname)+" (Вы)")]):s("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.$emit("activateperson",a)}}},[t._v(t._s(a.fullname))])]}},{key:"item.chatman",fn:function(e){var a=e.item;return[s("MyIco",{attrs:{size:"small",color:a.chatman?"green":"primaryicons",icons:a.chatman?"mdi-check":"mdi-plus"},on:{click:function(e){return t.involving(a)}}})]}}],null,!0)})],1)},n=[],l=s(20629),o=s(45296),c=s(69617),d=s(27114),u=s(37505);const{mapGetters:h}=(0,l._p)("auth");(0,l._p)("auth");var m={props:{dialogtype:{type:Number,default:4},chatusers:{type:Array,default:()=>[]}},components:{MyIco:d.Z,Cards:u.Z},mixins:[c.Z],data(){return{searchbase:null,entries:[],isLoading:!1,globalsearch:null,headers:[{text:"ФИО ",value:"fullname",groupable:!1},{text:"",value:"chatman"}],search:"",organization_value:[],organization:[],department_value:[],department:[],settingsFilt:[],groupName:""}},watch:{chatusers(t){this.chat_users=t,this.itemss.forEach((t=>{t.chatman=this.chat_users.findIndex((e=>e.id==t.id&&1==e.chatman))>-1}))},dialogtype(t){0==t?this.entries=[]:this.firstload()},globalsearch(t){let e=!1;t&&null!=t&&" "!=t&&(this.itemss.length>0&&(e=this.itemss.some((e=>0===e.fullname.toUpperCase().indexOf(t.toUpperCase().trim())))),this.isLoading||e||(this.isLoading=!0,console.log(this.chat_users,"cgusers"),o.be.post("/filters/snistartswith",[{terms:{sn__istartswith:t.trim()}}]).then((t=>{t.data.forEach((t=>{t.chatman=this.chat_users.findIndex((e=>e.id==t.id&&1==e.chatman))>-1})),this.entries=t.data})).catch((t=>{console.log(t)})).finally((()=>{this.isLoading=!1}))))}},computed:{...h(["getUser"]),chat_users:{get(){return this.chatusers},set(t){t.forEach((t=>{t.chatman=this.chat_users.findIndex((e=>e.id==t.id&&1==e.chatman))>-1})),this.chatusers=t}},fields:{get(){return this.searchbase||1==this.dialogtype?this.itemss:[]},set(t){this.fields=t}},itemss:{get(){return this.entries.map((t=>Object.assign({},t)))},set(t){}}},async mounted(){this.firstload()},methods:{alreadyinuser(t){return this.chatusers.findIndex((e=>e.id==t.id))>-1},involving(t){t.chatman=!t.chatman;let e=this.chatusers.find((e=>e.id==t.id));void 0!=e&&1==e.admin?(t.chatman=!0,this.$emit("admin_del_error")):this.$emit("adduserfromsearch",t)},async firstload(){this.build()},build(){this.entries=[]}}},p=m,f=s(43736),g=s(43453),v=s.n(g),_=s(344),y=s(34145),x=s(50629),k=(0,f.Z)(p,r,n,!1,null,"02100e5e",null),b=k.exports;v()(k,{VAutocomplete:_.Z,VCard:y.Z,VDataTable:x.Z});var w=s(60441),C={name:"mmesadmin",components:{mUserChanger:b,infousercard:w.Z},props:{user_chatadmin:{type:Boolean,default:!1},chat:{type:Object,default:()=>{}},chatusers:{type:Array,default:[]},currentuser:{type:Number,default:0},adminerror:{type:Boolean,default:!1}},computed:{chatname:{get(){return this.chat.name},set(t){this.$emit("changechatname",t)}}},data(){return{person:{},changechat:!1,dialog:!1,dialogdetail:!1,search:"",chatusersHeaders:[{text:"Имя",value:"fullname",groupable:!1},{text:"Должность",value:"position.name",align:"right"},{text:"Участник",value:"chatman",align:"right"},{text:"Админ",value:"admin",align:"right"}]}},methods:{adduserfromsearch(t){this.$emit("chatman_add",t)},admin_del_error(){this.$emit("adminerror",!0)},showdial(){this.dialog=!0},confirmchanges(){this.dialog=!1,this.$emit("confirmch")},activateperson(t){this.person=t,this.dialogdetail=!0}}},j=C,$=s(16190),Z=s(60266),V=s(34061),F=s(4324),S=s(11713),I=s(89258),E=s(17808),N=(0,f.Z)(j,a,i,!1,null,null,null),A=N.exports;v()(N,{VBtn:$.Z,VCol:Z.Z,VDataTable:x.Z,VDialog:V.Z,VIcon:F.Z,VRow:S.Z,VSnackbar:I.Z,VTextField:E.Z})},19644:function(t,e,s){"use strict";s.d(e,{Z:function(){return x}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-alert",{staticClass:"pa-3 rounded m-messege-cloud",staticStyle:{border:"1px solid gainsboro"},attrs:{border:t.mess.sender.id==t.getUser.id?"right":"left","colored-border":"",color:t.mess.sender.id==t.getUser.id?"chatik":"chatiknotme",elevation:"0"}},[s("v-row",{staticClass:"rounded",class:t.mess.sender.id==t.getUser.id?"chatinfo":"chatinfonotme"},[t.mess.sender.id==t.getUser.id?s("v-col",{staticClass:"flex-grow-0 pt-1 pl-1"},[s("MyIco",{attrs:{icons:"mdi-close-box",color:"chatico"},on:{click:function(e){return t.delmessager(t.mess)}}})],1):t._e(),s("v-col",{staticClass:" card-text pt_date",class:t.mess.sender.id==t.getUser.id?"text-end pr-0":"text-start flex-grow-0 order-2 pl-0"},[t._v(" "+t._s(t.getDate(t.mess.messagetime))+" ")]),s("v-col",{staticClass:"text-end flex-grow-0 text-nowrap pt-1",class:t.mess.sender.id==t.getUser.id?"pl-2 pr-4":"pr-2 pl-4"},[s("span",{staticClass:"pointer font-weight-medium card-text",on:{click:function(e){return t.$emit("userclicked",t.mess.sender.id)}}},[t._v(" "+t._s(t.mess.sender.sn)+" "+t._s(t.reNames)+". ")])])],1),s("v-row",{staticClass:"my-0"},[s("v-col",{staticClass:"pa-0 pt-1"},[s("v-divider",{staticClass:"chatdevider"})],1)],1),s("v-row",{staticClass:"mt-0 chatmess rounded rounded-t-0 card-text"},[s("v-col",{staticClass:"messwight",class:t.mess.sender.id==t.getUser.id?"pl-2 text-end borderright":"pr-2 borderleft"},[t._v(" "+t._s(t.mess.text)+" ")])],1)],1)},i=[],r=s(56922),n=s(20629),l=s(21780),o=s(18241);const c=(0,n._p)("auth");var d={name:"m-messege-cloud",mixins:[l.Z,o.Z],props:{chatid:{type:Number,default:0},mess:{type:Object,default:()=>({id:0,chat:{id:0}})}},computed:{...c.mapGetters(["getUser"]),reNames(){let t=this.mess.sender.givenName.split(" ");return t[0][0]}},methods:{delmessager(t){r.$.$emit("delmessager",{id:t.id,chat:this.chatid})}}},u=d,h=s(43736),m=s(43453),p=s.n(m),f=s(37359),g=s(60266),v=s(99223),_=s(11713),y=(0,h.Z)(u,a,i,!1,null,null,null),x=y.exports;p()(y,{VAlert:f.Z,VCol:g.Z,VDivider:v.Z,VRow:_.Z})},75694:function(t,e,s){"use strict";s.d(e,{Z:function(){return f}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"rounded inputpad flex-grow-1 flex-col"},[s("v-row",{staticClass:"overflow-auto pr-3 "},[s("v-col",{staticClass:"pr-0",attrs:{id:"enterAmessage"}},[s("v-textarea",{staticClass:"py-0 my-0 overflow-auto inputext",attrs:{id:"sendmessage","background-color":"inyand","auto-grow":"",rows:"0",solo:"",flat:"","hide-details":"",placeholder:"Введите сообщение"},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.sendmessage.apply(null,arguments))}},model:{value:t.textmessage,callback:function(e){t.textmessage=e},expression:"textmessage"}})],1),s("v-col",{staticClass:"flex-grow-0 pl-1 pr-2 align-self-center"},[s("MyIco",{attrs:{icons:"mdi-send",color:"btns",disabled:null==t.textmessage||0==t.textmessage.length},on:{click:t.sendmessage}})],1)],1)],1)},i=[],r=s(56922),n={name:"sendMessege",data(){return{textmessage:null}},props:{chat:{type:Object,default:()=>({users:[{id:""}],admin:{id:0}})}},methods:{sendmessage(){(null!=this.textmessage||this.textmessage.length>0)&&(r.$.$emit("sendmessage",{message:this.textmessage,id:this.chat.id}),this.textmessage=null)}}},l=n,o=s(43736),c=s(43453),d=s.n(c),u=s(60266),h=s(11713),m=s(92648),p=(0,o.Z)(l,a,i,!1,null,null,null),f=p.exports;d()(p,{VCol:u.Z,VRow:h.Z,VTextarea:m.Z})},43803:function(t,e,s){"use strict";s.d(e,{Z:function(){return F}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-row",[s("v-col",{staticClass:"flex-col"},[s("v-row",{staticClass:"mb-1"},[s("v-col",{staticClass:"flex-col pa-0"},[s("Cards",{staticClass:"flex-col",attrs:{ma:"ma-0",color:"inyand",elevation:0},scopedSlots:t._u([{key:"cards",fn:function(){return[s("div",{directives:[{name:"scroll",rawName:"v-scroll.self",value:t.onScroll,expression:"onScroll",modifiers:{self:!0}}],staticClass:"overflow-auto overflow-x-hidden mml-border pa-5 rounded flex-col flex-grow-1 mmlr-heigth "},[s("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:t.waiter,expression:"waiter"}],staticClass:"mb-2 px-4 progressheight",attrs:{indeterminate:"",color:"teal"}}),t._l(t.chat.lastmessage,(function(e,a){return s("div",{key:t.chatplace+"-"+a,staticClass:"pa-0"},[0==a||e.messagetime.split(" ")[0]!=t.chat.lastmessage[a-1].messagetime.split(" ")[0]?s("div",[s("v-row",{staticClass:"flex-grow-0 justify-center mt-0"},[s("v-col",{staticClass:"text-center px-1",class:0==a?"pa-0":"py-0"},[s("v-alert",{staticClass:"py-0",attrs:{dense:"",text:"",color:"btns"}},[s("span",{staticClass:"card-text"},[t._v(" "+t._s(t.getDate(e.messagetime))+" ")])])],1)],1)],1):t._e(),s("v-row",{ref:""+e.id,refInFor:!0,staticClass:"flex-grow-0 mMessegeCloud"},[s("v-col",{staticClass:"px-1"},[s("mMessegeCloud",{attrs:{chatid:t.chat.id,mess:e},on:{userclicked:t.userclicked}})],1)],1)],1)}))],2)]},proxy:!0}])}),s("v-divider",{staticClass:"margDriv"})],1)],1),s("v-row",{directives:[{name:"show",rawName:"v-show",value:t.sender,expression:"sender"}],staticClass:"flex-grow-0 mt-0"},[s("v-col",{staticClass:"rounded-b-lg"},[s("sendMessege",{attrs:{chat:t.chat}})],1)],1)],1),s("mmesadmin",{ref:t.chatplace,attrs:{user_chatadmin:t.user_chatadmin,chatusers:t.chatusers,adminerror:t.adminerror,currentuser:t.getUser().id},on:{chatman_change:t.chatman_change,admin_change:t.admin_change,adminerror:t.adminerrors,confirmch:t.confirmchanges}}),s("infousercard",{attrs:{dialogdetail:t.dialogdetail,person:t.person},on:{dialogdetailoff:function(e){t.dialogdetail=!1}}})],1)},i=[],r=s(45296),n=s(60441),l=s(30381),o=s.n(l),c=s(19644),d=s(37936),u=s(75694),h=s(20629),m=s(56922);const p=(0,h._p)("auth");var f={props:{chatplace:{type:String,default:"mainchat"},header:{type:Boolean,default:!0},waiter:{type:Boolean,default:!1},chat:{type:Object,default:()=>({users:[{id:""}],admin:{id:0}})}},components:{infousercard:n.Z,mMessegeCloud:c.Z,mmesadmin:d.Z,sendMessege:u.Z},data(){return{adminerror:!1,person:{},dialogdetail:!1,chatusers:[],offsetTop:0,textmessage:null,dialog:!1,dialogtype:0,adminmenu:[{text:"Добавить пользователя",icon:"mdi-chat-plus-outline"},{text:"Передать права администратора",icon:"mdi-shield-crown"}]}},computed:{sender(){let t=!1;try{t=this.chat.users.findIndex((t=>t.id==this.getUser().id))>=0}catch{}return t},user_chatadmin(){return"admin"in this.chat&&this.chat.admin.id==this.getUser().id}},created(){m.$.$on("chat_project_users_send",this.chat_project_users_recieved)},methods:{...p.mapGetters(["getUser"]),adminerrors(t){this.adminerror=t},userclicked(t){r.be.get(`/user/${t}`).then((t=>{this.person=t.data,this.dialogdetail=!0})).catch((t=>{console.log(t)}))},chat_project_users_recieved(t){try{this.chatusers=this.preparechatusers(t.payload),this.$refs[t.place].showdial()}catch{}},confirmchanges(){let t=[],e={id:this.chat.id};this.chatusers.forEach((s=>{s.chatman&&t.push(s.id),s.admin&&(e.admin=s.id)})),e.users=t,m.$.$emit("changechatperson",e)},showdial(){this.dialogdetail=!0,this.dialog=!0},chatman_change(t){t.chatman=!t.chatman,t.admin&&t.chatman?t.chatman=!0:!t.chatman&&t.admin&&(this.adminerror=!0,t.chatman=!0)},admin_change(t){t.admin!=t.id&&(this.chatusers.forEach((t=>t.admin=!1)),t.admin=!0,t.chatman=!0)},preparechatusers(t){let e=[],s=[];try{for(let[a,i]of Object.entries(t))"Участники"!=a?e.includes(i.id)||(i.chatman=this.chat.users.findIndex((t=>t.id==i.id))>=0,i.admin=this.chat.admin.id==i.id,s.push(i),e.push(i.id)):i.forEach((t=>{e.includes(t.id)||(t.projectrole=a,t.chatman=this.chat.users.findIndex((e=>e.id==t.id))>=0,t.admin=this.chat.admin.id==t.id,e.push(t.id),s.push(t))}))}catch{}return s},dialogfalse(){},onScroll(t){0==t.target.scrollTop&&this.chat.lastmessage.length>=10&&(this.$emit("waiting"),m.$.$emit("previous",this.chat.id))},scrollbottom(t){t=String(t),setTimeout(this.scroller,200,t)},scroller(t){let e=this.$refs[`${t}`];try{e[0].scrollIntoView({behavior:"smooth"})}catch{}},getDate(t){return o()(t).locale("ru").format("ll")},getName(t){let e=t.split(" "),s=0,a="";while(s<2&&s<e.length)a+=e[s][0].toUpperCase(),s++;return a},textmess(t){this.textmessage=t},chatTitle(t){if(null!=t.name)return t.name;{let e="";return t.users.forEach((t=>{if(t.id!=this.getUser().id){let s=t.givenName.split(" ");e=t.sn+" "+s[0][0]+"."}})),e}}}},g=f,v=s(43736),_=s(43453),y=s.n(_),x=s(37359),k=s(60266),b=s(99223),w=s(29592),C=s(11713),j=s(76392),$=s.n(j),Z=s(13130),V=(0,v.Z)(g,a,i,!1,null,null,null),F=V.exports;y()(V,{VAlert:x.Z,VCol:k.Z,VDivider:b.Z,VProgressLinear:w.Z,VRow:C.Z}),$()(V,{Scroll:Z.Z})},52098:function(t,e,s){"use strict";s.d(e,{Z:function(){return _e}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-row",{staticClass:"messenger-main mm-height"},[s("v-col",{staticClass:"flex-col sm_border"},[s("v-row",{staticClass:"flex-grow-0 align-self-end"},[s("MyIco",{attrs:{icons:"mdi-close-thick",size:"x-small",color:"red"},on:{click:function(e){return t.$emit("closesupogramm")}}})],1),s("v-row",[s("v-col",{staticClass:"flex-col pl-1",attrs:{xl:"3",lg:"3",md:"12",cols:"12"}},[s("v-row",{staticClass:"flex-grow-0 "},[s("v-col",{staticClass:"flex-col pt-0 pb-1 pr-0"},[s("Cards",{attrs:{elevation:0,color:"inyand"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-row",{staticClass:"sm_border rounded"},[s("v-col",{staticClass:"py-0 pr-0"},[s("ui-chat-search",{attrs:{mychats:t.mychats.filter((function(e){return e.users.findIndex((function(e){return e.id==t.getUser.id}))>=0}))},on:{searchdfunc:t.searchdfunc}})],1),s("v-col",{staticClass:"flex-grow-0"},[s("ui-btn-new-chat",{on:{createchat:t.createchat}})],1)],1)]},proxy:!0}])})],1)],1),s("v-row",[s("v-col",{staticClass:"flex-col pt-0 pr-0"},[s("div",{staticClass:"sm_border flex-grow-1 flex-col rounded"},[s("Cards",{staticClass:"overflow-auto h-0",attrs:{elevation:0,color:"inyand",ma:"ma-1"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("ui-spisok-chat",{attrs:{mychats:t.searchd,unreadNumer:t.unreadNumer},on:{activeChat:t.activeChat}})]},proxy:!0}])})],1)])],1)],1),s("v-col",{staticClass:"flex-col pl-1 pt-2",attrs:{xl:"9",lg:"9",md:"12",cols:"12"}},[s("v-row",{staticClass:"flex-grow-0"},[s("v-col",{staticClass:"py-1 flex-col"},[s("div",{staticClass:"sm_border flex-grow-1 flex-col rounded"},[s("Cards",{attrs:{elevation:0,color:"inyand",min_height:48},scopedSlots:t._u([{key:"cards",fn:function(){return[s("ui-name-chat",{ref:"mychat",attrs:{chat:t.activedCh},on:{chatuserdialog:t.chatuserdialog}})]},proxy:!0}])})],1)])],1),s("v-row",[s("v-col",{staticClass:"pt-0 flex-col"},[s("div",{staticClass:"sm_border flex-grow-1 flex-col rounded"},[s("Cards",{attrs:{elevation:0,color:"inyand",ma:"my-0 mx-3"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("ui-chat",{ref:"mychat",attrs:{waiter:t.waiter,chat:t.activedCh,unreadNumer:t.unreadNumer},on:{activeChat:t.activeChat,createchat:t.createchat,userclicked:t.userclicked}})]},proxy:!0}])})],1)])],1),s("v-row",{directives:[{name:"show",rawName:"v-show",value:t.sender,expression:"sender"}],staticClass:"flex-grow-0 mt-1"},[s("v-col",{staticClass:"pt-0"},[s("sendMessege",{attrs:{chat:t.activedCh}})],1)],1)],1)],1)],1),s("infousercard",{attrs:{dialogdetail:t.dialogdetail,person:t.person},on:{dialogdetailoff:function(e){t.dialogdetail=!1}}})],1)},i=[],r=s(60441),n=s(45296),l=s(56922),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-row",[s("v-col",{staticClass:"flex-col m-messege-list"},[s("v-row",{staticClass:"flex-grow-0"},[s("v-col",{staticClass:"flex-col pa-0 mml-border rounded"},[s("Cards",{attrs:{height:"40",elevation:0,color:"inyand"},scopedSlots:t._u([{key:"cards",fn:function(){return["id"in t.chat?s("v-row",{staticClass:"flex-grow-1 "},[s("v-col",{staticClass:"flex-grow-0 py-0 align-self-center"},[s("v-avatar",{class:t.$vuetify.theme.dark?"auchdark":"auchlight",attrs:{size:"28"}},[s("span",{staticClass:"white--text text-caption"},[t._v(t._s(t.getName(t.chatTitle(t.chat))))])])],1),s("v-col",{staticClass:"flex-col pa-0"},[s("v-row",{staticClass:"flex-col flex-grow-0 mt-3"},[s("v-col",{staticClass:"flex-grow-0 py-0 text-caption text-ls"},[t._v(" "+t._s(t.chatTitle(t.chat))+" ")]),s("v-col",{staticClass:"py-0"},[s("span",{staticClass:"text-caption text-ls"},[t._v(" "+t._s(Array.isArray(t.chat.users)?"Кол-во участников: "+t.chat.users.length:"Последнее")+" ")])])],1)],1),s("v-col",{staticClass:"flex-grow-0 py-0 align-self-center"},[s("MyIco",{attrs:{icons:"mdi-menu"},on:{click:function(e){return t.dialogger()}}})],1)],1):s("v-row",{staticClass:"flex-grow-1 bord  rounded"})]},proxy:!0}])})],1)],1),s("v-row",[s("v-col",{staticClass:"mt-2 pa-0 mml-border rounded flex-col"},[s("Cards",{directives:[{name:"scroll",rawName:"v-scroll.self",value:t.onScroll,expression:"onScroll",modifiers:{self:!0}}],staticClass:"overflow-auto",attrs:{height:"20",elevation:0,color:"inyand"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:t.waiter,expression:"waiter"}],staticClass:"mb-2 px-4",attrs:{indeterminate:"",color:"teal"}}),t._l(t.chat.lastmessage,(function(e,a){return s("div",{key:t.chatplace+"-"+a,staticClass:"pa-0"},[0==a||e.messagetime.split(" ")[0]!=t.chat.lastmessage[a-1].messagetime.split(" ")[0]?s("div",[s("v-row",{staticClass:"flex-grow-0 justify-center mt-0"},[s("v-col",{staticClass:"text-center",class:0==a?"pt-0":""},[s("Cards",{staticClass:"body-2",attrs:{color:"inyand",elevation:0,height:"40",ma:"ma-2"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-divider",{staticClass:"mb-2"}),s("span",{staticClass:"text-color-scrollbar"},[t._v(" "+t._s(t.getDate(e.messagetime))+" ")]),s("v-divider",{staticClass:"mt-2"})]},proxy:!0}],null,!0)})],1)],1)],1):t._e(),s("v-row",{ref:""+e.id,refInFor:!0,staticClass:"flex-grow-0"},[s("v-col",[s("mMessegeCloud",{staticClass:"m-messege-list",attrs:{chatid:t.chat.id,mess:e},on:{userclicked:t.userclicked}})],1)],1)],1)}))]},proxy:!0}])})],1)],1),s("v-row",{directives:[{name:"show",rawName:"v-show",value:t.sender,expression:"sender"}],staticClass:"send flex-grow-0"},[s("v-col",{staticClass:"flex-col pa-0 pt-2"},[s("sendMessege",{attrs:{chat:t.chat}})],1)],1)],1),s("mmesadmin",{ref:t.chatplace,attrs:{user_chatadmin:t.user_chatadmin,chat:{id:t.chat.id,name:t.chat.name,parent:t.chat.parent},chatusers:t.chatusers,adminerror:t.adminerror,currentuser:t.getUser().id},on:{chatman_change:t.chatman_change,chatman_add:t.chatman_add,changechatname:t.changechatname,admin_change:t.admin_change,adminerror:t.adminerrors,confirmch:t.confirmchanges}}),s("infousercard",{attrs:{dialogdetail:t.dialogdetail,person:t.person},on:{dialogdetailoff:function(e){t.dialogdetail=!1}}})],1)},c=[],d=s(30381),u=s.n(d),h=s(19644),m=s(37936),p=s(20629),f=s(75694);const g=(0,p._p)("auth");var v={props:{chatplace:{type:String,default:"mainchat"},header:{type:Boolean,default:!0},waiter:{type:Boolean,default:!1},chat:{type:Object,default:()=>({users:[{id:""}],admin:{id:0}})}},components:{mMessegeCloud:h.Z,mmesadmin:m.Z,infousercard:r.Z,sendMessege:f.Z},data(){return{adminerror:!1,person:{},dialogdetail:!1,chatusers:[],offsetTop:0,textmessage:null,dialog:!1,dialogtype:0,adminmenu:[{text:"Добавить пользователя",icon:"mdi-chat-plus-outline"},{text:"Передать права администратора",icon:"mdi-shield-crown"}]}},computed:{sender(){let t=!1;try{t=this.chat.users.findIndex((t=>t.id==this.getUser().id))>=0}catch{}return t},user_chatadmin(){return"admin"in this.chat&&this.chat.admin.id==this.getUser().id}},created(){l.$.$on("chat_project_users_send",this.chat_project_users_recieved),l.$.$on("chat_users_send",this.chat_project_users_recieved)},methods:{...g.mapGetters(["getUser"]),adminerrors(t){this.adminerror=t},chat_project_users_recieved(t){try{this.chatusers=this.preparechatusers(t.payload),this.$refs[t.place].showdial()}catch(e){}},userclicked(t){n.be.get(`/user/${t}`).then((t=>{this.person=t.data,this.dialogdetail=!0})).catch((t=>{console.log(t)}))},confirmchanges(){let t=[],e={id:this.chat.id};if(this.chatusers.forEach((s=>{s.chatman&&t.push(s.id),s.admin&&(e.admin=s.id)})),e.users=t,null!=this.chat.name)e.name=this.chat.name;else if(e.users.length<2)return;l.$.$emit("changechatperson",e)},showdial(){this.dialog=!0},changechatname(t){this.chat.name=t},chatman_add(t){let e=this.chatusers.findIndex((e=>e.id==t.id));-1==e?this.chatusers.push(t):this.chatusers[e].chatman=t.chatman,this.chatusers.length>2&&null==this.chat.name&&(this.chat.name=this.chatusers.map((t=>t.sn)).join("-"))},chatman_change(t){t.chatman=!t.chatman,t.admin&&t.chatman?t.chatman=!0:!t.chatman&&t.admin&&(this.adminerror=!0,t.chatman=!0);let e=[];this.chatusers.forEach((t=>e.push(t))),this.chatusers=e},admin_change(t){t.admin!=t.id&&(this.chatusers.forEach((t=>t.admin=!1)),t.admin=!0,t.chatman=!0)},preparechatusers(t){let e=[],s=[];try{t.forEach((t=>{e.includes(t.id)||(t.chatman=this.chat.users.findIndex((e=>e.id==t.id))>=0,t.admin=this.chat.admin.id==t.id,s.push(t),e.push(t.id))}))}catch{}return s},dialogfalse(){},dialogger(){l.$.$emit("chatuserdialog",{place:this.chatplace,chat:{id:this.chat.id,level:this.chat.level,parent:this.chat.parent,members:{users:this.chat.users,admin:this.chat.admin}}})},onScroll(t){0==t.target.scrollTop&&l.$.$emit("previous",this.chat.id)},scrollbottom(t){t=String(t),setTimeout(this.scroller,200,t)},scroller(t){let e=this.$refs[`${t}`];try{e[0].scrollIntoView({behavior:"smooth"})}catch{}},sendmessage(){l.$.$emit("sendmessage",{message:this.textmessage,id:this.chat.id}),this.textmessage=null},getDate(t){return u()(t).locale("ru").format("ll")},getName(t){let e=t.split(" "),s=0,a="";while(s<2&&s<e.length)a+=e[s][0].toUpperCase(),s++;return a},chatTitle(t){if(null!=t.name)return t.name;{let e="";return t.users.forEach((t=>{if(t.id!=this.getUser().id){let s=t.givenName.split(" ");e=t.sn+" "+s[0][0]+"."}})),e}}},watch:{chat(t){}}},_=v,y=s(43736),x=s(43453),k=s.n(x),b=s(43423),w=s(60266),C=s(99223),j=s(29592),$=s(11713),Z=s(76392),V=s.n(Z),F=s(13130),S=(0,y.Z)(_,o,c,!1,null,"e43fa4ce",null),I=S.exports;k()(S,{VAvatar:b.Z,VCol:w.Z,VDivider:C.Z,VProgressLinear:j.Z,VRow:$.Z}),V()(S,{Scroll:F.Z});var E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-row",{staticClass:"m-chat-list"},[s("v-col",{staticClass:"flex-col chat"},[s("v-row",{staticClass:" flex-grow-0"},[s("v-col",{staticClass:" pa-0 mcl_border rounded "},[s("Cards",{attrs:{height:"40",elevation:0,color:"inyand"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-row",[s("v-col",{staticClass:"py-0"},[s("v-autocomplete",{staticClass:"inputext iconsh",attrs:{dense:"",items:t.mychats,"return-object":"","item-value":"chatTitle(item)","item-text":function(e){return t.chatTitle(e)},"search-input":t.searchat,clearable:""},on:{"update:searchInput":function(e){t.searchat=e},"update:search-input":function(e){t.searchat=e}}})],1),s("v-col",{staticClass:"flex-grow-0 pt-2"},[s("v-menu",{attrs:{"close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[s("v-icon",t._g(t._b({attrs:{small:"",color:"btns"}},"v-icon",i,!1),a),[t._v(" mdi-menu ")])]}}])},[s("v-card",{attrs:{width:"250"}},[s("v-list",[s("v-subheader",[t._v("МЕНЮ")]),s("v-list-item-group",{attrs:{color:"primary"}},t._l(t.creatormenu,(function(e,a){return s("v-list-item",{key:a,on:{click:function(e){return t.dialogger(a)}}},[s("v-list-item-icon",[s("v-icon",[t._v(t._s(e.icon))])],1),s("v-list-item-content",[s("v-list-item-title",[t._v(t._s(e.text)+" ")])],1)],1)})),1)],1)],1)],1)],1)],1)]},proxy:!0}])})],1)],1),s("v-row",[s("v-col",{staticClass:" flex-col"},[s("v-row",{staticClass:"overflow-auto pt-2 chat hj"},[s("v-col",{staticClass:"flex-col mcl_border ind rounded"},[s("v-list",{staticClass:"inyand",attrs:{dense:"",flat:""}},[t._l(t.searchd,(function(e){return s("div",{key:e.id},[s("v-list-item",{on:{click:function(s){return t.$emit("activeChat",e.id)}}},[s("v-list-item-avatar",{staticClass:"ml-0 align-self-center",attrs:{height:"20",width:"20"}},[s("v-avatar",{class:t.$vuetify.theme.dark?"auchdark":"auchlight",attrs:{size:"20"}},[s("span",{staticClass:"white--text text-chat"},[t._v(t._s(t.getName(t.chatTitle(e))))])])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.unreadNumer[e.id]>0,expression:"unreadNumer[mychat.id] > 0"}],staticClass:"px-2 rounded-circle",staticStyle:{position:"absolute",left:"10px",top:"30px",background:"red","z-index":"1000"}},[s("span",{staticClass:"text-caption white--text"},[t._v(t._s(t.unreadNumer[e.id]))])]),s("v-list-item-content",{staticClass:"align-self-center pa-0"},[s("v-list-item-title",{staticClass:"ma-0"},[s("span",{staticClass:"text-subtitle-2"},[t._v(" "+t._s(t.chatTitle(e))+" ")])]),s("v-list-item-subtitle",[s("span",{staticClass:"text-caption"},[t._v(" "+t._s(e.lastmessage.length?e.lastmessage[e.lastmessage.length-1].text.slice(0,20)+(e.lastmessage[e.lastmessage.length-1].text.length>20?"...":""):"")+" ")])])],1)],1),s("v-divider")],1)}))],2)],1)],1)],1)],1)],1),s("v-dialog",{attrs:{"max-width":"500","hide-overlay":""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("mUserSearch",{ref:"usersearch",attrs:{dialogtype:t.dialogtype},on:{createchat:t.createchat}})],1)],1)},N=[],A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"chatBar d-flex pa-1",on:{click:function(e){return t.$emit("goChat",t.chatInf.id)}}},[s("v-avatar",{style:"background-color: #"+t.getcolor(),attrs:{size:"46"}},[s("span",{staticClass:"white--text text-h5"},[t._v(t._s(t.getName()))])]),s("div",{staticClass:"chatInfo ms-2"},[s("div",{staticClass:"chatName"},[t._v(t._s(t.chatInf.name))])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.unreadNumer>0,expression:"unreadNumer > 0"}],staticClass:"informer ml-auto"},[s("v-btn",{attrs:{"x-small":"",disabled:"",fab:"",color:"primary"}},[s("span",{staticClass:"white--text"},[t._v(t._s(t.unreadNumer))])])],1)],1)},M=[],T={props:{chatInf:{type:Object,default:()=>{}},unreadNumer:{type:Number,default:0}},data(){return{chatColor:""}},methods:{getcolor(){return this.chatColor=Math.floor(16777215*Math.random()).toString(16),this.chatColor},getName(){let t=this.chatInf.name.split(" "),e=0,s="";while(e<2&&e<t.length)s+=t[e][0],e++;return s}}},D=T,U=s(16190),L=(0,y.Z)(D,A,M,!1,null,"a980b912",null),z=L.exports;k()(L,{VAvatar:b.Z,VBtn:U.Z});var O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-card",{staticClass:"pa-4"},[1==t.dialogtype?s("v-text-field",{attrs:{label:"Введите название группы"},model:{value:t.groupName,callback:function(e){t.groupName=e},expression:"groupName"}}):t._e(),1==t.dialogtype?s("div",[s("v-card",{staticClass:"px-2 mb-2"},[s("v-autocomplete",{staticClass:"inputext my-0 iconsh",attrs:{items:t.organization,dense:"","hide-details":"","item-color":"open_icons",color:"primaryicons"},on:{change:t.changeorg},model:{value:t.organization_value,callback:function(e){t.organization_value=e},expression:"organization_value"}})],1),s("v-card",{staticClass:"px-2 mb-2"},[s("v-autocomplete",{staticClass:"inputext my-0 iconsh",attrs:{items:t.department,dense:"","hide-details":"","item-color":"open_icons",color:"primaryicons"},on:{change:t.changedep},model:{value:t.department_value,callback:function(e){t.department_value=e},expression:"department_value"}})],1),s("v-card",{staticClass:"px-2 mb-2 "},[s("v-text-field",{staticClass:"inputext pa-0 pr-1",attrs:{"single-line":"","hide-details":"",dense:"",color:"primaryicons"},scopedSlots:t._u([{key:"append",fn:function(){return[s("MyIco",{staticClass:"pt-1",attrs:{size:"small",color:"primaryicons",icons:"mdi-magnify"}})]},proxy:!0},{key:"label",fn:function(){return[s("span",{staticClass:"inputext passiv_text--text"},[t._v(" Поиск ")])]},proxy:!0}],null,!1,1921263733),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1):s("v-autocomplete",{staticClass:"inputext my-0 iconsh passiv_text--text",attrs:{dense:"",items:t.itemss,loading:t.isLoading,"search-input":t.globalsearch,"item-color":"open_icons",color:"btns",clearable:"","hide-no-data":"","hide-details":"","item-text":"fullname","item-value":"fullname",label:"Глобальный поиск",placeholder:"Начните вводить фамилию","return-object":""},on:{"update:searchInput":function(e){t.globalsearch=e},"update:search-input":function(e){t.globalsearch=e}},model:{value:t.searchbase,callback:function(e){t.searchbase=e},expression:"searchbase"}}),s("v-data-table",{staticClass:"elevation-1  menus1 overflow-y-auto mt-2",attrs:{"hide-default-footer":"","hide-default-header":"",dense:"",headers:t.headers,items:t.fields,"item-key":"id","sort-by":"sn","group-by":"otdel.name",search:t.search},scopedSlots:t._u([{key:"group.header",fn:function(e){var a=e.items,i=e.isOpen,r=e.toggle;return[s("th",{attrs:{colspan:0==t.dialogtype?2:1}},[s("MyIco",{staticClass:"text-center",attrs:{size:"x-small",color:"primaryicons",icons:i?"mdi-minus":"mdi-plus"},on:{click:r}}),t._v(" "+t._s(a[0].otdel.name)+" ")],1),1==t.dialogtype?s("th",[s("MyIco",{attrs:{size:"small",color:"primaryicons",icons:t.alreadyinusermany(a[0])?"mdi-minus-box-multiple-outline":"mdi-plus-box-multiple"},on:{click:function(e){return t.involveall(a[0])}}})],1):t._e()]}},{key:"item.involve",fn:function(e){var a=e.item;return[s("MyIco",{attrs:{size:"small",color:t.alreadyinuser(a)?"green":"primaryicons",icons:t.alreadyinuser(a)?"mdi-check":"mdi-plus"},on:{click:function(e){return t.involving(a)}}})]}}],null,!0)}),s("v-btn",{staticClass:"mt-3",attrs:{small:""},on:{click:t.logData}},[t._v(" создать ")])],1)},B=[],P=s(69617),W=s(27114),R=s(37505);const G=(0,p._p)("auth");var Y={props:{dialogtype:{type:Number,default:4}},components:{MyIco:W.Z,Cards:R.Z},mixins:[P.Z],data(){return{searchbase:null,entries:[],isLoading:!1,globalsearch:null,headers:[{text:"ФИО ",value:"fullname",groupable:!1},{text:"",value:"involve"}],search:"",organization_value:[],organization:[],department_value:[],department:[],settingsFilt:[],users:[],groupName:""}},watch:{dialogtype(t){console.log(t),0==t?this.entries=[]:this.firstload()},globalsearch(t){console.log(t,"<<<<<<<<<<<<<<<<<<<");let e=!1;t&&" "!=t&&(this.itemss.length>0&&(e=this.itemss.some((e=>0===e.fullname.toUpperCase().indexOf(t.toUpperCase().trim())))),this.isLoading||e||(this.isLoading=!0,this.settingsFilt=[{user:{sort:"sn",filters:{sn__istartswith:t.trim()},select_related:["otdel","department","organization","position"]}}],n.be.post("/filters/",this.settingsFilt).then((t=>{let e=t.data.user.findIndex((t=>t.id==this.getUser().id));e>-1&&t.data.user.splice(e,1),this.entries=t.data.user})).catch((t=>{console.log(t)})).finally((()=>{this.isLoading=!1}))))}},computed:{fields:{get(){return this.searchbase||1==this.dialogtype?this.itemss:[]},set(t){this.fields=t}},itemss(){return this.entries.map((t=>Object.assign({},t)))}},async mounted(){1==this.dialogtype&&this.firstload()},methods:{...G.mapGetters(["getUser"]),alreadyinuser(t){return this.users.findIndex((e=>e.id==t.id))>-1},alreadyinusermany(t){return!!this.users.some((e=>e.otdel.id==t.otdel.id))},involving(t){let e=this.users.findIndex((e=>e.id==t.id));e>-1?this.users.splice(e,1):0==this.dialogtype?this.users=[t]:-1==e&&1==this.dialogtype&&(t.involve=!0,this.users.push(t))},async changeorg(t){this.department_value=[],this.department=[],this.users=[],this.settingsFilt=[{department:{sort:"name",filters:{department_user__organization__name:t},exclude:[]}}];let e=await this.getFilters(this.settingsFilt);this.build(e.data),this.department_value=this.department[0],await this.changedep(this.department_value)},async changedep(t){this.settingsFilt=[{user:{sort:"sn",filters:{department__name:t,organization__name:this.organization_value},select_related:["otdel","position"]}}];let e=await this.getFilters(this.settingsFilt);this.build(e.data)},async firstload(){this.settingsFilt=[{organization:{starttable:"organization",sort:"id"}},{department:{sort:"id",filters:{department_user__organization:this.getUser().organization.id}}},{user:{sort:"sn",filters:{department__id:this.getUser().department.id},select_related:["otdel","position"]}}];let t=await this.getFilters(this.settingsFilt);this.build(t.data)},build(t){"user"in t?(console.log(t),this.entries=t.user):this.entries=[];for(let[e,s]of Object.entries(t))"user"!=e&&s.map((t=>{this[e].push(t.name),t.id==this.getUser()[e].id&&(this[`${e}_value`]=t.name)}))},logData(){if(this.dialogtype>0&&0==this.groupName.length)return;let t=this.dialogtype>0?this.groupName:null;this.$emit("createchat",{name:t,users:this.users})},notinuserIndex(t){},involveall(t){console.log("involve"),console.log(t);let e=this.users.findIndex((e=>e.otdel.id==t.otdel.id));e>-1?this.users=this.users.filter((e=>e.otdel.id!=t.otdel.id)):this.entries.map((e=>{e.otdel.id==t.otdel.id&&this.users.push(e)}))}}},H=Y,q=s(344),J=s(34145),K=s(50629),Q=s(17808),X=(0,y.Z)(H,O,B,!1,null,"73d780a7",null),tt=X.exports;k()(X,{VAutocomplete:q.Z,VBtn:U.Z,VCard:J.Z,VDataTable:K.Z,VTextField:Q.Z});const et=(0,p._p)("auth");var st={components:{mChatBar:z,mUserSearch:tt},props:{mychats:{type:Array,default:()=>[]},unreadNumer:{type:Object,default:()=>{}}},mounted(){},computed:{searchat:{get(){return this.searchterm},set(t){null!=t&&t.length>0?this.searchd=this.mychats.filter((e=>this.chatTitle(e).match(t))):this.searchd=this.mychats}}},data(){return{creatormenu:[{text:"Начать разговор",icon:"mdi-chat-plus-outline"},{text:"Новая группа",icon:"mdi-forum-outline"}],numb:0,closeOnClick:!0,searchterm:"",searchd:[],dialog:!1,dialogtype:0}},methods:{...et.mapGetters(["getUser"]),dialogger(t){this.dialogtype=t,this.dialog=!0},goChat(t){this.$emit("activeChat",t)},getcolor(){let t=["#8DA399","#7399E1","#B09AE1","#EB9C96","#9ACA8F","#CA8FC4","#C7CA8F","#8FCAFF","#FFB68F","#6E7F80"];return this.chatColor=t[Math.floor(Math.random()*t.length)],this.chatColor},getName(t){let e=t.split(" "),s=0,a="";while(s<2&&s<e.length)a+=e[s][0].toUpperCase(),s++;return a},chatTitle(t){if(null!=t.name)return t.name;{let e="";return t.users.forEach((t=>{if(t.id!=this.getUser().id){let s=t.givenName.split(" ");e=t.sn+" "+s[0][0]+"."}})),e}},itsAlive(t){console.log(t,"OOOOOOOOOOOOOOO"),this.$emit("letsChat",t)},createchat(t){this.dialog=!1,this.$refs.usersearch.users=[],this.$refs.usersearch.groupName="",this.$emit("createchat",t)}},watch:{mychats(){this.searchd=this.mychats}}},at=st,it=s(34061),rt=s(4324),nt=s(65808),lt=s(54525),ot=s(66900),ct=s(79500),dt=s(77912),ut=s(74611),ht=s(44568),mt=s(92540),pt=(0,y.Z)(at,E,N,!1,null,null,null),ft=pt.exports;k()(pt,{VAutocomplete:q.Z,VAvatar:b.Z,VCard:J.Z,VCol:w.Z,VDialog:it.Z,VDivider:C.Z,VIcon:rt.Z,VList:nt.Z,VListItem:lt.Z,VListItemAvatar:ot.Z,VListItemContent:ct.km,VListItemGroup:dt.Z,VListItemIcon:ut.Z,VListItemSubtitle:ct.oZ,VListItemTitle:ct.V9,VMenu:ht.Z,VRow:$.Z,VSubheader:mt.Z});var gt=s(43803),vt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-autocomplete",{attrs:{dense:"",items:t.mychats,"return-object":"","item-value":"chatTitle(item)","item-text":function(e){return t.chatTitle(e)},"search-input":t.searchat,clearable:""},on:{"update:searchInput":function(e){t.searchat=e},"update:search-input":function(e){t.searchat=e}}})},_t=[],yt=s(21780);const{mapGetters:xt}=(0,p._p)("auth");var kt={name:"ui-chet-search",mixins:[yt.Z],props:{mychats:{type:Array,default:()=>[]}},data(){return{searchterm:"",searchd:[]}},computed:{...xt(["getUser"]),searchat:{get(){return this.searchterm},set(t){null!=t&&t.length>0?this.searchd=this.mychats.filter((e=>this.chatTitle(e).match(t))):this.searchd=this.mychats,this.$emit("searchdfunc",this.searchd)}}}},bt=kt,wt=(0,y.Z)(bt,vt,_t,!1,null,null,null),Ct=wt.exports;k()(wt,{VAutocomplete:q.Z});var jt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ui-btn-new-chat"},[s("v-menu",{attrs:{"close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[s("v-icon",t._g(t._b({attrs:{small:"",color:"btns"}},"v-icon",i,!1),a),[t._v(" mdi-menu ")])]}}])},[s("Cards",{attrs:{color:"inyand",ma:"ma-0"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("DialogNewAssigment",{staticClass:"ui-btn-new-chat___dialognewassigment",attrs:{text:"МЕНЮ",text_height:"text-caption",pa:"pa-0",mycolor:"'main_theme'"},scopedSlots:t._u([{key:"textarea",fn:function(){return[s("v-list",{attrs:{dense:""}},[s("v-list-item-group",t._l(t.creatormenu,(function(e,a){return s("v-list-item",{key:a,on:{click:function(e){return t.dialogger(a)}}},[s("v-list-item-icon",{staticClass:"ma-0 my-1 mr-2 ml-1"},[s("MyIco",{attrs:{icons:e.icon}})],1),s("v-list-item-content",[s("v-list-item-title",[t._v(" "+t._s(e.text)+" ")])],1)],1)})),1)],1)]},proxy:!0}])})]},proxy:!0}])})],1),s("v-dialog",{attrs:{"max-width":"500","hide-overlay":""},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[0==t.dialogtype?s("ui-m-dialog-global-search",{ref:"usersearch",on:{createchat:t.createchat}}):t._e(),1==t.dialogtype?s("ui-m-dialog-gruppa",{ref:"usersearch",on:{createchat:t.createchat}}):t._e()],1)],1)},$t=[],Zt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Cards",{attrs:{color:"inyand",ma:"ma-0"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("DialogNewAssigment",{staticClass:"umdgsearch_height",attrs:{text:"Создать разговор",mycolor:"'main_theme'"},scopedSlots:t._u([{key:"textarea",fn:function(){return[s("v-autocomplete",{staticClass:"inputext pa-3 iconsh passiv_text--text",attrs:{dense:"",items:t.itemss,loading:t.isLoading,"search-input":t.globalsearch,"item-color":"open_icons",color:"btns",clearable:"","hide-no-data":"","hide-details":"","item-text":"fullname","item-value":"fullname",label:"Глобальный поиск",placeholder:"Начните вводить фамилию","return-object":""},on:{"update:searchInput":function(e){t.globalsearch=e},"update:search-input":function(e){t.globalsearch=e}},model:{value:t.searchbase,callback:function(e){t.searchbase=e},expression:"searchbase"}}),s("v-data-table",{staticClass:"elevation-1 overflow-y-auto flex-grow-1",attrs:{"hide-default-footer":"","hide-default-header":"",dense:"",headers:t.headers,items:t.fields,"item-key":"id","sort-by":"sn","group-by":"otdel.name",search:t.search},scopedSlots:t._u([{key:"group.header",fn:function(e){var a=e.items,i=e.isOpen,r=e.toggle;return[s("th",{attrs:{colspan:2}},[s("MyIco",{staticClass:"text-center",attrs:{size:"x-small",color:"primaryicons",icons:i?"mdi-minus":"mdi-plus"},on:{click:r}}),t._v(" "+t._s(a[0].otdel.name)+" ")],1)]}},{key:"item.involve",fn:function(e){var a=e.item;return[s("MyIco",{attrs:{size:"small",color:t.alreadyinuser(a)?"green":"primaryicons",icons:t.alreadyinuser(a)?"mdi-check":"mdi-plus"},on:{click:function(e){return t.involving(a)}}})]}}],null,!0)})]},proxy:!0},{key:"btn2",fn:function(){return[s("BtnsOut",{attrs:{title:"Создать"},on:{click:t.logData}})]},proxy:!0}])})]},proxy:!0}])})},Vt=[];const Ft=(0,p._p)("auth");var St={props:{dialogtype:{type:Number,default:4},dialog:{type:Boolean,default:!1}},mixins:[P.Z],data(){return{searchbase:null,entries:[],isLoading:!1,globalsearch:null,headers:[{text:"ФИО ",value:"fullname",groupable:!1},{text:"",value:"involve"}],search:"",settingsFilt:[],users:[]}},watch:{globalsearch(t){console.log(t,"<<<<<<<<<<<<<<<<<<<");let e=!1;t&&" "!=t&&(this.itemss.length>0&&(e=this.itemss.some((e=>0===e.fullname.toUpperCase().indexOf(t.toUpperCase().trim())))),this.isLoading||e||(this.isLoading=!0,this.settingsFilt=[{user:{sort:"sn",filters:{sn__istartswith:t.trim()},select_related:["otdel","department","organization","position"]}}],n.be.post("/filters/",this.settingsFilt).then((t=>{let e=t.data.user.findIndex((t=>t.id==this.getUser().id));e>-1&&t.data.user.splice(e,1),this.entries=t.data.user})).catch((t=>{console.log(t)})).finally((()=>{this.isLoading=!1}))))}},computed:{fields:{get(){return this.searchbase||1==this.dialogtype?this.itemss:[]},set(t){this.fields=t}},itemss(){return this.entries.map((t=>Object.assign({},t)))}},methods:{...Ft.mapGetters(["getUser"]),alreadyinuser(t){return this.users.findIndex((e=>e.id==t.id))>-1},involving(t){let e=this.users.findIndex((e=>e.id==t.id));this.users=e>-1?[]:[t]},logData(){this.$emit("createchat",{name:null,users:this.users})}}},It=St,Et=(0,y.Z)(It,Zt,Vt,!1,null,null,null),Nt=Et.exports;k()(Et,{VAutocomplete:q.Z,VDataTable:K.Z});var At=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Cards",{attrs:{color:"inyand",ma:"ma-0"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("DialogNewAssigment",{attrs:{text:"Создать новую группу",mycolor:"'main_theme'"},scopedSlots:t._u([{key:"textarea",fn:function(){return[s("v-text-field",{attrs:{label:"Введите название группы"},model:{value:t.groupName,callback:function(e){t.groupName=e},expression:"groupName"}}),s("div",[s("v-card",{staticClass:"px-2 mb-2"},[s("v-autocomplete",{staticClass:"inputext my-0 iconsh",attrs:{items:t.organization,dense:"","hide-details":"","item-color":"open_icons",color:"primaryicons"},on:{change:t.changeorg},model:{value:t.organization_value,callback:function(e){t.organization_value=e},expression:"organization_value"}})],1),s("v-card",{staticClass:"px-2 mb-2"},[s("v-autocomplete",{staticClass:"inputext my-0 iconsh",attrs:{items:t.department,dense:"","hide-details":"","item-color":"open_icons",color:"primaryicons"},on:{change:t.changedep},model:{value:t.department_value,callback:function(e){t.department_value=e},expression:"department_value"}})],1),s("v-card",{staticClass:"px-2 mb-2 "},[s("v-text-field",{staticClass:"inputext pa-0 pr-1",attrs:{"single-line":"","hide-details":"",dense:"",color:"primaryicons"},scopedSlots:t._u([{key:"append",fn:function(){return[s("MyIco",{staticClass:"pt-1",attrs:{size:"small",color:"primaryicons",icons:"mdi-magnify"}})]},proxy:!0},{key:"label",fn:function(){return[s("span",{staticClass:"inputext passiv_text--text"},[t._v(" Поиск ")])]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)],1),s("v-data-table",{staticClass:"elevation-1 overflow-y-auto umdgruppa_height ",attrs:{"hide-default-footer":"","hide-default-header":"",dense:"",headers:t.headers,items:t.fields,"item-key":"id","sort-by":"sn","group-by":"otdel.name",search:t.search},scopedSlots:t._u([{key:"group.header",fn:function(e){var a=e.items,i=e.isOpen,r=e.toggle;return[s("th",{attrs:{colspan:1}},[s("MyIco",{staticClass:"text-center",attrs:{size:"x-small",color:"primaryicons",icons:i?"mdi-minus":"mdi-plus"},on:{click:r}}),t._v(" "+t._s(a[0].otdel.name)+" ")],1),s("th",[s("MyIco",{attrs:{size:"small",color:"primaryicons",icons:t.alreadyinusermany(a[0])?"mdi-minus-box-multiple-outline":"mdi-plus-box-multiple"},on:{click:function(e){return t.involveall(a[0])}}})],1)]}},{key:"item.involve",fn:function(e){var a=e.item;return[s("MyIco",{attrs:{size:"small",color:t.alreadyinuser(a)?"green":"primaryicons",icons:t.alreadyinuser(a)?"mdi-check":"mdi-plus"},on:{click:function(e){return t.involving(a)}}})]}}],null,!0)})]},proxy:!0},{key:"btn2",fn:function(){return[s("BtnsOut",{attrs:{title:"Создать"},on:{click:t.logData}})]},proxy:!0}])})]},proxy:!0}])})},Mt=[];const Tt=(0,p._p)("auth");var Dt={mixins:[P.Z],data(){return{entries:[],isLoading:!1,globalsearch:null,headers:[{text:"ФИО ",value:"fullname",groupable:!1},{text:"",value:"involve"}],search:"",organization_value:[],organization:[],department_value:[],department:[],settingsFilt:[],users:[],groupName:""}},watch:{dialogtype(t){console.log(t),0==t?this.entries=[]:this.firstload()},globalsearch(t){console.log(t,"<<<<<<<<<<<<<<<<<<<");let e=!1;t&&" "!=t&&(this.itemss.length>0&&(e=this.itemss.some((e=>0===e.fullname.toUpperCase().indexOf(t.toUpperCase().trim())))),this.isLoading||e||(this.isLoading=!0,this.settingsFilt=[{user:{sort:"sn",filters:{sn__istartswith:t.trim()},select_related:["otdel","department","organization","position"]}}],n.be.post("/filters/",this.settingsFilt).then((t=>{let e=t.data.user.findIndex((t=>t.id==this.getUser().id));e>-1&&t.data.user.splice(e,1),this.entries=t.data.user})).catch((t=>{console.log(t)})).finally((()=>{this.isLoading=!1}))))}},computed:{fields:{get(){return this.itemss},set(t){this.fields=t}},itemss(){return this.entries.map((t=>Object.assign({},t)))}},async mounted(){this.firstload()},methods:{...Tt.mapGetters(["getUser"]),alreadyinuser(t){return this.users.findIndex((e=>e.id==t.id))>-1},alreadyinusermany(t){return!!this.users.some((e=>e.otdel.id==t.otdel.id))},involving(t){console.log("item",t,this.user);let e=this.users.findIndex((e=>e.id==t.id));e>-1?this.users.splice(e,1):(t.involve=!0,this.users.push(t))},async changeorg(t){this.department_value=[],this.department=[],this.users=[],this.settingsFilt=[{department:{sort:"name",filters:{department_user__organization__name:t},exclude:[]}}];let e=await this.getFilters(this.settingsFilt);this.build(e.data),this.department_value=this.department[0],await this.changedep(this.department_value)},async changedep(t){this.settingsFilt=[{user:{sort:"sn",filters:{department__name:t,organization__name:this.organization_value},select_related:["otdel","position"]}}];let e=await this.getFilters(this.settingsFilt);this.build(e.data)},async firstload(){this.settingsFilt=[{organization:{starttable:"organization",sort:"id"}},{department:{sort:"id",filters:{department_user__organization:this.getUser().organization.id}}},{user:{sort:"sn",filters:{department__id:this.getUser().department.id},select_related:["otdel","position"]}}];let t=await this.getFilters(this.settingsFilt);this.build(t.data)},build(t){this.entries="user"in t?t.user:[];for(let[e,s]of Object.entries(t))"user"!=e&&s.map((t=>{this[e].push(t.name),t.id==this.getUser()[e].id&&(this[`${e}_value`]=t.name)}))},logData(){0!=this.groupName.length&&this.$emit("createchat",{name:this.groupName,users:this.users})},involveall(t){let e=this.users.findIndex((e=>e.otdel.id==t.otdel.id));e>-1?this.users=this.users.filter((e=>e.otdel.id!=t.otdel.id)):this.entries.map((e=>{e.otdel.id==t.otdel.id&&this.users.push(e)}))}}},Ut=Dt,Lt=(0,y.Z)(Ut,At,Mt,!1,null,null,null),zt=Lt.exports;k()(Lt,{VAutocomplete:q.Z,VCard:J.Z,VDataTable:K.Z,VTextField:Q.Z});const Ot=(0,p._p)("auth");var Bt={name:"ui-btn-new-chat",components:{UiMDialogGlobalSearch:Nt,UiMDialogGruppa:zt},data(){return{creatormenu:[{text:"Начать разговор",icon:"mdi-chat-plus-outline"},{text:"Новая группа",icon:"mdi-forum-outline"}],dialog:!1,dialogtype:0}},methods:{...Ot.mapGetters(["getUser"]),dialogger(t){this.dialogtype=t,this.dialog=!0},createchat(t){this.dialog=!1,this.$refs.usersearch.users=[],this.$refs.usersearch.groupName="",this.$emit("createchat",t)}}},Pt=Bt,Wt=(0,y.Z)(Pt,jt,$t,!1,null,null,null),Rt=Wt.exports;k()(Wt,{VDialog:it.Z,VIcon:rt.Z,VList:nt.Z,VListItem:lt.Z,VListItemContent:ct.km,VListItemGroup:dt.Z,VListItemIcon:ut.Z,VListItemTitle:ct.V9,VMenu:ht.Z});var Gt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-list",{staticClass:"inyand",attrs:{dense:"",flat:""}},[t._l(t.mychats,(function(e){return s("div",{key:e.id},[s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(a){var i=a.on,r=a.attrs;return[s("v-list-item",t._g(t._b({staticClass:"px-0",on:{click:function(s){return t.$emit("activeChat",e.id)}}},"v-list-item",r,!1),i),[s("v-list-item-avatar",{staticClass:"mx-0 align-self-center",attrs:{height:"20",width:"20"}},[s("v-avatar",{attrs:{color:t.lightdark(e.level,t.$vuetify.theme.dark),size:"20"}},[s("span",{staticClass:"white--text text-chat"},[t._v(t._s(t.getName(t.chatTitle(e))))])])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.unreadNumer[e.id]>0,expression:"unreadNumer[mychat.id] > 0"}],staticClass:"px-2 rounded-circle",staticStyle:{position:"absolute",left:"10px",top:"30px",background:"red","z-index":"1000"}},[s("span",{staticClass:"text-caption white--text"},[t._v(" "+t._s(t.unreadNumer[e.id])+" ")])]),s("v-list-item-content",{staticClass:"align-self-center pa-0"},[s("v-list-item-title",{staticClass:"ma-0"},[s("span",{staticClass:"text-subtitle-2"},[t._v(" "+t._s(t.chatTitle(e))+" ")])]),s("v-list-item-subtitle",[s("span",{staticClass:"text-caption"},[t._v(" "+t._s(e.lastmessage.length?e.lastmessage[e.lastmessage.length-1].text.slice(0,20)+(e.lastmessage[e.lastmessage.length-1].text.length>20?"...":""):"")+" ")])])],1)],1)]}}],null,!0)},[s("span",[t._v(t._s(t.chatTitle(e)))])]),s("v-divider")],1)}))],2)],1)},Yt=[];const Ht=(0,p._p)("auth");var qt={name:"ui-spisok-chat",mixins:[yt.Z],props:{mychats:{type:Array,default:()=>[]},unreadNumer:{type:Object,default:()=>{}}},computed:{...Ht.mapGetters(["getUser"])}},Jt=qt,Kt=s(82082),Qt=(0,y.Z)(Jt,Gt,Yt,!1,null,null,null),Xt=Qt.exports;k()(Qt,{VAvatar:b.Z,VDivider:C.Z,VList:nt.Z,VListItem:lt.Z,VListItemAvatar:ot.Z,VListItemContent:ct.km,VListItemSubtitle:ct.oZ,VListItemTitle:ct.V9,VTooltip:Kt.Z});var te=function(){var t=this,e=t.$createElement,s=t._self._c||e;return"id"in t.chat?s("v-row",{staticClass:"flex-grow-1 flex-nowrap"},[s("v-col",{staticClass:"flex-grow-0 py-0 align-self-center"},[s("v-avatar",{class:t.lightdark(t.chat.level,t.$vuetify.theme.dark),attrs:{size:"28"}},[s("span",{staticClass:"white--text text-caption"},[t._v(t._s(t.getName(t.chatTitle(t.chat))))])])],1),s("v-col",{staticClass:"flex-col align-self-center"},[s("v-row",{staticClass:"flex-col flex-grow-0"},[t.chatTitle(t.chat).length>60?s("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,i=e.attrs;return[s("v-col",t._g(t._b({staticClass:"flex-grow-0 py-0 text-caption text-ls"},"v-col",i,!1),a),[t._v(" "+t._s(t.chatTitle(t.chat).length>60?t.chatTitle(t.chat).slice(0,35)+"...":t.chatTitle(t.chat))+" ")])]}}],null,!1,2179862495)},[s("span",[t._v(t._s(t.chatTitle(t.chat)))])]):s("v-col",{staticClass:"flex-grow-0 py-0 text-caption text-ls"},[t._v(" "+t._s(t.chatTitle(t.chat))+" ")]),s("v-col",{staticClass:"py-0"},[s("span",{staticClass:"text-caption text-ls"},[t._v(" "+t._s(Array.isArray(t.chat.users)?"Кол-во участников: "+t.chat.users.length:"Последнее")+" ")])])],1)],1),s("v-col",{staticClass:"flex-grow-0 py-0 align-self-center"},[s("MyIco",{attrs:{icons:"mdi-menu"},on:{click:function(e){return t.dialogger()}}})],1),s("mmesadmin",{ref:t.chatplace,attrs:{user_chatadmin:t.user_chatadmin,chat:{id:t.chat.id,name:t.chat.name,parent:t.chat.parent},chatusers:t.chatusers,adminerror:t.adminerror,currentuser:t.getUser().id},on:{chatman_change:t.chatman_change,chatman_add:t.chatman_add,changechatname:t.changechatname,admin_change:t.admin_change,adminerror:t.adminerrors,confirmch:t.confirmchanges}})],1):s("v-row",{staticClass:"flex-grow-1 bord rounded"})},ee=[];const se=(0,p._p)("auth");var ae={name:"ui-name-chat",mixins:[yt.Z],props:{chatplace:{type:String,default:"mainchat"},header:{type:Boolean,default:!0},waiter:{type:Boolean,default:!1},chat:{type:Object,default:()=>({users:[{id:""}],admin:{id:0}})}},components:{mmesadmin:m.Z},data(){return{adminerror:!1,person:{},chatusers:[],textmessage:null,dialog:!1}},created(){l.$.$on("chat_project_users_send",this.chat_project_users_recieved),l.$.$on("chat_users_send",this.chat_project_users_recieved)},computed:{user_chatadmin(){return"admin"in this.chat&&this.chat.admin.id==this.getUser().id}},methods:{...se.mapGetters(["getUser"]),adminerrors(t){this.adminerror=t},chat_project_users_recieved(t){console.log("data",t);try{this.chatusers=this.preparechatusers(t.payload),this.$refs[t.place].showdial()}catch(e){console.log(e)}},preparechatusers(t){let e=[],s=[];try{t.forEach((t=>{e.includes(t.id)||(t.chatman=this.chat.users.findIndex((e=>e.id==t.id))>=0,t.admin=this.chat.admin.id==t.id,s.push(t),e.push(t.id))}))}catch{}return s},confirmchanges(){let t=[],e={id:this.chat.id};if(this.chatusers.forEach((s=>{s.chatman&&t.push(s.id),s.admin&&(e.admin=s.id)})),e.users=t,null!=this.chat.name)e.name=this.chat.name;else if(e.users.length<2)return;l.$.$emit("changechatperson",e)},changechatname(t){this.chat.name=t},chatman_add(t){let e=this.chatusers.findIndex((e=>e.id==t.id));-1==e?this.chatusers.push(t):this.chatusers[e].chatman=t.chatman,this.chatusers.length>2&&null==this.chat.name&&(this.chat.name=this.chatusers.map((t=>t.sn)).join("-"))},chatman_change(t){t.chatman=!t.chatman,t.admin&&t.chatman?t.chatman=!0:!t.chatman&&t.admin&&(this.adminerror=!0,t.chatman=!0);let e=[];this.chatusers.forEach((t=>e.push(t))),this.chatusers=e},admin_change(t){t.admin!=t.id&&(this.chatusers.forEach((t=>t.admin=!1)),t.admin=!0,t.chatman=!0)},dialogger(){console.log("jjjj"),l.$.$emit("chatuserdialog",{place:this.chatplace,chat:{id:this.chat.id,level:this.chat.level,parent:this.chat.parent,members:{users:this.chat.users,admin:this.chat.admin}}})}},watch:{chat(t){}}},ie=ae,re=(0,y.Z)(ie,te,ee,!1,null,null,null),ne=re.exports;k()(re,{VAvatar:b.Z,VCol:w.Z,VRow:$.Z,VTooltip:Kt.Z});var le=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-row",{directives:[{name:"scroll",rawName:"v-scroll.self",value:t.onScroll,expression:"onScroll",modifiers:{self:!0}}],staticClass:"overflow-auto h-0 my-1 ui-chat"},[s("v-col",[s("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:t.waiter,expression:"waiter"}],staticClass:"mb-2 px-4",attrs:{indeterminate:"",color:"teal"}}),t._l(t.chat.lastmessage,(function(e,a){return s("div",{key:t.chatplace+"-"+a,staticClass:"pa-0"},[0==a||e.messagetime.split(" ")[0]!=t.chat.lastmessage[a-1].messagetime.split(" ")[0]?s("div",[s("v-row",{staticClass:"flex-grow-0 justify-center mt-0"},[s("v-col",{staticClass:"text-center",class:0==a?"pt-0":""},[s("Cards",{staticClass:"body-2",attrs:{color:"inyand",elevation:0,height:"40",ma:"ma-2"},scopedSlots:t._u([{key:"cards",fn:function(){return[s("v-divider",{staticClass:"mb-2"}),s("span",{staticClass:"text-color-scrollbar"},[t._v(" "+t._s(t.getDate(e.messagetime))+" ")]),s("v-divider",{staticClass:"mt-2"})]},proxy:!0}],null,!0)})],1)],1)],1):t._e(),s("v-row",{ref:""+e.id,refInFor:!0,staticClass:"flex-grow-0"},[s("v-col",[s("mMessegeCloud",{staticClass:"ui-chat",attrs:{chatid:t.chat.id,mess:e},on:{userclicked:t.userclicked}})],1)],1)],1)}))],2)],1)},oe=[];const ce=(0,p._p)("auth");var de={props:{chatplace:{type:String,default:"mainchat"},header:{type:Boolean,default:!0},waiter:{type:Boolean,default:!1},chat:{type:Object,default:()=>({users:[{id:""}],admin:{id:0}})}},components:{mMessegeCloud:h.Z,infousercard:r.Z},data(){return{adminerror:!1,dialogdetail:!1,chatusers:[],offsetTop:0,textmessage:null,dialog:!1,dialogtype:0,adminmenu:[{text:"Добавить пользователя",icon:"mdi-chat-plus-outline"},{text:"Передать права администратора",icon:"mdi-shield-crown"}]}},methods:{userclicked(t){this.$emit("userclicked",t)},...ce.mapGetters(["getUser"]),adminerrors(t){this.adminerror=t},chat_project_users_recieved(t){try{this.chatusers=this.preparechatusers(t.payload),this.$refs[t.place].showdial()}catch(e){}},confirmchanges(){let t=[],e={id:this.chat.id};if(this.chatusers.forEach((s=>{s.chatman&&t.push(s.id),s.admin&&(e.admin=s.id)})),e.users=t,null!=this.chat.name)e.name=this.chat.name;else if(e.users.length<2)return;l.$.$emit("changechatperson",e)},showdial(){this.dialog=!0},changechatname(t){this.chat.name=t},chatman_add(t){let e=this.chatusers.findIndex((e=>e.id==t.id));-1==e?this.chatusers.push(t):this.chatusers[e].chatman=t.chatman,this.chatusers.length>2&&null==this.chat.name&&(this.chat.name=this.chatusers.map((t=>t.sn)).join("-"))},chatman_change(t){t.chatman=!t.chatman,t.admin&&t.chatman?t.chatman=!0:!t.chatman&&t.admin&&(this.adminerror=!0,t.chatman=!0);let e=[];this.chatusers.forEach((t=>e.push(t))),this.chatusers=e},admin_change(t){t.admin!=t.id&&(this.chatusers.forEach((t=>t.admin=!1)),t.admin=!0,t.chatman=!0)},preparechatusers(t){let e=[],s=[];try{t.forEach((t=>{e.includes(t.id)||(t.chatman=this.chat.users.findIndex((e=>e.id==t.id))>=0,t.admin=this.chat.admin.id==t.id,s.push(t),e.push(t.id))}))}catch{}return s},dialogger(){l.$.$emit("chatuserdialog",{place:this.chatplace,chat:{id:this.chat.id,level:this.chat.level,parent:this.chat.parent,members:{users:this.chat.users,admin:this.chat.admin}}})},onScroll(t){0==t.target.scrollTop&&l.$.$emit("previous",this.chat.id)},scrollbottom(t){t=String(t),setTimeout(this.scroller,200,t)},scroller(t){let e=this.$refs[`${t}`];try{e[0].scrollIntoView({behavior:"smooth"})}catch{}},getDate(t){return u()(t).locale("ru").format("ll")}}},ue=de,he=(0,y.Z)(ue,le,oe,!1,null,null,null),me=he.exports;k()(he,{VCol:w.Z,VDivider:C.Z,VProgressLinear:j.Z,VRow:$.Z}),V()(he,{Scroll:F.Z});const pe=(0,p._p)("auth");var fe={name:"messenger-main",components:{mMessegeList:I,mChatList:ft,mMessegeListRight:gt.Z,UiChatSearch:Ct,UiBtnNewChat:Rt,UiSpisokChat:Xt,UiNameChat:ne,UiChat:me,infousercard:r.Z,sendMessege:f.Z},props:{},data(){return{place:"mainchat",waiter:!1,mychats:[{id:0,users:[]}],activedCh:{},unreadNumer:{},totalunr:0,searchd:[],dialogdetail:!1,person:{},offset:1}},computed:{...pe.mapGetters(["getUser"]),sender(){let t=!1;try{t=this.activedCh.users.findIndex((t=>t.id==this.getUser.id))>=0}catch{}return t}},async mounted(){this.ws=new this.$pws,this.ws._retry=!0,this.ws.start("/supogramm"),this.ws.addEvent("onmessage",(t=>{const e=JSON.parse(t.data);if("action"in e){try{this[e.action](e.payload)}catch(s){console.log(s,"ERROR")}console.log(e.action,"DATA_ACTION")}else console.log(e)}))},async created(){l.$.$on("supogrammchatcreate",this.supogrammchatcreate),l.$.$on("sendmessage",this.sendmessage),l.$.$on("previous",this.getprevious),l.$.$on("delmessager",this.delmessager),l.$.$on("chatuserdialog",this.chatuserdialog),l.$.$on("changechatperson",this.changechatperson)},methods:{userclicked(t){n.be.get(`/user/${t}`).then((t=>{this.person=t.data,this.dialogdetail=!0})).catch((t=>{console.log(t)}))},searchdfunc(t){this.searchd=t},delmessager(t){this.ws.send({action:"delmessage",payload:t})},supogrammchatcreate(t){this.ws.send({action:"makechat",payload:t})},changechatperson(t){this.ws.send({action:"updatechatusers",payload:t})},changeactive(t){let e=this.mychats.length>0?this.mychats.filter((e=>e.parent==t.parent&&e.level==t.level)):[void 0];void 0==e[0]?this.ws.send({action:"readnotmychat",payload:t}):l.$.$emit("foundedchat",e[0])},chatuserdialog(t){this.place=t.place,null!=t.chat.parent?this.ws.send({action:"get_chat_project_persons",payload:t.chat}):this.ws.send({action:"get_chat_persons",payload:t.chat.id})},messagedeleted(t){try{let e=this.mychats.findIndex((e=>e.id==t.chat)),s=this.mychats[e].lastmessage.findIndex((e=>e.id==t.id));this.mychats[e].lastmessage.splice(s,1)}catch{}},chat_project_users(t){l.$.$emit("chat_project_users_send",{payload:t,place:this.place})},chat_users(t){l.$.$emit("chat_users_send",{payload:t,place:this.place})},buildchat(t){this.mychats=t.chatlist,this.searchd=this.mychats,"unreaded"in t&&(this.unreaded=t.unreaded,this.totalunr=0,console.log(this.unreaded,"unreadeeeed"),this.unreaded.forEach((t=>{this.unreadNumer[t.chat.id]=t.chat.id in this.unreadNumer?this.unreadNumer[t.chat.id]+1:1,this.totalunr+=1})));try{this.activeChat(this.activedCh.id)}catch{}this.$emit("totaller",this.totalunr)},renew(t){this.ws.stop(),this.ws.start("/supogramm")},sendmessagesubchat(t){this.ws.send({action:"sendmessage",payload:t})},sendmessage(t){this.ws.send({action:"sendmessage",payload:{id:t.id,text:t.message}})},createchat(t){t.level=null,t.parent=null;let e=new Set([this.getUser.id]);t.users.forEach((t=>e.add(t.id))),t.users=Array.from(e),this.ws.send({action:"makechat",payload:t})},newmessageincome(t){let e=this.mychats.findIndex((e=>e.id==t.chat.id));if(console.log("index",this.activedCh),t.sender.id!=this.getUser.id&&(void 0==this.activedCh||0==Object.keys(this.activedCh).length||this.activedCh.id!=t.chat.id)){console.log("ix",e);let s=Object.assign({},this.unreadNumer);s[t.chat.id]=t.chat.id in s?s[t.chat.id]+1:1,this.unreadNumer=s}0!=this.mychats[e].lastmessage.length&&this.mychats[e].lastmessage[this.mychats[e].lastmessage.length-1].id==t.id||this.mychats[e].lastmessage.push(t),this.$refs.mychat.scrollbottom(t.id),t.sender.id!=this.getUser.id&&(this.totalunr+=1,this.$emit("totaller",this.totalunr))},delchat(){this.ws.send({action:"leavechat",payload:{id:1}})},systemmessage(t){},adduser(){this.ws.send({action:"adduser",payload:{chat:1,user:421}})},activeChat(t){try{this.activedCh=this.mychats.find((e=>e.id==t)),this.activedCh.lastmessage.length>0&&this.$refs.mychat.scrollbottom(this.activedCh.lastmessage[this.activedCh.lastmessage.length-1].id)}catch{}},ireadit(){this.ws.send({action:"ireadIt",payload:{chat:this.activedCh.id}})},newunreaded(t){this.unreaded=t,this.totalunr=0,this.unreadNumer={},this.unreaded.forEach((t=>{this.unreadNumer[t.chat.id]=t.chat.id in this.unreadNumer?this.unreadNumer[t.chat.id]+1:1,this.totalunr+=1})),this.$emit("totaller",this.totalunr),console.log("Новые непрочитано",this.unreaded)},getprevious(t){console.log("getprevious");let e=this.mychats.findIndex((e=>e.id==t));if(console.log(Math.ceil(this.mychats[e].lastmessage.length/20),this.mychats[e].lastmessage.length),e>=0&&"lastmessage"in this.mychats[e]&&this.mychats[e].lastmessage.length>0){this.waiter=!0;let s=this.mychats[e].lastmessage.length<20?Math.ceil(this.mychats[e].lastmessage.length/20):Math.ceil(this.mychats[e].lastmessage.length/20)+1;this.ws.send({action:"getprevious",payload:{chat:t,offset:s}})}},takeprev(t){if(console.log(t),t.res.length>0){let e=this.mychats.findIndex((e=>e.id==t.chat));this.mychats[e].lastmessage.length<20?(this.mychats[e].lastmessage=t.res,this.mychats[e].lastmessage=this.mychats[e].lastmessage):this.mychats[e].lastmessage=t.res.concat(this.mychats[e].lastmessage)}this.waiter=!1}},watch:{activedCh(t){try{this.unreadNumer[t.id]>0?this.ireadit():console.log("пусто")}catch{}}},beforeDestroy(){console.log("стоп"),this.ws._retry=!1,this.ws.stop()}},ge=fe,ve=(0,y.Z)(ge,a,i,!1,null,null,null),_e=ve.exports;k()(ve,{VCol:w.Z,VRow:$.Z})},62513:function(t,e,s){var a={"./Assignments.vue":[14400,400],"./Auth.vue":[78766,620,766],"./Calendar.vue":[61739,739],"./Competence.vue":[57183,183],"./Dashboard.vue":[62697,697],"./Documentation.vue":[2002,2],"./Events.vue":[50255,326,255],"./Iteration.vue":[44923,923],"./Main.vue":[73422,422],"./Project.vue":[94752,326,355,747,689,752],"./Projects.vue":[13659,689,620,213],"./Strategy.vue":[90939,939],"./Task.vue":[67641,326,355,747,967,501],"./Tasks.vue":[95107,107],"./Work.vue":[67501,326,355,747,967,435],"./Works.vue":[27533,533],"./pattern/work-task-ass-project.vue":[54355,355,947]};function i(t){if(!s.o(a,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=a[t],i=e[0];return Promise.all(e.slice(1).map(s.e)).then((function(){return s(i)}))}i.keys=function(){return Object.keys(a)},i.id=62513,t.exports=i},2:function(t,e,s){"use strict";t.exports=s.p+"img/FNS-logo-header.01b813a2.png"}},e={};function s(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}s.m=t,function(){var t=[];s.O=function(e,a,i,r){if(!a){var n=1/0;for(d=0;d<t.length;d++){a=t[d][0],i=t[d][1],r=t[d][2];for(var l=!0,o=0;o<a.length;o++)(!1&r||n>=r)&&Object.keys(s.O).every((function(t){return s.O[t](a[o])}))?a.splice(o--,1):(l=!1,r<n&&(n=r));if(l){t.splice(d--,1);var c=i();void 0!==c&&(e=c)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[a,i,r]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.f={},s.e=function(t){return Promise.all(Object.keys(s.f).reduce((function(e,a){return s.f[a](t,e),e}),[]))}}(),function(){s.u=function(t){return"js/"+t+"."+{2:"e7212214",107:"9e136532",183:"34c62510",213:"585dad27",255:"d72cad37",326:"baf1129d",355:"defbe676",400:"2243b9dc",422:"6bc4b6f3",435:"fab11f8a",501:"660786ff",533:"7ce63cb7",620:"7d9c9fd0",689:"9ac47325",697:"7741f8e3",739:"29363b52",747:"e3c27ea6",752:"0f32cc7f",766:"3cc21371",923:"84d50fda",939:"0dae98cb",947:"1dc0632c",967:"f519fe46"}[t]+".js"}}(),function(){s.miniCssF=function(t){return"css/"+t+"."+{2:"4a6830a2",107:"04f928d0",183:"87051035",213:"956b69c6",255:"c5b79e7f",326:"6a25b7c2",400:"aee5e8fb",435:"28f08367",501:"9e88f9bd",533:"3b1b381f",689:"7538a581",747:"210e06e8",752:"b405fe7e",766:"46483184",947:"009fc7f7"}[t]+".css"}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="front:";s.l=function(a,i,r,n){if(t[a])t[a].push(i);else{var l,o;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==e+r){l=u;break}}l||(o=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.setAttribute("data-webpack",e+r),l.src=a),t[a]=[i];var h=function(e,s){l.onerror=l.onload=null,clearTimeout(m);var i=t[a];if(delete t[a],l.parentNode&&l.parentNode.removeChild(l),i&&i.forEach((function(t){return t(s)})),e)return e(s)},m=setTimeout(h.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=h.bind(null,l.onerror),l.onload=h.bind(null,l.onload),o&&document.head.appendChild(l)}}}(),function(){s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){s.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){s.p="/"}(),function(){if("undefined"!==typeof document){var t=function(t,e,s,a,i){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css";var n=function(s){if(r.onerror=r.onload=null,"load"===s.type)a();else{var n=s&&("load"===s.type?"missing":s.type),l=s&&s.target&&s.target.href||e,o=new Error("Loading CSS chunk "+t+" failed.\n("+l+")");o.code="CSS_CHUNK_LOAD_FAILED",o.type=n,o.request=l,r.parentNode.removeChild(r),i(o)}};return r.onerror=r.onload=n,r.href=e,s?s.parentNode.insertBefore(r,s.nextSibling):document.head.appendChild(r),r},e=function(t,e){for(var s=document.getElementsByTagName("link"),a=0;a<s.length;a++){var i=s[a],r=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(r===t||r===e))return i}var n=document.getElementsByTagName("style");for(a=0;a<n.length;a++){i=n[a],r=i.getAttribute("data-href");if(r===t||r===e)return i}},a=function(a){return new Promise((function(i,r){var n=s.miniCssF(a),l=s.p+n;if(e(n,l))return i();t(a,l,null,i,r)}))},i={143:0};s.f.miniCss=function(t,e){var s={2:1,107:1,183:1,213:1,255:1,326:1,400:1,435:1,501:1,533:1,689:1,747:1,752:1,766:1,947:1};i[t]?e.push(i[t]):0!==i[t]&&s[t]&&e.push(i[t]=a(t).then((function(){i[t]=0}),(function(e){throw delete i[t],e})))}}}(),function(){var t={143:0};s.f.j=function(e,a){var i=s.o(t,e)?t[e]:void 0;if(0!==i)if(i)a.push(i[2]);else if(947!=e){var r=new Promise((function(s,a){i=t[e]=[s,a]}));a.push(i[2]=r);var n=s.p+s.u(e),l=new Error,o=function(a){if(s.o(t,e)&&(i=t[e],0!==i&&(t[e]=void 0),i)){var r=a&&("load"===a.type?"missing":a.type),n=a&&a.target&&a.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+n+")",l.name="ChunkLoadError",l.type=r,l.request=n,i[1](l)}};s.l(n,o,"chunk-"+e,e)}else t[e]=0},s.O.j=function(e){return 0===t[e]};var e=function(e,a){var i,r,n=a[0],l=a[1],o=a[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(i in l)s.o(l,i)&&(s.m[i]=l[i]);if(o)var d=o(s)}for(e&&e(a);c<n.length;c++)r=n[c],s.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return s.O(d)},a=self["webpackChunkfront"]=self["webpackChunkfront"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(56922)}));a=s.O(a)})();
//# sourceMappingURL=app.96be870a.js.map