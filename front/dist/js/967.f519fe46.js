"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[967],{49344:function(t,e,s){s.d(e,{Z:function(){return l}});var o=s(16746),i=s(75352),r=(0,i.Ji)("v-breadcrumbs__divider","li"),a=s(96669),n=s(67678),l=(0,n.Z)(a.Z).extend({name:"v-breadcrumbs",props:{divider:{type:String,default:"/"},items:{type:Array,default:()=>[]},large:Boolean},computed:{classes(){return{"v-breadcrumbs--large":this.large,...this.themeClasses}}},methods:{genDivider(){return this.$createElement(r,this.$slots.divider?this.$slots.divider:this.divider)},genItems(){const t=[],e=!!this.$scopedSlots.item,s=[];for(let i=0;i<this.items.length;i++){const r=this.items[i];s.push(r.text),e?t.push(this.$scopedSlots.item({item:r})):t.push(this.$createElement(o.Z,{key:s.join("."),props:r},[r.text])),i<this.items.length-1&&t.push(this.genDivider())}return t}},render(t){const e=this.$slots.default||this.genItems();return t("ul",{staticClass:"v-breadcrumbs",class:this.classes},e)}})},16746:function(t,e,s){var o=s(58860),i=s(67678);e["Z"]=(0,i.Z)(o.Z).extend({name:"v-breadcrumbs-item",props:{activeClass:{type:String,default:"v-breadcrumbs__item--disabled"},ripple:{type:[Boolean,Object],default:!1}},computed:{classes(){return{"v-breadcrumbs__item":!0,[this.activeClass]:this.disabled}}},render(t){const{tag:e,data:s}=this.generateRouteLink();return t("li",[t(e,{...s,attrs:{...s.attrs,"aria-current":this.isActive&&this.isLink?"page":void 0}},this.$slots.default)])}})},10507:function(t,e,s){s.d(e,{Z:function(){return M}});var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-col flex-grow-1"},[s("v-row",{staticClass:"flex-grow-0 ma-0 py-2"},[s("v-col",{staticClass:"flex-grow-1 pl-3 pr-0 pa-2"}),s("div",{staticClass:"positionname"},[s("span",{staticClass:"text-subtitle-1 font-weight-medium text-uppercase"},[t._v(" "+t._s(t.level_helper[t.level].type)+" ")])]),s("v-row",{staticClass:"flex-grow-0  align-self-end pr-2"},[t.checkRESP&&[1].includes(t.todo.status.id)?s("v-col",{staticClass:"pa-3"},[s("MyIco",{attrs:{icons:"mdi-play-circle-outline",color:"open_icons",tooltip:!0,text_tool:"Взять в работу"},on:{click:function(e){return t.$emit("changestatus",{val:t.todo,action:2,h_action:8})}}})],1):t._e(),t.checkRESP&&[2].includes(t.todo.status.id)&&t.childready?s("v-col",{staticClass:"pa-3"},[s("v-menu",{staticClass:"menu2",attrs:{"min-width":"600px","close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[s("div",t._g({},o),[s("MyIco",{attrs:{icons:"mdi-arrow-up-bold-circle-outline",color:"open_icons",tooltip:!0,text_tool:"Отправить на проверку"}})],1)]}}],null,!1,3371919818),model:{value:t.action_confirm,callback:function(e){t.action_confirm=e},expression:"action_confirm"}},[s("DialogNewAssigment",{attrs:{text:"Отчет о состоянии"},scopedSlots:t._u([{key:"textarea",fn:function(){return[s("v-textarea",{staticClass:"py-0 inputext",attrs:{"background-color":"inyand","auto-grow":"",rows:"3",solo:"",flat:"",placeholder:"Комментарий"},model:{value:t.comment_up,callback:function(e){t.comment_up=e},expression:"comment_up"}})]},proxy:!0},{key:"btn1",fn:function(){return[s("BtnsOut",{attrs:{disabled:0==t.comment_up.length,colora:"red",title:"Не выполнено"},on:{click:function(e){return t.chs(!1)}}})]},proxy:!0},{key:"btn2",fn:function(){return[s("BtnsOut",{attrs:{title:"Выполнено"},on:{click:function(e){return t.chs(!0)}}})]},proxy:!0}],null,!1,402323745)})],1)],1):t._e(),[5].includes(t.todo.status.id)?s("v-col",{staticClass:"py-2 px-0"},[s("MyIco",{attrs:{icons:"mdi-checkbox-marked-circle-outline",color:"open_icons",tooltip:!0,cursor:!1,text_tool:(2==t.level?"Задача ":"Работа ")+"завершена"}})],1):t._e(),[4].includes(t.todo.status.id)?s("v-col",{staticClass:"py-2 pr-1"},[s("MyIco",{attrs:{icons:"mdi-calendar-clock",color:"btns",tooltip:!0,cursor:!1,text_tool:"На проверке"}})],1):t._e()],1)],1),s("v-divider"),s("v-alert",{staticClass:"pa-0 pr-1 ma-0",attrs:{dense:"",text:"",color:"btns"}},[s("v-row",{staticClass:"flex-grow-0  ma-0"},[s("v-col",{staticClass:" pa-0"},[s("v-breadcrumbs",{staticClass:"pa-0 justify-end",attrs:{items:t.breadcrumbs},scopedSlots:t._u([{key:"item",fn:function(e){var o=e.item;return[s("v-breadcrumbs-item",{class:0==o.href.length?"pointer":"",attrs:{href:o.href,disabled:o.disabled},on:{click:function(e){0==o.href.length&&t.$emit("listchangetab",0)}}},[s("span",{staticClass:"text_menus--text"},[t._v(" "+t._s(o.text)+" ")])])]}}])})],1)],1)],1),s("v-divider"),s("v-row",{staticClass:"h-0 overflow-auto card-text ma-0 informationorder"},[s("v-col",{staticClass:" flex-col pt-1"},[s("row-pirow",{attrs:{title:"Краткое название:"},scopedSlots:t._u([{key:"leftcol",fn:function(){return[t._v(t._s(t.todo.name))]},proxy:!0}])}),s("row-pirow",{attrs:{title:"Название:"},scopedSlots:t._u([{key:"leftcol",fn:function(){return[s("span",[t._v(t._s(t.todo.longname))])]},proxy:!0}])}),s("row-pirow",{attrs:{title:"Период:"},scopedSlots:t._u([{key:"leftcol",fn:function(){return[t._v(" "+t._s(t.momentedDay(t.todo.datestart)+" - "+t.momentedDay(t.todo.dateend)+"/("+t.timediff(t.todo.dateend)+")")+" ")]},proxy:!0}])}),s("period-info",{attrs:{srok:t.daycalc.fifteen}},[[5!=t.todo.status.id?s("v-progress-linear",{staticClass:"mt-2",staticStyle:{"pointer-events":"none"},attrs:{value:t.daycalc.progress,color:t.daycalc.color,rounded:"",height:"10"}}):t._e()]],2),s("row-pirow",{directives:[{name:"show",rawName:"v-show",value:0==t.indx&&!isNaN(t.workaccepted),expression:"indx==0 && !isNaN(workaccepted)"}],attrs:{title:2==t.level?"Выполнено работ:":"Выполнено поручений:"}}),s("v-row",{directives:[{name:"show",rawName:"v-show",value:0==t.indx&&!isNaN(t.workaccepted),expression:"indx==0 && !isNaN(workaccepted)"}],staticClass:"flex-grow-0 my-0"},[s("v-col",{staticClass:"align-self-center py-0"},[s("v-progress-linear",{staticClass:"mt-0",staticStyle:{"pointer-events":"none"},attrs:{rounded:"",height:"10"},model:{value:t.workaccepted,callback:function(e){t.workaccepted=e},expression:"workaccepted"}})],1),s("v-col",{staticClass:"text-end flex-grow-0 pl-0 py-1"},[s("strong",{staticClass:"ml-auto align-self-center body-2"},[t._v(t._s(Math.ceil(t.workaccepted))+"%")])])],1),s("row-pirow",{attrs:{title:"Сложность реализации:"},scopedSlots:t._u([{key:"leftcol",fn:function(){return[s("v-rating",{staticClass:" ml-n3 star",attrs:{color:"warning","empty-icon":"mdi-star-outline","full-icon":"mdi-star","half-icon":"mdi-star-half-full",hover:"",length:"5",readonly:"",size:"16",value:t.todo.difficult}})]},proxy:!0}])}),s("v-divider",{staticClass:"mt-2 mb-1"}),s("row-pirow",{attrs:{point:!0,stroka:"showuserinfo",title:t.level_helper[t.level].r_text},on:{showuserinfo:function(e){return t.showuserinfo(t.todo.responsible.id)}},scopedSlots:t._u([{key:"leftcol",fn:function(){return[t._v(" "+t._s(t.searchUserFullName(t.todo.responsible.id,t.allpersons))+" ")]},proxy:!0}])}),s("row-pirow",{attrs:{title:"Статус:"},scopedSlots:t._u([{key:"leftcol",fn:function(){return[t._v(" "+t._s(t.todo.status.name+" "+([2,3].includes(t.todo.status.id)?"(взято в работу "+t.momentedDay(t.todo.getstarted)+")":"")+(4==t.todo.status.id?"(с "+t.momentedDay(t.todo.lastchanged)+")":""))+" ")]},proxy:!0}])}),s("v-divider",{staticClass:"my-2 mb-1"}),s("row-pirow",{attrs:{rightcolUsed:!0,title:"Чат:",point:!0,text:""},scopedSlots:t._u([{key:"leftcol",fn:function(){return[s("div",{staticClass:"d-flex"},[s("MyIco",{attrs:{size:"small",icons:"mdi-menu",tooltip:!0,text_tool:"Управление чатом"},on:{click:t.dialogger}}),s("span",{staticClass:"ml-4"},[t._v(" "+t._s(Array.isArray(t.chat.users)?"Кол-во участников: "+t.chat.users.length:"")+" ")])],1)]},proxy:!0},{key:"rightcol",fn:function(){return["id"in t.chat?s("BtnsOut",{staticClass:"mr-1",attrs:{widthi:97,icon:!0,title:t.chatview?"Скрыть Чат":"Показать чат"},on:{click:function(e){return t.$emit("chatviewer")}},scopedSlots:t._u([{key:"icons",fn:function(){return[s("MyIco",{attrs:{size:"small",icons:t.chatview?"mdi-chevron-double-right":"mdi-chevron-double-left"}})]},proxy:!0}])}):s("BtnsOut",{attrs:{widthi:97,icon:!0,title:"Создать чат"},on:{click:function(e){return t.$emit("createtabchat")}},scopedSlots:t._u([{key:"icons",fn:function(){return[s("MyIco",{attrs:{size:"small",icons:"mdi-chat-outline"}})]},proxy:!0}],null,!1,1586076455)})]},proxy:!0}])}),s("v-divider",{staticClass:"mt-3 mb-1"}),s("row-pirow",{attrs:{title:t.level_helper[t.level-1].type,stroka:"linkproject",point:!0},on:{linkproject:function(e){return t.parenthref()}},scopedSlots:t._u([{key:"leftcol",fn:function(){return[t._v(" "+t._s(t.todo.parent.name)+" ")]},proxy:!0}])}),s("row-pirow",{attrs:{title:"Период:"},scopedSlots:t._u([{key:"leftcol",fn:function(){return[t._v(" "+t._s(t.momentedDay(t.todo.parent.datestart)+" - "+t.momentedDay(t.todo.parent.dateend)+" / "+t.timediff(t.todo.parent.dateend))+" ")]},proxy:!0}])}),s("row-pirow",{attrs:{title:t.level_helper[t.level-1].r_text,stroka:"showuserinfo",point:!0},on:{showuserinfo:function(e){return t.showuserinfo(t.parentresp.id)}},scopedSlots:t._u([{key:"leftcol",fn:function(){return[t._v(" "+t._s(t.parentresp.sn)+" "+t._s(t.parentresp.givenName)+" ")]},proxy:!0}])}),s("v-divider",{staticClass:"mt-3 mb-1"}),s("row-pirow",{attrs:{title:"Описание:"},scopedSlots:t._u([{key:"leftcol",fn:function(){return[t._v(" "+t._s(t.todo.description?"":"Описание отсутсвует")+" ")]},proxy:!0}])}),s("v-row",{directives:[{name:"show",rawName:"v-show",value:t.todo.description,expression:"todo.description"}],staticClass:"flex-grow-0 mt-0"},[s("v-col",{staticClass:"pa-0"},[s("v-textarea",{staticClass:"unip",attrs:{id:"description","background-color":"inyand",readonly:"","hide-details":"","auto-grow":"",rows:"0",solo:"",flat:"",value:t.todo.description}})],1)],1),s("v-divider",{staticClass:"mt-3 mb-1"}),s("history-min-card",{attrs:{level:t.level,indx:t.indx},on:{showuserinfo:t.showuserinfo}})],1),s("infousercard",{attrs:{dialogdetail:t.dialogdetail,person:t.person},on:{dialogdetailoff:function(e){t.dialogdetail=!1}}})],1)],1)},i=[],r=s(20629),a=s(18241),n=s(24563),l=s(56922),c=s(30381),d=s.n(c),u=s(60441),p=s(67761),h=s(55322),m=s(70606);const{mapGetters:f}=(0,r._p)("auth"),v=(0,r._p)("workstate"),g=(0,r._p)("taskstate"),_=(0,r._p)("projectstate");var w={name:"informationorders",mixins:[a.Z,n.Z],components:{infousercard:u.Z,rowPirow:p.Z,periodInfo:h.Z,historyMinCard:m.Z},props:{breadcrumbs:{type:Array,requiered:!0},chat:{type:Object,default:()=>{}},chatview:{type:Boolean,default:!0},indx:{type:Number,default:0},level:{type:Number,default:1}},data:()=>({dialogdetail:!1,person:{},show:!1,comment:"",menu:!1,action_confirm:!1,comment_up:"",level_helper:[{},{type:"Проект",responsible:"rp",r_text:"Руководитель проекта",store:"getProject",child:"project_tasks"},{type:"Задача",responsible:"responsible",r_text:"Ответственный",store:"gettasks",child:"task_work"},{type:"Работа",responsible:"responsible",r_text:"Ответственный",store:"getworks",child:"work_assignment"},{type:"Поручение",responsible:"responsible",r_text:"Исполнитель",store:"getworks"}]}),computed:{...f(["getUser"]),...v.mapGetters(["getworks"]),..._.mapGetters(["allpersons","getProject"]),...g.mapGetters(["gettasks"]),daycalc(){return this.calcdays(this.todo.datestart,this.todo.dateend,this.todo.status,3,5)},parentresp(){if(this.level>2)return void 0!=this.todo.parent.responsible?this.todo.parent.responsible:0;{console.log(this.todo,"TODO");let t=this.todo.parent.users;return t=t.find((t=>2==t.role.id)),console.log(t,"aaaa"),void 0!=t?t.user:0}},todo(){let t={parent:this[this.level_helper[this.level-1].store]},e=this.indx>0?this.getworks.work_assignment[this.indx-1]:this[this.level_helper[this.level].store];return console.log({...e,...t},"CURPAR"),{...e,...t}},workaccepted(){try{let t=0;return this.todo[this.level_helper[this.level].child].forEach((e=>{5==e.status.id&&(t+=1)})),t/this.todo[this.level_helper[this.level].child].length*100}catch(t){return"0"}},checkRESP(){return console.log(this.todo,"TOTOTOTODO"),this.todo.responsible.id==this.getUser.id}},mounted(){d().locale("ru")},methods:{...v.mapMutations(["setWorks"]),chs(t){this.$emit("changestatus",{val:this.todo,action:4,h_action:7,comment:this.comment_up.length>0?this.comment_up:null,ididit:t}),this.comment_up="",this.action_confirm=!1},parenthref(){if(0==this.indx){let t=this.$route.path.split("/");t.length=t.length-2,this.$router.push(t.join("/"))}else this.$emit("changetab",0)},childready(){if(this.inf.child in this.inf.data&&0==this.inf.data[this.inf.child].length)return!0;try{return this.inf.data[this.inf.child].every((t=>[3,5].includes(t.status.id)))}catch{return!1}},showuserinfo(t){this.person=this.searchUser(t,this.allpersons),this.dialogdetail=!0},dialogger(){l.$.$emit("chatuserdialog",{place:"rightchat",chat:{id:this.chat.id,level:this.chat.level,parent:this.chat.parent}})}}},y=w,x=s(43736),b=s(43453),k=s.n(b),C=s(37359),Z=s(49344),S=s(16746),$=s(60266),O=s(99223),j=s(44568),N=s(29592),V=s(73905),D=s(11713),A=s(92648),I=(0,x.Z)(y,o,i,!1,null,null,null),M=I.exports;k()(I,{VAlert:C.Z,VBreadcrumbs:Z.Z,VBreadcrumbsItem:S.Z,VCol:$.Z,VDivider:O.Z,VMenu:j.Z,VProgressLinear:N.Z,VRating:V.Z,VRow:D.Z,VTextarea:A.Z})},55188:function(t,e,s){s.d(e,{Z:function(){return g}});var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-row",{staticClass:"flex-grow-0 px-5"},[s("v-col",{staticClass:"pb-0 pt-2"},[s("v-text-field",{staticClass:"mb-0 pt-0",attrs:{label:"Введите краткое название",required:"","hide-details":""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),s("v-row",{staticClass:"flex-grow-0 px-5"},[s("v-col",{staticClass:"pb-0 pt-2"},[s("v-text-field",{staticClass:"mb-0 pt-0",attrs:{label:"Введите полное название",required:"","hide-details":""},model:{value:t.longname,callback:function(e){t.longname=e},expression:"longname"}})],1)],1),s("v-row",{staticClass:"flex-grow-0 px-5"},[s("v-col",{staticClass:"align-self-center py-0"},[s("Datepiker",{attrs:{mb:"mt-0 pt-1",min:t.actionmethod.min,max:t.actionmethod.max,datestartstore:t.actionmethod.datestartstore,dateendstore:t.actionmethod.dateendstore}})],1),s("v-col",{staticClass:"align-self-end py-0"},[s("v-select",{attrs:{"item-text":"text","item-value":"id",items:t.resources,label:t.actionmethod.responsible_text,required:"","return-object":""},model:{value:t.responsible,callback:function(e){t.responsible=e},expression:"responsible"}})],1)],1),s("v-row",{staticClass:"flex-grow-0 px-5"},[s("v-col",{staticClass:"pb-0 pt-2 d-flex"},[s("span",{staticClass:"caption"},[t._v("Сложность:")]),t._v(" "),s("v-rating",{staticClass:"pb-2",attrs:{color:"warning","empty-icon":"mdi-star-outline","full-icon":"mdi-star","half-icon":"mdi-star-half-full",hover:"",length:"5",size:"16"},model:{value:t.difficult,callback:function(e){t.difficult=e},expression:"difficult"}})],1)],1),s("v-row",{staticClass:"px-5 mt-0"},[s("v-col",{staticClass:"py-0"},[s("v-textarea",{staticClass:"inputext aa_border",attrs:{"hide-details":"",label:"Описание",rows:"4","auto-grow":""},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)],1)],1)},i=[],r={name:"AddAssigment",props:{actionmethod:{type:Object,default:()=>{}},dialoginfo:{type:Object,default:()=>({})},resources:{type:Array,default:()=>[]}},computed:{name:{get(){return this.dialoginfo.name},set(t){this.$emit("changeddialog",Object.assign(this.dialoginfo,{name:t}))}},longname:{get(){return this.dialoginfo.longname},set(t){this.$emit("changeddialog",Object.assign(this.dialoginfo,{longname:t}))}},responsible:{get(){return this.dialoginfo.responsible},set(t){this.$emit("changeddialog",Object.assign(this.dialoginfo,{responsible:t}))}},description:{get(){return this.dialoginfo.description},set(t){this.$emit("changeddialog",Object.assign(this.dialoginfo,{description:t}))}},difficult:{get(){return this.dialoginfo.difficult},set(t){this.$emit("changeddialog",Object.assign(this.dialoginfo,{difficult:t}))}}}},a=r,n=s(43736),l=s(43453),c=s.n(l),d=s(60266),u=s(73905),p=s(11713),h=s(57135),m=s(17808),f=s(92648),v=(0,n.Z)(a,o,i,!1,null,null,null),g=v.exports;c()(v,{VCol:d.Z,VRating:u.Z,VRow:p.Z,VSelect:h.Z,VTextField:m.Z,VTextarea:f.Z})}}]);
//# sourceMappingURL=967.f519fe46.js.map