"use strict";(self["webpackChunkfront"]=self["webpackChunkfront"]||[]).push([[766],{65005:function(e,t,r){var s=r(67678),i=r(32500),o=r(54712);t["Z"]=(0,s.Z)(i.Z,(0,o.J)("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>e.$watch("hasError",(t=>{this.$set(this.errorBag,e._uid,t)}),{immediate:!0}),r={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?r.shouldValidate=e.$watch("shouldValidate",(s=>{s&&(this.errorBag.hasOwnProperty(e._uid)||(r.valid=t(e)))})):r.valid=t(e),r},validate(){return 0===this.inputs.filter((e=>!e.validate(!0))).length},reset(){this.inputs.forEach((e=>e.reset())),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)},resetValidation(){this.inputs.forEach((e=>e.resetValidation())),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find((t=>t._uid===e._uid));if(!t)return;const r=this.watchers.find((e=>e._uid===t._uid));r&&(r.valid(),r.shouldValidate()),this.watchers=this.watchers.filter((e=>e._uid!==t._uid)),this.inputs=this.inputs.filter((e=>e._uid!==t._uid)),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},this.$slots.default)}})},6408:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=(0,s.regex)("alpha",/^[a-zA-Z]*$/);t["default"]=i},66195:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=(0,s.regex)("alphaNum",/^[a-zA-Z0-9]*$/);t["default"]=i},75573:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.withParams)({type:"and"},(function(){for(var e=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t.length>0&&t.reduce((function(t,r){return t&&r.apply(e,s)}),!0)}))};t["default"]=i},57884:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(e,t){return(0,s.withParams)({type:"between",min:e,max:t},(function(r){return!(0,s.req)(r)||(!/\s/.test(r)||r instanceof Date)&&+e<=+r&&+t>=+r}))};t["default"]=i},6681:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"withParams",{enumerable:!0,get:function(){return s.default}}),t.regex=t.ref=t.len=t.req=void 0;var s=i(r(58085));function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var n=function(e){if(Array.isArray(e))return!!e.length;if(void 0===e||null===e)return!1;if(!1===e)return!0;if(e instanceof Date)return!isNaN(e.getTime());if("object"===o(e)){for(var t in e)return!0;return!1}return!!String(e).length};t.req=n;var a=function(e){return Array.isArray(e)?e.length:"object"===o(e)?Object.keys(e).length:String(e).length};t.len=a;var l=function(e,t,r){return"function"===typeof e?e.call(t,r):r[e]};t.ref=l;var u=function(e,t){return(0,s.default)({type:e},(function(e){return!n(e)||t.test(e)}))};t.regex=u},34078:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=(0,s.regex)("decimal",/^[-]?\d*(\.\d+)?$/);t["default"]=i},78107:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/,o=(0,s.regex)("email",i);t["default"]=o},40379:function(e,t,r){Object.defineProperty(t,"Ei",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"C1",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"sH",{enumerable:!0,get:function(){return p.default}});var s=P(r(6408)),i=P(r(66195)),o=P(r(75669)),n=P(r(57884)),a=P(r(78107)),l=P(r(9103)),u=P(r(17340)),d=P(r(75287)),c=P(r(23091)),f=P(r(12419)),h=P(r(52941)),m=P(r(28300)),p=P(r(70918)),v=P(r(83213)),w=P(r(15832)),g=P(r(75573)),_=P(r(52500)),b=P(r(42628)),y=P(r(301)),$=P(r(46673)),x=P(r(34078)),C=k(r(6681));function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var s=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};s.get||s.set?Object.defineProperty(t,r,s):t[r]=e[r]}return t.default=e,t}function P(e){return e&&e.__esModule?e:{default:e}}},46673:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=(0,s.regex)("integer",/(^[0-9]*$)|(^-[0-9]+$)/);t["default"]=i},9103:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=(0,s.withParams)({type:"ipAddress"},(function(e){if(!(0,s.req)(e))return!0;if("string"!==typeof e)return!1;var t=e.split(".");return 4===t.length&&t.every(o)}));t["default"]=i;var o=function(e){if(e.length>3||0===e.length)return!1;if("0"===e[0]&&"0"!==e)return!1;if(!e.match(/^\d+$/))return!1;var t=0|+e;return t>=0&&t<=255}},17340:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:":";return(0,s.withParams)({type:"macAddress"},(function(t){if(!(0,s.req)(t))return!0;if("string"!==typeof t)return!1;var r="string"===typeof e&&""!==e?t.split(e):12===t.length||16===t.length?t.match(/.{2}/g):null;return null!==r&&(6===r.length||8===r.length)&&r.every(o)}))};t["default"]=i;var o=function(e){return e.toLowerCase().match(/^[0-9a-f]{2}$/)}},75287:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(e){return(0,s.withParams)({type:"maxLength",max:e},(function(t){return!(0,s.req)(t)||(0,s.len)(t)<=e}))};t["default"]=i},301:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(e){return(0,s.withParams)({type:"maxValue",max:e},(function(t){return!(0,s.req)(t)||(!/\s/.test(t)||t instanceof Date)&&+t<=+e}))};t["default"]=i},23091:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(e){return(0,s.withParams)({type:"minLength",min:e},(function(t){return!(0,s.req)(t)||(0,s.len)(t)>=e}))};t["default"]=i},42628:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(e){return(0,s.withParams)({type:"minValue",min:e},(function(t){return!(0,s.req)(t)||(!/\s/.test(t)||t instanceof Date)&&+t>=+e}))};t["default"]=i},52500:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(e){return(0,s.withParams)({type:"not"},(function(t,r){return!(0,s.req)(t)||!e.call(this,t,r)}))};t["default"]=i},75669:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=(0,s.regex)("numeric",/^[0-9]*$/);t["default"]=i},15832:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.withParams)({type:"or"},(function(){for(var e=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t.length>0&&t.reduce((function(t,r){return t||r.apply(e,s)}),!1)}))};t["default"]=i},12419:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=(0,s.withParams)({type:"required"},(function(e){return"string"===typeof e?(0,s.req)(e.trim()):(0,s.req)(e)}));t["default"]=i},52941:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(e){return(0,s.withParams)({type:"requiredIf",prop:e},(function(t,r){return!(0,s.ref)(e,this,r)||(0,s.req)(t)}))};t["default"]=i},28300:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(e){return(0,s.withParams)({type:"requiredUnless",prop:e},(function(t,r){return!!(0,s.ref)(e,this,r)||(0,s.req)(t)}))};t["default"]=i},70918:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=function(e){return(0,s.withParams)({type:"sameAs",eq:e},(function(t,r){return t===(0,s.ref)(e,this,r)}))};t["default"]=i},83213:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s=r(6681),i=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i,o=(0,s.regex)("url",i);t["default"]=o},58085:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var s="web"==={NODE_ENV:"production",BASE_URL:"/"}.BUILD?r(90016).R:r(98413).withParams,i=s;t["default"]=i},90016:function(e,t,r){function s(e){return s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}t.R=void 0;var i="undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:{},o=function(e,t){return"object"===s(e)&&void 0!==t?t:e((function(){}))},n=i.vuelidate?i.vuelidate.withParams:o;t.R=n},78766:function(e,t,r){r.r(t),r.d(t,{default:function(){return de}});var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-col",{staticClass:"d-flex flex-col"},[r("v-row",{staticClass:"align-self-center entrance"},[r("v-col",{staticClass:"align-self-center d-flex flex-col heightvol"},["before"==e.nowView?r("Form-before",{attrs:{registr:e.registrat,datas:e.user},on:{chView:e.changeView}}):"login"==e.nowView?r("Form-login",{on:{chView:e.changeView,error:e.error}}):"register"==e.nowView?r("Form-registration",{attrs:{registr:e.registrat},on:{chView:e.changeView}}):"restore"==e.nowView?r("Form-restore",{attrs:{user:e.user,registr:e.registrat},on:{chView:e.changeView}}):e._e(),r("v-snackbar",{staticClass:"pt-15",attrs:{color:"red lighten-1",top:"","multi-line":""},scopedSlots:e._u([{key:"action",fn:function(){return[r("v-btn",{attrs:{color:"white",text:""},on:{click:e.closeit}},[e._v(" Закрыть ")])]},proxy:!0}]),model:{value:e.errorview,callback:function(t){e.errorview=t},expression:"errorview"}},[r("h4",[e._v(" "+e._s(e.texterror.header)+" ")]),r("h5",[e._v(" "+e._s(e.texterror.text)+" ")])])],1)],1)],1)},i=[],o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{staticClass:"flex-grow-1"},[r("v-card-title",{staticClass:"bord"},[r("v-col",{staticClass:"pa-0"},[e._v(" Проверка почты ")]),r("v-col",{staticClass:"pa-0 flex-grow-0"},[r("v-btn",{attrs:{icon:""},on:{click:function(t){return t.preventDefault(),e.$emit("chView",{value:"login"})}}},[r("v-icon",{staticClass:"ml-1",attrs:{color:"icons"}},[e._v(" mdi-rotate-45 mdi-plus ")])],1)],1)],1),r("v-card-actions",{staticClass:"flex-col"},[r("v-form",{staticClass:"flex-row"},[r("v-col",{staticClass:"pr-0 align-self-center",attrs:{lg:"2",sm:"12"}},[r("h6",{staticClass:"login"},[e._v(" Лотус ")])]),r("v-col",{attrs:{lg:"10",sm:"12"}},[r("v-card",{attrs:{outlined:"",light:"",height:"40"}},[r("v-text-field",{attrs:{"error-messages":e.Lotus_Errors,label:"Введите почту Lotus",solo:"",flat:"",dense:""},on:{input:function(t){return e.$v.email.$touch()},blur:function(t){return e.$v.email.$touch()}},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1)],1),r("v-col",{staticClass:"pr-0 align-self-center ",attrs:{lg:"2",sm:"12"}},[r("h6",{staticClass:"login "},[e._v("Код")])]),r("v-col",{attrs:{lg:"10",sm:"12"}},[r("v-card",{attrs:{outlined:"",light:"",height:"40"}},[r("v-text-field",{attrs:{"error-messages":e.Numeral_Errors,label:"Введите код",placeholder:"Введите код",disabled:e.dis_key,"hide-details":"false",solo:"",flat:"",dense:""},on:{input:function(t){return e.$v.lotus_password.$touch()},blur:function(t){return e.$v.lotus_password.$touch()}},model:{value:e.lotus_password,callback:function(t){e.lotus_password=t},expression:"lotus_password"}})],1)],1)],1),r("v-col",{staticClass:"pt-4"},[r("v-row",{staticClass:"flex-grow-0 flex-col"},[r("v-col",{staticClass:"align-self-center",attrs:{lg:"6",sm:"12"}},[r("v-btn",{attrs:{color:"btns",block:""},on:{click:e.btnin}},[e._v(" "+e._s(e.dis_key?"Получить код":"Войти на сайт")+" ")])],1)],1),r("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mt-2",attrs:{height:"10",indeterminate:"",color:"btns"}})],1)],1),r("v-snackbar",{staticClass:"pt-15",attrs:{color:e.done?"red lighten-1":"green darken-4",top:""},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.attrs;return[r("v-btn",e._b({attrs:{color:"white",text:""}},"v-btn",s,!1),[e._v(" Закрыть ")])]}}]),model:{value:e.statusReg,callback:function(t){e.statusReg=t},expression:"statusReg"}},[e._v(" "+e._s(e.datas.data)+" ")])],1)},n=[],a=r(28620),l=r(45296);const u=e=>/^[0-9]{6}$/.test(e),d=e=>/^[^,]+$/i.test(e),c=e=>/^([А-Яа-яЁёa-zA-Z0-9\s]+[/]{1}[А-Яа-яЁёa-zA-Z0-9\s]+[/]{1}[А-Яа-яЁёa-zA-Z0-9\s]+)$/i.test(e);var f={name:"before",mixins:[a.oE],props:{registr:{type:Object,default:{type:"",text:[]}},datas:{type:Object,default:{username:"",password:"",data:""}}},data(){return{loading:!1,lotus_key:"",erroror:[],dis_key:!0,email:null,lotus_password:"",done:!0,message:"",username:"",password:"",message:"",statusReg:!0}},validations:{email:{lotusmail:d,lotusmaila:c},lotus_password:{numeral:u}},mounted(){this.snack()},computed:{Lotus_Errors(){const e=[];return this.$v.email.$dirty?(!this.$v.email.lotusmail&&e.push("Не должно содержать запятую"),!this.$v.email.lotusmaila&&e.push("Необходимо два слеша"),e):e},Numeral_Errors(){const e=[];return this.$v.lotus_password.$dirty?(!this.$v.lotus_password.numeral&&e.push("Должно содержать 6 цифр"),e):e}},methods:{snack(){this.message="Аккаунта нет в программе СУП. Подтвердите почту лотус"},async btnin(){this.dis_key?this.sendCode():this.sendConfirm()},async sendCode(){if(console.log("SENDCODE"),this.$v.email.$touch(),console.log(this.$v.email),this.$v.email.$invalid)return this.$v.email.$touch(),void(this.loading=!1);try{this.loading=!0;let e=await l.e0.post("/auth/conf",{action:this.registr.type,email:this.email});this.dis_key=!1,console.log(e.data.secret),this.loading=!1}catch(e){this.loading=!1,this.message=e.response.data.detail,this.$store.commit("auth/setStatusReg",!0)}},async sendConfirm(){this.$v.lotus_password.$invalid?this.$v.lotus_password.$touch():(this.loading=!0,l.e0.post(`/auth/login?lotus_key=${this.lotus_password}`,{username:this.datas.username,password:this.datas.password,email:this.email,lotus_password:this.lotus_password}).then((e=>{this.loading=!1,this.$store.commit("auth/setToken",e.data.access_token),localStorage.setItem("refresh_token",e.data.refresh_token),localStorage.setItem("status_login",!0),this.$router.push({name:"Main"})})).catch((e=>{console.log(e),this.loading=!1})))}}},h=f,m=r(43736),p=r(43453),v=r.n(p),w=r(16190),g=r(34145),_=r(54886),b=r(60266),y=r(65005),$=r(4324),x=r(29592),C=r(11713),k=r(89258),P=r(17808),V=(0,m.Z)(h,o,n,!1,null,null,null),E=V.exports;v()(V,{VBtn:w.Z,VCard:g.Z,VCardActions:_.h7,VCardTitle:_.EB,VCol:b.Z,VForm:y.Z,VIcon:$.Z,VProgressLinear:x.Z,VRow:C.Z,VSnackbar:k.Z,VTextField:P.Z});var q=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-card",{staticClass:"flex-grow-1"},[r("v-card-title",{staticClass:"bord"},[r("v-col",{staticClass:"pa-0"},[e._v(" Вход ")]),r("ToggleTheme",{staticClass:"flex-grow-0"})],1),r("v-card-actions",{staticClass:"flex-col d-flex"},[r("v-form",{staticClass:"flex-row",attrs:{"lazy-validation":""}},[r("v-col",{staticClass:"pr-0 align-self-center",attrs:{lg:"2",sm:"12"}},[r("span",{staticClass:"grey--text grey--text h6"},[e._v(" Логин ")])]),r("v-col",{attrs:{lg:"10",sm:"12"}},[r("v-card",{attrs:{outlined:"",light:"",height:"40",color:this.$vuetify.theme.dark?"white":""}},[r("v-text-field",{attrs:{disabled:e.loading,"background-color":"inputcolor","append-icon":"mdi-account",solo:"",flat:"",dense:"",required:"","loader-height":"10px","error-messages":e.Logins_Errors},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm.apply(null,arguments)},input:function(t){return e.$v.username.$touch()},blur:function(t){return e.$v.username.$touch()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)],1),r("v-col",{staticClass:"pr-0 align-self-center ",attrs:{lg:"2",sm:"12"}},[r("span",{staticClass:"grey--text h6"},[e._v(" Пароль ")])]),r("v-col",{attrs:{lg:"10",sm:"12"}},[r("v-card",{attrs:{outlined:"",light:"",height:"40"}},[r("v-text-field",{attrs:{disabled:e.loading,"background-color":"inputcolor",required:"","append-icon":e.show?"mdi-eye":"mdi-eye-off",type:e.show?"text":"password",solo:"",flat:"",dense:"","error-messages":e.PasswordErrors},on:{"click:append":function(t){e.show=!e.show},keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm.apply(null,arguments)},input:function(t){return e.$v.password.$touch()},blur:function(t){return e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1)],1),r("v-col",{staticClass:"pt-4"},[r("v-row",{staticClass:"flex-grow-0  flex-col d-flex"},[r("v-col",{staticClass:"align-self-center",attrs:{lg:"12",sm:"12"}},[r("v-btn",{attrs:{block:"",color:"inyand--text btns",disabled:e.loading,title:"Войти"},on:{click:e.submitForm}},[e._v("Войти")])],1)],1),r("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"mt-2",attrs:{height:"10",indeterminate:"",color:"btns"}})],1)],1)],1)},O=[],Z=r(86042),j=r(40379);const A=e=>/^([0-9]+[-]{1}[0-9]+[-]{1}[0-9]+)$/i.test(e),z=e=>/^.*(?=.*\d).*$/.test(e),S=e=>/^.*(?=.{8,}).*$/.test(e),F=e=>/^.*(?=.*[a-zA-Z]).*$/.test(e);var M={name:"login",mixins:[a.oE],components:{ToggleTheme:Z.Z},data:()=>({loading:!1,username:"",password:"",show:!1,message:"",done:!0}),validations:{username:{required:j.C1,logins:A},password:{required:j.C1,passwordRule:z,passwordRuleEight:S,passwordRuleLatin:F}},computed:{Logins_Errors(){const e=[];return this.$v.username.$dirty?(!this.$v.username.required&&e.push("Обязательное поле"),!this.$v.username.logins&&e.push("Логин имеет вид 0000-00-000"),e):e},PasswordErrors(){const e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Обязательное поле"),!this.$v.password.passwordRuleLatin&&e.push("Пароль должен содержать латинские символы"),e):e}},methods:{submitForm(){this.$v.username.required&&this.$v.password.required?(this.loading=!0,l.e0.post("/auth/login",{username:this.username,password:this.password}).then((e=>{this.loading=!1,this.$store.commit("auth/setToken",e.data.access_token),localStorage.setItem("refresh_token",e.data.refresh_token),localStorage.setItem("status_login",!0),this.$router.push({name:"Main"})})).catch((e=>{404==e.response.status?(this.loading=!1,this.$emit("chView",{value:"before",datas:{username:this.username,password:this.password,data:e.response.data.detail}},{type:"create"})):401==e.response.status&&(this.loading=!1,this.$emit("error",{header:"Ошибка авторизации",text:"Логин-пароль введены неверно или учетная запись заблокирована"}))}))):this.$v.$touch()}}},R=M,B=(0,m.Z)(R,q,O,!1,null,null,null),L=B.exports;v()(B,{VBtn:w.Z,VCard:g.Z,VCardActions:_.h7,VCardTitle:_.EB,VCol:b.Z,VForm:y.Z,VProgressLinear:x.Z,VRow:C.Z,VTextField:P.Z});var T=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"grid auth-main Form"},[r("v-card",{staticClass:"px-2 px-md-5 pb-4 ma-5 rounded",attrs:{light:"",elevation:"10",color:"#FAFAFA"}},[r("v-card-title",{staticClass:"bord pl-0 "},[e._v(" Регистрация ")]),r("v-container",[r("v-form",{ref:"form",staticClass:"row pt-2",on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{staticClass:"col-12 col-md-4 pt-5",attrs:{"error-messages":e.usernameErrors,light:"",label:"Логин",required:""},on:{input:function(t){return e.$v.username.$touch()},blur:function(t){return e.$v.username.$touch()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),r("v-text-field",{staticClass:"col-12 col-md-4 pt-5",attrs:{autocomplete:"new-password","append-icon":e.show1?"mdi-eye":"mdi-eye-off",light:"","error-messages":e.passwordErrors,label:"Пароль",required:"",type:e.show1?"text":"password",counter:""},on:{input:function(t){return e.$v.password.$touch()},blur:function(t){return e.$v.password.$touch()},"click:append":function(t){e.show1=!e.show1}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),r("v-text-field",{staticClass:"col-12 col-md-4 pt-5",attrs:{"append-icon":e.show2?"mdi-eye":"mdi-eye-off",light:"",type:e.show2?"text":"password",counter:"","error-messages":e.confirmPasswordErrors,label:"Повторите пароль",required:""},on:{input:function(t){return e.$v.confirmPassword.$touch()},blur:function(t){return e.$v.confirmPassword.$touch()},"click:append":function(t){e.show2=!e.show2}},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}}),r("v-text-field",{staticClass:"col-12 col-md-4 pt-5",attrs:{"error-messages":e.first_nameErrors,light:"",label:"Имя",required:""},on:{input:function(t){return e.$v.first_name.$touch()},blur:function(t){return e.$v.first_name.$touch()}},model:{value:e.first_name,callback:function(t){e.first_name=t},expression:"first_name"}}),r("v-text-field",{staticClass:"col-12 col-md-4 pt-5",attrs:{"error-messages":e.last_nameErrors,light:"",label:"Фамилия",required:""},on:{input:function(t){return e.$v.last_name.$touch()},blur:function(t){return e.$v.last_name.$touch()}},model:{value:e.last_name,callback:function(t){e.last_name=t},expression:"last_name"}}),r("v-text-field",{staticClass:"col-12 col-md-4 pt-5",attrs:{"error-messages":e.middle_nameErrors,light:"",label:"Отчество",required:""},on:{input:function(t){return e.$v.middle_name.$touch()},blur:function(t){return e.$v.middle_name.$touch()}},model:{value:e.middle_name,callback:function(t){e.middle_name=t},expression:"middle_name"}}),r("v-text-field",{staticClass:"col-12 col-md-6 pt-5",attrs:{light:"",required:"","error-messages":e.innerphoneErrors,label:"Внутренний номер"},on:{input:function(t){return e.$v.innerphone.$touch()},blur:function(t){return e.$v.innerphone.$touch()}},model:{value:e.innerphone,callback:function(t){e.innerphone=t},expression:"innerphone"}}),r("v-text-field",{staticClass:"col-12 col-md-6 pt-5",attrs:{"error-messages":e.phoneErrors,light:"",label:"Номер телефона",required:""},on:{input:function(t){return e.$v.phone.$touch()},blur:function(t){return e.$v.phone.$touch()}},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),r("v-select",{staticClass:"col-12 col-md-12 pt-5",attrs:{items:e.sel_otdel.division,label:"Подразделение",dense:"",rules:[function(e){return!!e||"Выберете значение поля"}]},on:{input:function(t){e.dis_otdel=!1}},model:{value:e.officein,callback:function(t){e.officein=t},expression:"officein"}}),r("v-select",{staticClass:"col-12 col-md-4 pt-5",attrs:{items:e.sel_otdel.otdel,label:e.sel_otdel.label,dense:"",disabled:e.dis_otdel,rules:[function(e){return!!e||"Выберете значение поля"}]},on:{input:function(t){e.dis_otdel=!1}},model:{value:e.otdelin,callback:function(t){e.otdelin=t},expression:"otdelin"}}),e._l(Object.entries(e.sel_filters),(function(t){var s=t[0],i=t[1];return r("v-select",{key:s,staticClass:"col-12 col-md-4 pt-5",attrs:{"v-model":s,items:i.spisok,label:i.label,dense:"",disabled:e.dis_otdel,rules:[function(e){return!!e||"Выберете значение поля"}]}})})),e.erroror.length>0?r("div",{staticClass:"col-12",staticStyle:{position:"absolute",bottom:"0","z-index":"2",left:"0"}},[r("v-alert",{attrs:{dismissible:"",border:"bottom",type:"error"}},[e._v(" "+e._s(e.errtext())+" ")])],1):e._e(),r("div",{staticClass:"col-6 pt-0"},[r("v-btn",{attrs:{block:"",elevation:"3",type:"submit"}},[e._v(" Отправить ")])],1),r("div",{staticClass:"col-6 pt-0"},[r("v-btn",{attrs:{block:"",elevation:"3"},on:{click:function(t){return t.preventDefault(),e.$emit("chView",{value:"login"})}}},[e._v(" Назад ")])],1)],2)],1)],1)],1)},D=[];const N=e=>/^[A-za-z]+$/i.test(e),I=e=>/^[А-Яа-яЁё]+$/i.test(e),H=e=>/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?!.*\s).*$/.test(e),U=e=>/^(\s*)?(\+)?([- _():=+]?\d[- _():=+]?){1,20}(\s*)?$/.test(e);var J={name:"register",mixins:[a.oE],props:{registr:{type:Object,default:{lotus_key:"",email:""}}},data(){return{valid:!1,erroror:[],show1:!1,show2:!1,username:"qwerty",password:"PASsw0rd",confirmPassword:"PASsw0rd",last_name:"",first_name:"",middle_name:"",innerphone:"1",phone:"1",officein:"",sel_division:[],otdelin:"",sel_otdel:{division:[],otdel:[],label:""},position:"",rank:"",sel_filters:{position:{spisok:[],label:"Должность",model:""},rank:{spisok:[],label:"Чин",model:""}},dis_otdel:!0}},validations:{username:{required:j.C1,latin:N},password:{required:j.C1,minLength:(0,j.Ei)(8),passwordRule:H},confirmPassword:{required:j.C1,minLength:(0,j.Ei)(8),sameAs:(0,j.sH)("password")},last_name:{required:j.C1,cyrillic:I},first_name:{required:j.C1,cyrillic:I},middle_name:{required:j.C1,cyrillic:I},innerphone:{telephonenub:U},phone:{telephonenub:U}},computed:{innerphoneErrors(){const e=[];return this.$v.innerphone.$dirty?(!this.$v.innerphone.telephonenub&&e.push("Поле должно содержать номер телефона"),e):e},phoneErrors(){const e=[];return this.$v.phone.$dirty?(!this.$v.phone.telephonenub&&e.push("Поле должно содержать номер телефона"),e):e},usernameErrors(){const e=[];return this.$v.username.$dirty?(!this.$v.username.required&&e.push("Обязательное поле"),!this.$v.username.latin&&e.push("Поле должно содержать только латинские буквы"),e):e},passwordErrors(){const e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Обязательное поле"),!this.$v.password.minLength&&e.push("Пароль должен быть более 8 символов"),!this.$v.password.passwordRule&&e.push("Cтрочные и прописные латинские буквы, цифры"),e):e},confirmPasswordErrors(){const e=[];return this.$v.confirmPassword.$dirty?(!this.$v.confirmPassword.sameAs&&e.push("Пароли не совпадают"),e):e},last_nameErrors(){const e=[];return this.$v.last_name.$dirty?(!this.$v.last_name.required&&e.push("Обязательное поле"),!this.$v.last_name.cyrillic&&e.push("Поле должно содержать только русские буквы"),e):e},Lotus_Errors(){const e=[];return this.$v.first_name.$dirty?(!this.$v.first_name.required&&e.push("Обязательное поле"),e):e},first_nameErrors(){const e=[];return this.$v.first_name.$dirty?(!this.$v.first_name.required&&e.push("Обязательное поле"),!this.$v.first_name.cyrillic&&e.push("Поле должно содержать только русские буквы"),e):e},middle_nameErrors(){const e=[];return this.$v.middle_name.$dirty?(!this.$v.middle_name.required&&e.push("Обязательное поле"),!this.$v.middle_name.cyrillic&&e.push("Поле должно содержать только русские буквы"),e):e}},async mounted(){const e=await l.e0.post("filters/free",[{division__otdel:{name:"name",sort:"name",related_name:"division__otdel"},position:{name:"name",sort:"id"},rank:{name:"name",sort:"id"}}]);this.sel_division=e.data.division__otdel;for(let[s,i]of Object.entries(this.sel_division))this.sel_otdel.division.push(i.name);for(let[s,i]of Object.entries(e.data))"division__otdel"!=s&&(this.sel_filters[s].spisok=i);const t=this.registr.email.split(" ");this.first_name=t[0],this.middle_name=t[1];const r=t[2].split("/");this.last_name=r[0]},watch:{officein(e){this.sel_otdel.otdel=[],this.sel_otdel.label="";let t=this.sel_division.find((t=>t.name==e)).otdels;for(let[r,s]of Object.entries(t))this.sel_otdel.otdel.push(s.name);this.sel_otdel.label="ФНС"==e?"Управление":"Отдел"}},methods:{errtext(){return this.erroror.map((e=>e)).join(", ")},submit(){this.$refs.form.validate(),this.$v.$error||this.$v.$invalid||!this.valid?this.$v.$touch():(this.erroror=[],l.e0.post(`/auth/register?lotus_key=${this.registr.lotus_key}`,{username:this.username,password:this.password,first_name:this.first_name,last_name:this.last_name,middle_name:this.middle_name,innerphone:this.innerphone,phone:this.phone,email:this.registr.email,otdel:{name:this.otdelin},position:{name:this.position},rank:{name:this.rank}}).then((e=>{this.$emit("chView",{value:"login",status:!0},{error:"Регистрация прошла очень успешно, Поздравляем, возьмите с полки пирожок"})})).catch((e=>{this.error=e.response.data.detail,this.statusReg=!0})))},clear(){this.$v.$reset(),this.username="",this.email="",this.password=""}}},G=J,K=r(37359),Q=r(82118),W=r(57135),X=(0,m.Z)(G,T,D,!1,null,null,null),Y=X.exports;v()(X,{VAlert:K.Z,VBtn:w.Z,VCard:g.Z,VCardTitle:_.EB,VContainer:Q.Z,VForm:y.Z,VSelect:W.Z,VTextField:P.Z});var ee=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"grid auth-main Form"},[r("v-card",{staticClass:"px-2 px-md-5 pb-4 ma-5 rounded-lg",attrs:{light:"",elevation:"10",color:"#FAFAFA"}},[r("v-card-title",{staticClass:"bord"},[e._v("Восстановление пароля")]),r("v-container",[r("v-form",{staticClass:"row pt-2"},[r("v-text-field",{staticClass:"col-12 col-md-6",attrs:{autocomplete:"new-password","append-icon":e.show1?"mdi-eye":"mdi-eye-off",light:"","error-messages":e.passwordErrors,label:"Новый Пароль",required:"",type:e.show1?"text":"password",counter:""},on:{input:function(t){return e.$v.password.$touch()},blur:function(t){return e.$v.password.$touch()},"click:append":function(t){e.show1=!e.show1}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),r("v-text-field",{staticClass:"col-12 col-md-6",attrs:{autocomplete:"new-password","append-icon":e.show2?"mdi-eye":"mdi-eye-off",light:"",type:e.show2?"text":"password",counter:"","error-messages":e.confirmPasswordErrors,label:"Повторите пароль",required:""},on:{input:function(t){return e.$v.confirmPassword.$touch()},blur:function(t){return e.$v.confirmPassword.$touch()},"click:append":function(t){e.show2=!e.show2}},model:{value:e.confirmPassword,callback:function(t){e.confirmPassword=t},expression:"confirmPassword"}}),e.erroror.length>0?r("div",{staticClass:"col-12",staticStyle:{position:"absolute",bottom:"0","z-index":"2",left:"0"}},[r("v-alert",{attrs:{dismissible:"",border:"bottom",type:"error"}},[e._v(" "+e._s(e.errtext())+" ")])],1):e._e(),r("div",{staticClass:"col-6"},[r("v-btn",{attrs:{block:"",elevation:"3"},on:{click:e.submit}},[e._v(" Изменить пароль ")])],1),r("div",{staticClass:"col-6"},[r("v-btn",{attrs:{block:"",elevation:"3"},on:{click:function(t){return t.preventDefault(),e.$emit("chView",{value:"login"})}}},[e._v(" Назад ")])],1)],1)],1)],1)],1)},te=[];const re=e=>/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?!.*\s).*$/.test(e);var se={name:"restore",mixins:[a.oE],props:{registr:{type:Object,default:{lotus_key:"",email:""}}},data(){return{erroror:[],show1:!1,show2:!1,password:"",confirmPassword:"",email:"",lotus_key:""}},validations:{password:{required:j.C1,minLength:(0,j.Ei)(8),passwordRule:re},confirmPassword:{required:j.C1,minLength:(0,j.Ei)(8),sameAs:(0,j.sH)("password")}},computed:{passwordErrors(){const e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Обязательное поле"),!this.$v.password.minLength&&e.push("Пароль должен быть более 8 символов"),!this.$v.password.passwordRule&&e.push("Cтрочные и прописные латинские буквы, цифры"),e):e},confirmPasswordErrors(){const e=[];return this.$v.confirmPassword.$dirty?(!this.$v.confirmPassword.sameAs&&e.push("Пароли не совпадают"),e):e}},methods:{errtext(){return this.erroror.map((e=>e)).join(", ")},async submit(){try{await l.e0.post("/auth/restore",{email:this.registr.email,lotus_key:this.registr.lotus_key,password:this.password});this.$emit("chView",{value:"login",status:!0},{done:"Пароль изменен"})}catch(e){this.error=e.response.data.detail,this.statusReg=!0}},clear(){this.$v.$reset(),this.username="",this.email=""},backlog(){}}},ie=se,oe=(0,m.Z)(ie,ee,te,!1,null,null,null),ne=oe.exports;v()(oe,{VAlert:K.Z,VBtn:w.Z,VCard:g.Z,VCardTitle:_.EB,VContainer:Q.Z,VForm:y.Z,VTextField:P.Z});var ae={name:"AuthView",components:{FormLogin:L,FormRegistration:Y,FormBefore:E,FormRestore:ne},data:()=>({errorview:!1,nowView:"login",statusReg:!1,texterror:{text:"",header:""},user:{},registrat:[]}),methods:{closeit(){this.errorview=!1,this.texterror={text:"",header:""}},error(e){this.errorview=!0,this.texterror=e},changeView({value:e,status:t=!1,datas:r={}}={},s){this.nowView=e,this.statusReg=t,this.user=r,this.registrat=s}}},le=ae,ue=(0,m.Z)(le,s,i,!1,null,null,null),de=ue.exports;v()(ue,{VBtn:w.Z,VCol:b.Z,VRow:C.Z,VSnackbar:k.Z})}}]);
//# sourceMappingURL=766.3cc21371.js.map